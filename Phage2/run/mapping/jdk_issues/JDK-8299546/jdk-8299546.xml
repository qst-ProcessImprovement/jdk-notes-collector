<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 15:21:18 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8299546] C2: MulLNode::mul_ring() wrongly returns bottom type due to casting errors with large numbers</title>
                <link>https://bugs.openjdk.org/browse/JDK-8299546</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>This was found by fuzzing (hitting the assert &amp;quot;Missed optimization opportunity in PhaseCCP&amp;quot;) when multiplying two longs resulting in a large number. The current logic in MulLNode::mul_ring() tries to cast the longs to doubles to check for overflows. However, when the product is too large (but still small enough to not overflow the 64-bit long range), we could get precision errors and wrongly bottom type even though there is no overflow. This should be fixed.&lt;br/&gt;
&lt;br/&gt;
Moreover, the code in MulLNode::mul_ring() is very similar to MulINode::mul_ring() and should be shared.&lt;br/&gt;
&lt;br/&gt;
Reproduce original fuzzer test:&lt;br/&gt;
$ java -XX:-TieredCompilation  -XX:+StressCCP -XX:+StressIGVN -XX:StressSeed=1110788490 -Xcomp -XX:CompileOnly=Test Test.java&lt;br/&gt;
$ java -XX:-TieredCompilation  -Xcomp -XX:CompileOnly=Reduced -XX:CompileCommand=dontinline,*::* Reduced.java&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
# A fatal error has been detected by the Java Runtime Environment:&lt;br/&gt;
#&lt;br/&gt;
#  Internal Error (/opt/mach5/mesos/work_dir/slaves/0c72054a-24ab-4dbb-944f-97f9341a1b96-S94926/frameworks/1735e8a2-a1db-478c-8104-60c8b0af87dd-0196/executors/bf8be942-093f-4c3a-ad5c-419b5b32f8e9/runs/fa071043-b451-4ecc-b392-0071c325cf84/workspace/open/src/hotspot/share/opto/phaseX.cpp:1859), pid=131032, tid=131045&lt;br/&gt;
#  assert(!failure) failed: Missed optimization opportunity in PhaseCCP&lt;br/&gt;
#&lt;br/&gt;
# JRE version: Java(TM) SE Runtime Environment (21.0+4) (fastdebug build 21-ea+4-LTS-164)&lt;br/&gt;
# Java VM: Java HotSpot(TM) 64-Bit Server VM (fastdebug 21-ea+4-LTS-164, compiled mode, sharing, compressed oops, compressed class ptrs, g1 gc, linux-amd64)&lt;br/&gt;
# Problematic frame:&lt;br/&gt;
# V  [libjvm.so+0x1796324]  PhaseCCP::verify_analyze(Unique_Node_List&amp;amp;)+0x414&lt;br/&gt;
&lt;br/&gt;
Current CompileTask:&lt;br/&gt;
C2:   1151  111    b        Test::vMeth1 (257 bytes)&lt;br/&gt;
&lt;br/&gt;
Stack: [0x00007f4b3ef19000,0x00007f4b3f019000],  sp=0x00007f4b3f013fd0,  free space=1003k&lt;br/&gt;
Native frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native code)&lt;br/&gt;
V  [libjvm.so+0x1796324]  PhaseCCP::verify_analyze(Unique_Node_List&amp;amp;)+0x414  (phaseX.cpp:1859)&lt;br/&gt;
V  [libjvm.so+0x179a2f8]  PhaseCCP::analyze()+0x3d8&lt;br/&gt;
V  [libjvm.so+0xafe0c1]  Compile::Optimize()+0x701&lt;br/&gt;
V  [libjvm.so+0xb0294e]  Compile::Compile(ciEnv*, ciMethod*, int, Options, DirectiveSet*)+0x18ce&lt;br/&gt;
V  [libjvm.so+0x9167f7]  C2Compiler::compile_method(ciEnv*, ciMethod*, int, bool, DirectiveSet*)+0x4e7&lt;br/&gt;
V  [libjvm.so+0xb0f9dc]  CompileBroker::invoke_compiler_on_method(CompileTask*)+0xa7c&lt;br/&gt;
V  [libjvm.so+0xb10798]  CompileBroker::compiler_thread_loop()+0x5d8&lt;br/&gt;
V  [libjvm.so+0x107cf06]  JavaThread::thread_main_inner()+0x206&lt;br/&gt;
V  [libjvm.so+0x1a72710]  Thread::call_run()+0x100&lt;br/&gt;
V  [libjvm.so+0x1712613]  thread_native_entry(Thread*)+0x103&lt;br/&gt;
Registers:</description>
                <environment></environment>
        <key id="5090619">JDK-8299546</key>
            <summary>C2: MulLNode::mul_ring() wrongly returns bottom type due to casting errors with large numbers</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chagedorn">Christian Hagedorn</assignee>
                                    <reporter username="chagedorn">Christian Hagedorn</reporter>
                        <labels>
                            <label>c2</label>
                            <label>javafuzzer</label>
                            <label>oracle-triage-21</label>
                            <label>performance</label>
                    </labels>
                <created>Tue, 3 Jan 2023 07:01:26 -0800</created>
                <updated>Mon, 1 May 2023 23:55:08 -0700</updated>
                            <resolved>Tue, 14 Mar 2023 08:00:21 -0700</resolved>
                                    <version>8</version>
                    <version>11</version>
                    <version>17</version>
                    <version>19</version>
                    <version>20</version>
                    <version>21</version>
                                    <fixVersion>21</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14566779" author="dukebot" created="Tue, 14 Mar 2023 08:00:20 -0700"  >Changeset: c466cdf9&lt;br/&gt;
Author:    Christian Hagedorn &amp;lt;&lt;a href=&apos;mailto:chagedorn@openjdk.org&apos;&gt;chagedorn@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-03-14 14:57:47 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/c466cdf973ca9c4ecec1a28f158ebf366386024e&quot;&gt;https://git.openjdk.org/jdk/commit/c466cdf973ca9c4ecec1a28f158ebf366386024e&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14549603" author="roboduke" created="Mon, 9 Jan 2023 08:27:58 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/11907&quot;&gt;https://git.openjdk.org/jdk/pull/11907&lt;/a&gt;&lt;br/&gt;
Date: 2023-01-09 16:19:46 +0000</comment>
                            <comment id="14548308" author="chagedorn" created="Tue, 3 Jan 2023 07:05:22 -0800"  >ILW = Imprecise type information leading to missed optimization opportunities and could hit assertion in CCP verification code, rare, no workaround = MLH = P4</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5035767">JDK-8257197</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5099846">JDK-8307197</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="102186" name="FuzzerUtils.class" size="8440" author="chagedorn" created="Tue, 3 Jan 2023 06:57:10 -0800"/>
                            <attachment id="102184" name="Reduced.java" size="747" author="chagedorn" created="Tue, 3 Jan 2023 07:00:46 -0800"/>
                            <attachment id="102187" name="Test.java" size="7198" author="chagedorn" created="Tue, 3 Jan 2023 06:57:08 -0800"/>
                            <attachment id="102185" name="hs_err_pid131032.log" size="80132" author="chagedorn" created="Tue, 3 Jan 2023 06:57:52 -0800"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2zry3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17407"><![CDATA[b14]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="208"><![CDATA[compiler]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>