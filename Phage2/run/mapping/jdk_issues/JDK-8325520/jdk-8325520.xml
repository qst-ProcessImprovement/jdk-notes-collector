<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 12:46:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8325520] Vector loads and stores with indices and masks incorrectly compiled</title>
                <link>https://bugs.openjdk.org/browse/JDK-8325520</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>ADDITIONAL SYSTEM INFORMATION :&lt;br/&gt;
Using WSL on Windows 11&lt;br/&gt;
&lt;br/&gt;
java --version&lt;br/&gt;
java 21.0.1 2023-10-17 LTS&lt;br/&gt;
Java(TM) SE Runtime Environment (build 21.0.1+12-LTS-29)&lt;br/&gt;
Java HotSpot(TM) 64-Bit Server VM (build 21.0.1+12-LTS-29, mixed mode, sharing)&lt;br/&gt;
&lt;br/&gt;
A DESCRIPTION OF THE PROBLEM :&lt;br/&gt;
Loading a Vector using an offset map doesn&amp;#39;t always work correctly once compiled. The data isn&amp;#39;t loaded at all (there is no gather instruction in the outputted assembly), but instead another Vector seems incorrectly aliased.&lt;br/&gt;
&lt;br/&gt;
After ~110k loop iterations a single buggy iteration is run, and then starting at iteration ~185k a different buggy iteration is switched to.&lt;br/&gt;
&lt;br/&gt;
STEPS TO FOLLOW TO REPRODUCE THE PROBLEM :&lt;br/&gt;
Run the program below&lt;br/&gt;
&lt;br/&gt;
EXPECTED VERSUS ACTUAL BEHAVIOR :&lt;br/&gt;
EXPECTED -&lt;br/&gt;
(no output)&lt;br/&gt;
ACTUAL -&lt;br/&gt;
111142&lt;br/&gt;
[1, 1, 1, 1]&lt;br/&gt;
[1, 1, 1, 1]&lt;br/&gt;
[1, 1, 1, 1]&lt;br/&gt;
184869&lt;br/&gt;
[1, 1, 1, 1]&lt;br/&gt;
[1, 1, 1, 1]&lt;br/&gt;
[0, 0, 0, 0]&lt;br/&gt;
184870&lt;br/&gt;
[1, 1, 1, 1]&lt;br/&gt;
[1, 1, 1, 1]&lt;br/&gt;
[0, 0, 0, 0]&lt;br/&gt;
184871&lt;br/&gt;
[1, 1, 1, 1]&lt;br/&gt;
[1, 1, 1, 1]&lt;br/&gt;
[0, 0, 0, 0]&lt;br/&gt;
&lt;br/&gt;
....&lt;br/&gt;
&lt;br/&gt;
---------- BEGIN SOURCE ----------&lt;br/&gt;
import jdk.incubator.vector.LongVector;&lt;br/&gt;
&lt;br/&gt;
class Bug {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;public static void main(String[] args) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;final long[] storage = new long[8];&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;final int[] offsets = new int[]{4, 5, 6, 7};&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;final LongVector ones = LongVector.broadcast(LongVector.SPECIES_256, 1);&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;for (int i = 0 ; i &amp;lt; (1 &amp;lt;&amp;lt; 30); i++) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ones.intoArray(storage, 0);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;LongVector a = LongVector.fromArray(LongVector.SPECIES_256, storage, 0, offsets, 0);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;LongVector b = LongVector.fromArray(LongVector.SPECIES_256, storage, 0, offsets, 0);&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (ones.equals(a) || ones.equals(b)) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;System.out.println(i);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;System.out.println(ones);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;System.out.println(a);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;System.out.println(b);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
}&lt;br/&gt;
---------- END SOURCE ----------&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
        <key id="5118812">JDK-8325520</key>
            <summary>Vector loads and stores with indices and masks incorrectly compiled</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://bugs.openjdk.org/images/jbsImages/p3.png">P3</priority>
                        <status id="6" iconUrl="https://bugs.openjdk.org/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dfenacci">Damon Fenacci</assignee>
                                    <reporter username="webbuggrp">Webbug Group</reporter>
                        <labels>
                            <label>amazon-interest</label>
                            <label>c2</label>
                            <label>dcsmco</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>oracle-triage-23</label>
                            <label>reproducer-yes</label>
                            <label>sup_nrt</label>
                            <label>vectorapi</label>
                            <label>webbug</label>
                    </labels>
                <created>Thu, 11 Jan 2024 21:06:48 -0800</created>
                <updated>Fri, 15 Nov 2024 01:07:49 -0800</updated>
                            <resolved>Fri, 24 May 2024 06:42:50 -0700</resolved>
                                    <version>16</version>
                    <version>17</version>
                    <version>21.0.1</version>
                    <version>23</version>
                                    <fixVersion>23</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>10</watches>
                                                                                                                <comments>
                            <comment id="14722600" author="sgehwolf" created="Fri, 15 Nov 2024 01:07:08 -0800"  >OpenJDK 21 maintainer note:&lt;br/&gt;
&lt;br/&gt;
Should this get backported to earlier releases than 21, &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8302459&quot; title=&quot;Missing late inline cleanup causes compiler/vectorapi/VectorLogicalOpIdentityTest.java IR failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8302459&quot;&gt;&lt;strike&gt;JDK-8302459&lt;/strike&gt;&lt;/a&gt; and &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8333248&quot; title=&quot;VectorGatherMaskFoldingTest.java failed when maximum vector bits is 64&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8333248&quot;&gt;&lt;strike&gt;JDK-8333248&lt;/strike&gt;&lt;/a&gt;, both ought to get backported. Right now &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8302459&quot; title=&quot;Missing late inline cleanup causes compiler/vectorapi/VectorLogicalOpIdentityTest.java IR failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8302459&quot;&gt;&lt;strike&gt;JDK-8302459&lt;/strike&gt;&lt;/a&gt; isn&amp;#39;t even fixed in the latest jdk tree. It&amp;#39;s still missing a backport to 21 as well (for that reason).</comment>
                            <comment id="14714362" author="jkang" created="Wed, 16 Oct 2024 22:49:10 -0700"  >For any future backports of this issue, it would be great to also backport &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8333248&quot;&gt;https://bugs.openjdk.org/browse/JDK-8333248&lt;/a&gt; after it. It is a related platform-specific test case fix.</comment>
                            <comment id="14683864" author="roboduke" created="Sat, 22 Jun 2024 12:58:04 -0700"  >[jdk21u-fix-request] Approval Request from Martin&lt;br/&gt;
Should get backported for parity with 21.0.5-oracle. The backport gets recognized as clean and the included test has passed. Also, tier 1-4 have passed.</comment>
                            <comment id="14683267" author="roboduke" created="Thu, 20 Jun 2024 08:59:49 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/768&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/768&lt;/a&gt;&lt;br/&gt;
Date: 2024-06-20 15:53:32 +0000</comment>
                            <comment id="14676010" author="dukebot" created="Fri, 24 May 2024 06:42:49 -0700"  >Changeset: 0c934ff4&lt;br/&gt;
Author:    Damon Fenacci &amp;lt;&lt;a href=&apos;mailto:dfenacci@openjdk.org&apos;&gt;dfenacci@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2024-05-24 13:39:17 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/0c934ff4e2fb53a72ad25a080d956745a5649f9b&quot;&gt;https://git.openjdk.org/jdk/commit/0c934ff4e2fb53a72ad25a080d956745a5649f9b&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14665134" author="roboduke" created="Mon, 15 Apr 2024 00:27:39 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/18347&quot;&gt;https://git.openjdk.org/jdk/pull/18347&lt;/a&gt;&lt;br/&gt;
Date: 2024-03-18 12:20:34 +0000</comment>
                            <comment id="14648214" author="thartmann" created="Mon, 12 Feb 2024 01:52:23 -0800"  >ILW = Incorrect result of C2 compiled code, reproducible with specific test using the vector API (incubator), disable compilation of affected method = HLM = P3</comment>
                            <comment id="14641092" author="fmatte" created="Wed, 17 Jan 2024 02:54:49 -0800"  >I am able to reproduce this issue on jdk17 and jdk11 as well.</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5132517">JDK-8334846</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5130571">JDK-8333160</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10000">
                    <name>Blocks</name>
                                            <outwardlinks description="blocks">
                                                        </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5130499">JDK-8333099</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5094121">JDK-8302459</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5130665">JDK-8333248</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17008"><![CDATA[generic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17010"><![CDATA[generic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i34jlf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17411"><![CDATA[b25]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="208"><![CDATA[compiler]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10100" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Verification</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17000"><![CDATA[Verified]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>