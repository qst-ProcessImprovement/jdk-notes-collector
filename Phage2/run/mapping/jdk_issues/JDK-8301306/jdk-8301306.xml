<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 16:16:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8301306] java/net/httpclient/* fail with -Xcomp</title>
                <link>https://bugs.openjdk.org/browse/JDK-8301306</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>The tests failed with VM_OPTIONS=-Xcomp and CONF=fastdebug&lt;br/&gt;
on the AArch64 and LOONGARCH64 architecture.&lt;br/&gt;
&lt;br/&gt;
java/net/httpclient/ByteArrayPublishers.java&lt;br/&gt;
java/net/httpclient/ManyRequestsLegacy.java&lt;br/&gt;
&lt;br/&gt;
----------System.err:(46/4302)----------&lt;br/&gt;
java.lang.RuntimeException: java.util.concurrent.CompletionException: java.io.IOException: HTTP/1.1 header parser received no bytes&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at ByteArrayPublishers.main(ByteArrayPublishers.java:94)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.base/java.lang.reflect.Method.invoke(Method.java:578)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at com.sun.javatest.regtest.agent.MainWrapper$MainThread.run(MainWrapper.java:125)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.base/java.lang.Thread.run(Thread.java:1591)&lt;br/&gt;
Caused by: java.util.concurrent.CompletionException: java.io.IOException: HTTP/1.1 header parser received no bytes&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.base/java.util.concurrent.CompletableFuture.encodeRelay(CompletableFuture.java:368)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.base/java.util.concurrent.CompletableFuture.completeRelay(CompletableFuture.java:377)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.base/java.util.concurrent.CompletableFuture$UniCompose.tryFire(CompletableFuture.java:1152)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2194)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.net.http/jdk.internal.net.http.Http1Response.onReadError(Http1Response.java:453)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.net.http/jdk.internal.net.http.Http1Response$HeadersReader.onReadError(Http1Response.java:575)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.net.http/jdk.internal.net.http.Http1AsyncReceiver.checkForErrors(Http1AsyncReceiver.java:302)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.net.http/jdk.internal.net.http.Http1AsyncReceiver.flush(Http1AsyncReceiver.java:268)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.net.http/jdk.internal.net.http.common.SequentialScheduler$LockingRestartableTask.run(SequentialScheduler.java:205)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.net.http/jdk.internal.net.http.common.SequentialScheduler$CompleteRestartableTask.run(SequentialScheduler.java:149)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.net.http/jdk.internal.net.http.common.SequentialScheduler$SchedulableTask.run(SequentialScheduler.java:230)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;... 1 more&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
        <key id="5092761">JDK-8301306</key>
            <summary>java/net/httpclient/* fail with -Xcomp</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sguoyun">Sun Guoyun</assignee>
                                    <reporter username="sguoyun">Sun Guoyun</reporter>
                        <labels>
                            <label>jdk17u-fix-request</label>
                            <label>jdk17u-fix-yes</label>
                            <label>noreg-self</label>
                    </labels>
                <created>Sun, 29 Jan 2023 01:29:48 -0800</created>
                <updated>Tue, 23 Apr 2024 00:35:22 -0700</updated>
                            <resolved>Fri, 3 Feb 2023 03:57:54 -0800</resolved>
                                                    <fixVersion>21</fixVersion>
                                    <component>core-libs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="14631017" author="roboduke" created="Mon, 4 Dec 2023 06:13:26 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u-dev/pull/2011&quot;&gt;https://git.openjdk.org/jdk17u-dev/pull/2011&lt;/a&gt;&lt;br/&gt;
Date: 2023-12-04 14:05:22 +0000</comment>
                            <comment id="14631014" author="goetz" created="Mon, 4 Dec 2023 06:08:05 -0800"  >Fix request [17u]&lt;br/&gt;
&lt;br/&gt;
I backport this because we see some of these tests failing in our CI.&lt;br/&gt;
No risk, only a test change.&lt;br/&gt;
I needed some trivial resolves.&lt;br/&gt;
Tests pass. SAP nightly testing passed.</comment>
                            <comment id="14557154" author="dukebot" created="Fri, 3 Feb 2023 03:57:53 -0800"  >Changeset: 6f9106e0&lt;br/&gt;
Author:    sunguoyun &amp;lt;&lt;a href=&apos;mailto:sunguoyun@loongson.cn&apos;&gt;sunguoyun@loongson.cn&lt;/a&gt;&amp;gt;&lt;br/&gt;
Committer: Jie Fu &amp;lt;&lt;a href=&apos;mailto:jiefu@openjdk.org&apos;&gt;jiefu@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-02-03 11:56:06 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/6f9106e0d0d9f082f0a61009f95d1b8663dd8d4f&quot;&gt;https://git.openjdk.org/jdk/commit/6f9106e0d0d9f082f0a61009f95d1b8663dd8d4f&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14556799" author="kvn" created="Wed, 1 Feb 2023 22:35:53 -0800"  >We do need testing with default mixed mode when JIT compilation is not blocking. I surprise you need explicitly run only with Interpreter to pass. </comment>
                            <comment id="14556768" author="JIRAUSER19703" created="Wed, 1 Feb 2023 19:49:58 -0800"  >java/net/httpclient/ManyRequestsLegacy.java must  set`-Xint -Dsun.net.httpserver.idleInterval=500000` to run passed, other tests passed only with `-Xint`.</comment>
                            <comment id="14556654" author="kvn" created="Wed, 1 Feb 2023 10:44:30 -0800"  >I think adding ` @requires vm.compMode != &amp;quot;Xcomp&amp;quot; ` is acceptable in this case.&lt;br/&gt;
Do these tests pass with `-Xint` (Interpreter mode only)?&lt;br/&gt;
</comment>
                            <comment id="14556624" author="dfuchs" created="Wed, 1 Feb 2023 09:22:43 -0800"  >Since the title of this issue only speaks of httpclient tests maybe you could update your PR (and the issue title) to only solve the issue with the java.net tests that are failing. That could be easily reviewed on net-dev, and would make it possible to progress.&lt;br/&gt;
You could log a separate issue (and PR) for  the other tests in other areas.&lt;br/&gt;
&lt;br/&gt;
If adding -Dsun.net.httpserver.idleInterval=50000  / -Dsun.net.client.defaultReadTimeout=50000  makes the tests pass in all configurations (with or without -Xcomp) it&amp;#39;s probably an acceptable solution ([~alanb] do you agree WRT HttpALot?) &lt;br/&gt;
&lt;br/&gt;
</comment>
                            <comment id="14556613" author="dcubed" created="Wed, 1 Feb 2023 08:32:10 -0800"  >&amp;gt; I want to add ` @requires (vm.compMode != &amp;quot;Xcomp&amp;quot;) ` in ByteArrayPublishers.java&lt;br/&gt;
&amp;gt; and other failed tests to disable tests running. Do you think it`s right?&lt;br/&gt;
&lt;br/&gt;
This is a question of test coverage which should be decided by area maintainers&lt;br/&gt;
for java.net and the HotSpot Compiler team so [~alanb] and [~kvn] are good folks&lt;br/&gt;
to ping for an opinion.</comment>
                            <comment id="14556434" author="JIRAUSER19703" created="Wed, 1 Feb 2023 00:56:57 -0800"  >since different tests need to modify/add different parameters to ensure result is passed, e.g.&lt;br/&gt;
&lt;br/&gt;
java/net/httpclient/ByteArrayPublishers.java  // -Xcomp -Dsun.net.httpserver.idleInterval=50000&lt;br/&gt;
java/net/vthread/HttpALot.java  //-Xcomp -Dsun.net.client.defaultReadTimeout=50000&lt;br/&gt;
java/net/httpclient/ManyRequestsLegacy.java // -Xcomp -Dsun.net.httpserver.idleInterval=50000 and @run main/othervm/timeout=140&lt;br/&gt;
&lt;br/&gt;
so I want to add ` @requires (vm.compMode != &amp;quot;Xcomp&amp;quot;) ` in ByteArrayPublishers.java and other failed tests to disable tests running. Do you think it`s right? @Daniel Daugherty @Alan Bateman</comment>
                            <comment id="14556036" author="JIRAUSER19703" created="Tue, 31 Jan 2023 03:03:19 -0800"  >thank @Daniel Fuchs, tests can PASSED by use `-Xcomp -Dsun.net.httpserver.idleInterval=50000`.</comment>
                            <comment id="14555653" author="dcubed" created="Mon, 30 Jan 2023 13:09:58 -0800"  >Moving from hotspot/runtime -&amp;gt; core-libs/java.net for initial triage.</comment>
                            <comment id="14555389" author="dfuchs" created="Mon, 30 Jan 2023 02:40:25 -0800"  >ManyRequestLegacy doesn&amp;#39;t use the new HttpClient but the old HttpURLConnection.&lt;br/&gt;
Given the description the most likely cause of the error is that the HttpServer decides to close an idle HTTP/1.1 connection at the time the client is trying to reuse it. Before reusing a connection, the client does its best to try and figure out if it&amp;#39;s still alive - but this is a best effort. If the delay between the time it does this check, and the time it tries to write to the connection is extended, then that gives more opportunity for the server to close the idle connection during that time, and it&amp;#39;s probably what&amp;#39;s being observed here.&lt;br/&gt;
The fact that both clients are failing would support that hypothesis.</comment>
                            <comment id="14555371" author="alanb" created="Mon, 30 Jan 2023 01:46:54 -0800"  >I think it would be useful to see the .jtr files from the failed runs, e.g. StructuredTaskScopeTest.java is 46 tests, and run twice to exercise the API from both platform and virtual threads, so if there is a test failure then it would be useful to know which test/conditions.</comment>
                            <comment id="14555352" author="JIRAUSER19703" created="Mon, 30 Jan 2023 00:49:03 -0800"  >I also found the following tests failed.&lt;br/&gt;
&lt;br/&gt;
jdk/incubator/concurrent/StructuredTaskScope/StructuredTaskScopeTest.java &#65288;fastdebug -Xcomp&#65289;&lt;br/&gt;
java/rmi/server/UnicastRemoteObject/serialFilter/FilterUROTest.java &#65288;release -Xcomp&#65289;&lt;br/&gt;
&lt;br/&gt;
so if you thinke &lt;a href=&quot;https://git.openjdk.org/jdk/pull/12282&quot;&gt;https://git.openjdk.org/jdk/pull/12282&lt;/a&gt; is not the fundamental solution, then I try to solve this bug on tests and tracke it n core-libs/java.net.</comment>
                            <comment id="14555335" author="alanb" created="Mon, 30 Jan 2023 00:00:09 -0800"  >Issues with the HTTP client are tracked in core-libs/java.net. I can&amp;#39;t tell from this bug report if there is a test robustness issue or something else.</comment>
                            <comment id="14555325" author="roboduke" created="Sun, 29 Jan 2023 23:22:17 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/12282&quot;&gt;https://git.openjdk.org/jdk/pull/12282&lt;/a&gt;&lt;br/&gt;
Date: 2023-01-30 07:16:17 +0000</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5116319">JDK-8321460</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5093346">JDK-8301787</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="19300"><![CDATA[aarch64]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17023"><![CDATA[linux]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i30563:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17336"><![CDATA[b09]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="193"><![CDATA[java.net]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>