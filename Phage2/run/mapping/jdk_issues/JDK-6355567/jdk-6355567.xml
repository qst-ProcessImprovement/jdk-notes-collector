<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 12:20:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-6355567] AdobeMarkerSegment causes failure to read valid JPEG</title>
                <link>https://bugs.openjdk.org/browse/JDK-6355567</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>FULL PRODUCT VERSION :&lt;br/&gt;
java version &amp;quot;1.4.2_10&amp;quot;&lt;br/&gt;
Java(TM) 2 Runtime Environment, Standard Edition (build 1.4.2_10-b03)&lt;br/&gt;
Java HotSpot(TM) Client VM (build 1.4.2_10-b03, mixed mode)&lt;br/&gt;
&lt;br/&gt;
JRE build 1.5.0_04-b05&lt;br/&gt;
&lt;br/&gt;
A DESCRIPTION OF THE PROBLEM :&lt;br/&gt;
When attempting to read a valid JPEG file with Adobe-specific JPEG application markers, an Image Format Error can result.&lt;br/&gt;
&lt;br/&gt;
This is caused by com.sun.imageio.plugins.jpeg.AdobeMarkerSegment assuming a 14-byte marker. We have encoutered 33-byte markers generated by some adobe applications. When a JPEG with such a marker is read by  com.sun.imageio.plugins.jpeg.JPEGImageReader.getImageMetadata, AdobeMarkerSegment advances the JPEGBuffer&amp;#39;s pointer by only 14 bytes while reducing its &amp;quot;available bytes&amp;quot; count by the correct 35 bytes. This leaves the buffer in an inconsistent state, effectively removing 21 bytes&lt;br/&gt;
&lt;br/&gt;
This error is easily missed as the code is somewhat tolerant of premature end-of-buffer. However, if the 21st-to-last byte in the file (now the perceived end of the buffer) is 0xFF, com.sun.imageio.plugins.jpeg.JPEGMetadata attempts to fetch another byte and throws the exception mentioned.&lt;br/&gt;
&lt;br/&gt;
An example of the 35-byte marker:&lt;br/&gt;
&lt;br/&gt;
FF EE 00 21 41 64 6F 62&lt;br/&gt;
65 00 64 c0 00 00 00 01&lt;br/&gt;
03 00 10 03 02 03 06 00&lt;br/&gt;
00 02 BB 00 00 03 FC 00&lt;br/&gt;
00 08 5C&lt;br/&gt;
&lt;br/&gt;
The code in question can seen by inspection to be in error - see constructor com.sun.imageio.plugins.jpeg.AdobeMarkerSegment(JPEGBuffer buffer) - buffer.bufPtr is incremented by a total of 14 bytes and buffer.bufAvail is decremented by whatever length is specified in the marker, so unless this length is 14, it will cause problems.&lt;br/&gt;
&lt;br/&gt;
STEPS TO FOLLOW TO REPRODUCE THE PROBLEM :&lt;br/&gt;
Create JPEG file with the marker data mentioned and with FF 00 in the data stream, with the &amp;quot;FF&amp;quot; being 21 bytes from the end of the file. Attempt to read this file using ImageIO.&lt;br/&gt;
&lt;br/&gt;
EXPECTED VERSUS ACTUAL BEHAVIOR :&lt;br/&gt;
EXPECTED -&lt;br/&gt;
Expected: no output.&lt;br/&gt;
JPEG is read successfully&lt;br/&gt;
&lt;br/&gt;
ACTUAL -&lt;br/&gt;
javax.imageio.IIOException thrown&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
ERROR MESSAGES/STACK TRACES THAT OCCUR :&lt;br/&gt;
Error: One factory fails for the operation &amp;quot;ImageRead&amp;quot;&lt;br/&gt;
Occurs in: javax.media.jai.ThreadSafeOperationRegistry&lt;br/&gt;
java.lang.reflect.InvocationTargetException&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.lang.reflect.Method.invoke(Unknown Source)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at javax.media.jai.FactoryCache.invoke(FactoryCache.java:130)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at javax.media.jai.OperationRegistry.invokeFactory(OperationRegistry.java:1682)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at javax.media.jai.ThreadSafeOperationRegistry.invokeFactory(ThreadSafeOperationRegistry.java:481)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at javax.media.jai.registry.RIFRegistry.create(RIFRegistry.java:340)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at javax.media.jai.RenderedOp.createInstance(RenderedOp.java:830)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at javax.media.jai.RenderedOp.createRendering(RenderedOp.java:878)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at javax.media.jai.RenderedOp.getRendering(RenderedOp.java:899)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at com.mobileaware.[- deleted -]&lt;br/&gt;
Caused by: java.lang.RuntimeException: javax.imageio.IIOException: Image Format Error&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at com.sun.media.jai.imageioimpl.ImageReadCRIF.create(ImageReadCRIF.java:267)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;... 21 more&lt;br/&gt;
Caused by: javax.imageio.IIOException: Image Format Error&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at com.sun.imageio.plugins.jpeg.JPEGBuffer.loadBuf(Unknown Source)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at com.sun.imageio.plugins.jpeg.JPEGMetadata.&amp;lt;init&amp;gt;(Unknown Source)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at com.sun.imageio.plugins.jpeg.JPEGImageReader.getImageMetadata(Unknown Source)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at com.sun.imageio.plugins.jpeg.JPEGImageReader.getNumThumbnails(Unknown Source)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at javax.imageio.ImageReader.hasThumbnails(Unknown Source)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at com.sun.media.jai.imageioimpl.ImageReadOpImage.&amp;lt;init&amp;gt;(ImageReadOpImage.java:505)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at com.sun.media.jai.imageioimpl.ImageReadCRIF.create(ImageReadCRIF.java:259)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;... 21 more&lt;br/&gt;
Exception in thread &amp;quot;main&amp;quot; javax.media.jai.util.ImagingException: All factories fail for the operation &amp;quot;ImageRead&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at javax.media.jai.OperationRegistry.invokeFactory(OperationRegistry.java:1695)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at javax.media.jai.ThreadSafeOperationRegistry.invokeFactory(ThreadSafeOperationRegistry.java:481)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at javax.media.jai.registry.RIFRegistry.create(RIFRegistry.java:340)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at javax.media.jai.RenderedOp.createInstance(RenderedOp.java:830)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at javax.media.jai.RenderedOp.createRendering(RenderedOp.java:878)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at javax.media.jai.RenderedOp.getRendering(RenderedOp.java:899)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at com.mobileaware.[- deleted -]&lt;br/&gt;
Caused by: java.lang.reflect.InvocationTargetException&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.lang.reflect.Method.invoke(Unknown Source)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at javax.media.jai.FactoryCache.invoke(FactoryCache.java:130)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at javax.media.jai.OperationRegistry.invokeFactory(OperationRegistry.java:1682)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;... 15 more&lt;br/&gt;
Caused by: java.lang.RuntimeException: javax.imageio.IIOException: Image Format Error&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at com.sun.media.jai.imageioimpl.ImageReadCRIF.create(ImageReadCRIF.java:267)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;... 21 more&lt;br/&gt;
Caused by: javax.imageio.IIOException: Image Format Error&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at com.sun.imageio.plugins.jpeg.JPEGBuffer.loadBuf(Unknown Source)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at com.sun.imageio.plugins.jpeg.JPEGMetadata.&amp;lt;init&amp;gt;(Unknown Source)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at com.sun.imageio.plugins.jpeg.JPEGImageReader.getImageMetadata(Unknown Source)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at com.sun.imageio.plugins.jpeg.JPEGImageReader.getNumThumbnails(Unknown Source)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at javax.imageio.ImageReader.hasThumbnails(Unknown Source)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at com.sun.media.jai.imageioimpl.ImageReadOpImage.&amp;lt;init&amp;gt;(ImageReadOpImage.java:505)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at com.sun.media.jai.imageioimpl.ImageReadCRIF.create(ImageReadCRIF.java:259)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;... 21 more&lt;br/&gt;
Caused by:&lt;br/&gt;
java.lang.reflect.InvocationTargetException&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.lang.reflect.Method.invoke(Unknown Source)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at javax.media.jai.FactoryCache.invoke(FactoryCache.java:130)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at javax.media.jai.OperationRegistry.invokeFactory(OperationRegistry.java:1682)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at javax.media.jai.ThreadSafeOperationRegistry.invokeFactory(ThreadSafeOperationRegistry.java:481)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at javax.media.jai.registry.RIFRegistry.create(RIFRegistry.java:340)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at javax.media.jai.RenderedOp.createInstance(RenderedOp.java:830)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at javax.media.jai.RenderedOp.createRendering(RenderedOp.java:878)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at javax.media.jai.RenderedOp.getRendering(RenderedOp.java:899)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at com.mobileaware.[- deleted -]&lt;br/&gt;
Caused by: java.lang.RuntimeException: javax.imageio.IIOException: Image Format Error&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at com.sun.media.jai.imageioimpl.ImageReadCRIF.create(ImageReadCRIF.java:267)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;... 21 more&lt;br/&gt;
Caused by: javax.imageio.IIOException: Image Format Error&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at com.sun.imageio.plugins.jpeg.JPEGBuffer.loadBuf(Unknown Source)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at com.sun.imageio.plugins.jpeg.JPEGMetadata.&amp;lt;init&amp;gt;(Unknown Source)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at com.sun.imageio.plugins.jpeg.JPEGImageReader.getImageMetadata(Unknown Source)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at com.sun.imageio.plugins.jpeg.JPEGImageReader.getNumThumbnails(Unknown Source)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at javax.imageio.ImageReader.hasThumbnails(Unknown Source)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at com.sun.media.jai.imageioimpl.ImageReadOpImage.&amp;lt;init&amp;gt;(ImageReadOpImage.java:505)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at com.sun.media.jai.imageioimpl.ImageReadCRIF.create(ImageReadCRIF.java:259)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;... 21 more&lt;br/&gt;
&lt;br/&gt;
REPRODUCIBILITY :&lt;br/&gt;
This bug can be reproduced always.&lt;br/&gt;
&lt;br/&gt;
---------- BEGIN SOURCE ----------&lt;br/&gt;
import javax.imageio.*;&lt;br/&gt;
import javax.imageio.stream.FileImageInputStream;&lt;br/&gt;
&lt;br/&gt;
public class ImageIOJpegBug {&lt;br/&gt;
	public static void main(String[] args) throws Exception {&lt;br/&gt;
		FileImageInputStream input = new FileImageInputStream(new java.io.File(&amp;quot;example.jpeg&amp;quot;));&lt;br/&gt;
		ImageReader reader = (ImageReader) ImageIO.getImageReaders(input).next();&lt;br/&gt;
		reader.setInput(input);&lt;br/&gt;
		reader.getImageMetadata(reader.getMinIndex());&lt;br/&gt;
	}&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
---------- END SOURCE ----------&lt;br/&gt;
&lt;br/&gt;
CUSTOMER SUBMITTED WORKAROUND :&lt;br/&gt;
Modify the JPEG file so that the marker is not recognised as an Adobe application marker.&lt;br/&gt;
&lt;br/&gt;
Alternatively, add a byte to the end of the file.&lt;br/&gt;
</description>
                <environment></environment>
        <key id="4262120">JDK-6355567</key>
            <summary>AdobeMarkerSegment causes failure to read valid JPEG</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cushon">Liam Miller-Cushon</assignee>
                                    <reporter username="ndcosta">Nelson Dcosta</reporter>
                        <labels>
                            <label>amazon-interest</label>
                            <label>jdk17u-fix-request</label>
                            <label>jdk17u-fix-yes</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>webbug</label>
                    </labels>
                <created>Fri, 25 Nov 2005 11:57:13 -0800</created>
                <updated>Wed, 19 Feb 2025 09:48:22 -0800</updated>
                            <resolved>Thu, 13 Jul 2023 12:38:05 -0700</resolved>
                                    <version>1.4.2</version>
                    <version>8</version>
                    <version>11</version>
                    <version>17</version>
                    <version>21</version>
                    <version>22</version>
                                    <fixVersion>22</fixVersion>
                                    <component>client-libs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="14753868" author="roboduke" created="Fri, 14 Feb 2025 14:28:59 -0800"  >[jdk17u-fix-request] Approval Request from Michael De Vera&lt;br/&gt;
Clean backport to fix an exception which can be thrown upon reading JPEG files with adobe application markers, due to assuming an incorrect marker length. Also adds new test to confirm fix. Tier1 and jdk_desktop tests passing.</comment>
                            <comment id="14752175" author="roboduke" created="Thu, 13 Feb 2025 11:39:13 -0800"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u-dev/pull/2977&quot;&gt;https://git.openjdk.org/jdk17u-dev/pull/2977&lt;/a&gt;&lt;br/&gt;
Date: 2024-10-18 23:02:44 +0000</comment>
                            <comment id="14697763" author="serb" created="Mon, 12 Aug 2024 20:21:51 -0700"  >Fix request (21u)&lt;br/&gt;
&lt;br/&gt;
Clean backport. This is a fix for an unexpected exception when loading some image file. The fix has been verified by a new test.&lt;br/&gt;
The :jdk_desktop tests did not find any new issues.&lt;br/&gt;
Review 21u-dev: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/806&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/806&lt;/a&gt;</comment>
                            <comment id="14697758" author="serb" created="Mon, 12 Aug 2024 20:14:57 -0700"  >&amp;quot;noreg-hard&amp;quot; label is deleted since the new test was added by the patch:  javax/imageio/plugins/jpeg/LargeAdobeMarkerSegmentTest.java</comment>
                            <comment id="14685940" author="roboduke" created="Mon, 1 Jul 2024 00:49:26 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/806&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/806&lt;/a&gt;&lt;br/&gt;
Date: 2024-07-01 07:06:53 +0000</comment>
                            <comment id="14596445" author="jdv" created="Sun, 16 Jul 2023 22:21:05 -0700"  >I was surprised to see this JBS issue in my resolved list. Looks like this is approved and integrated when i was on vacation.&lt;br/&gt;
&lt;br/&gt;
So re-assigning this issue to appropriate owner.</comment>
                            <comment id="14596148" author="dukebot" created="Thu, 13 Jul 2023 12:38:04 -0700"  >Changeset: c7c6d47a&lt;br/&gt;
Author:    Liam Miller-Cushon &amp;lt;&lt;a href=&apos;mailto:cushon@openjdk.org&apos;&gt;cushon@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-07-13 19:36:36 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/c7c6d47a07100f6c81af6cfad301ec1bda77adf7&quot;&gt;https://git.openjdk.org/jdk/commit/c7c6d47a07100f6c81af6cfad301ec1bda77adf7&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14594133" author="roboduke" created="Wed, 5 Jul 2023 16:25:18 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/14779&quot;&gt;https://git.openjdk.org/jdk/pull/14779&lt;/a&gt;&lt;br/&gt;
Date: 2023-07-05 23:19:39 +0000</comment>
                            <comment id="14594132" author="cushon" created="Wed, 5 Jul 2023 16:16:30 -0700"  >These issues describe the same underlying issue, and include attached images that reproduce the crash:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;https://github.com/haraldk/TwelveMonkeys/issues/111&quot;&gt;https://github.com/haraldk/TwelveMonkeys/issues/111&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/haraldk/TwelveMonkeys/issues/113&quot;&gt;https://github.com/haraldk/TwelveMonkeys/issues/113&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Repro:&lt;br/&gt;
&lt;br/&gt;
```&lt;br/&gt;
import java.io.ByteArrayInputStream;&lt;br/&gt;
import java.io.File;&lt;br/&gt;
import java.io.IOException;&lt;br/&gt;
import javax.imageio.ImageIO;&lt;br/&gt;
import javax.imageio.ImageReader;&lt;br/&gt;
import javax.imageio.stream.ImageInputStream;&lt;br/&gt;
&lt;br/&gt;
public class Test {&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;public static void main(String[] args) throws IOException {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;File f = new File(args[0]);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ImageInputStream iis = ImageIO.createImageInputStream(f);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ImageReader r = ImageIO.getImageReaders(iis).next();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;r.setInput(iis);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;r.getImageMetadata(0);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
}&lt;br/&gt;
```&lt;br/&gt;
&lt;br/&gt;
java -fullversion&lt;br/&gt;
openjdk full version &amp;quot;21-ea+29-2411&amp;quot;&lt;br/&gt;
&lt;br/&gt;
wget &lt;a href=&quot;https://cloud.githubusercontent.com/assets/110299/6576022/3223f988-c734-11e4-9069-c821fd9b9476.jpg&quot;&gt;https://cloud.githubusercontent.com/assets/110299/6576022/3223f988-c734-11e4-9069-c821fd9b9476.jpg&lt;/a&gt;&lt;br/&gt;
java Test 3223f988-c734-11e4-9069-c821fd9b9476.jpg&lt;br/&gt;
Exception in thread &amp;quot;main&amp;quot; javax.imageio.IIOException: Inconsistent metadata read from stream&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.desktop/com.sun.imageio.plugins.jpeg.JPEGMetadata.&amp;lt;init&amp;gt;(JPEGMetadata.java:361)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.desktop/com.sun.imageio.plugins.jpeg.JPEGImageReader.getImageMetadata(JPEGImageReader.java:1145)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at Test.main(Test.java:15)&lt;br/&gt;
&lt;br/&gt;
wget &lt;a href=&quot;https://cloud.githubusercontent.com/assets/110299/6575916/67cba7bc-c733-11e4-85f3-4b3bd5de56db.jpg&quot;&gt;https://cloud.githubusercontent.com/assets/110299/6575916/67cba7bc-c733-11e4-85f3-4b3bd5de56db.jpg&lt;/a&gt;&lt;br/&gt;
java Test 67cba7bc-c733-11e4-85f3-4b3bd5de56db.jpg&lt;br/&gt;
Exception in thread &amp;quot;main&amp;quot; java.lang.NegativeArraySizeException: -94&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.desktop/com.sun.imageio.plugins.jpeg.SOSMarkerSegment.&amp;lt;init&amp;gt;(SOSMarkerSegment.java:72)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.desktop/com.sun.imageio.plugins.jpeg.JPEGMetadata.&amp;lt;init&amp;gt;(JPEGMetadata.java:318)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.desktop/com.sun.imageio.plugins.jpeg.JPEGImageReader.getImageMetadata(JPEGImageReader.java:1145)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at Test.main(Test.java:15)</comment>
                            <comment id="13473302" author="bae" created="Tue, 18 Mar 2014 04:41:12 -0700"  >Please re-open if&lt;br/&gt;
&amp;nbsp;- if fix is in progress or on the plan to fix soon&lt;br/&gt;
&amp;nbsp;- if this is a P3 (file as P3, not P4) </comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5136764">JDK-8338356</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5151026">JDK-8350370</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17004"><![CDATA[x86]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10001" key="com.atlassian.jira.plugin.system.customfieldtypes:datetime">
                        <customfieldname>Imported</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 16 Sep 2012 14:02:33 -0700</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10002" key="com.atlassian.jira.plugin.system.customfieldtypes:datetime">
                        <customfieldname>Indexed</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 18 Jul 2012 08:47:43 -0700</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17007"><![CDATA[windows_xp]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0kiw7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>119702</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17335"><![CDATA[b07]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="323"><![CDATA[javax.imageio]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>