<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 19:23:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8307944] ClassFileDumper should only load java.nio.file.Path if enabled</title>
                <link>https://bugs.openjdk.org/browse/JDK-8307944</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>When the shared ClassFileDumper (&lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8304846&quot; title=&quot;Provide a shared utility to dump generated classes defined via Lookup API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8304846&quot;&gt;&lt;strike&gt;JDK-8304846&lt;/strike&gt;&lt;/a&gt;) was added, the sequence of classes loaded changed and more classes are loaded. It would be desirable if there was little/no extra overhead when not configured to dump classes.&lt;br/&gt;
&lt;br/&gt;
The use of java.nio.file.Path in MethodHandleStatics causes the file system to be loaded earlier than before. &lt;br/&gt;
</description>
                <environment></environment>
        <key id="5100737">JDK-8307944</key>
            <summary>ClassFileDumper should only load java.nio.file.Path if enabled</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mchung">Mandy Chung</assignee>
                                    <reporter username="rriggs">Roger Riggs</reporter>
                        <labels>
                    </labels>
                <created>Thu, 11 May 2023 07:55:49 -0700</created>
                <updated>Sun, 4 Jun 2023 20:15:39 -0700</updated>
                            <resolved>Tue, 30 May 2023 14:04:17 -0700</resolved>
                                    <version>21</version>
                                    <fixVersion>21</fixVersion>
                                    <component>core-libs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14585755" author="dukebot" created="Tue, 30 May 2023 14:04:16 -0700"  >Changeset: de7fd1c3&lt;br/&gt;
Author:    Mandy Chung &amp;lt;&lt;a href=&apos;mailto:mchung@openjdk.org&apos;&gt;mchung@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-05-30 21:01:12 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/de7fd1c3061cfbfdbd5d7cc2b1ba0ee8d432ee0a&quot;&gt;https://git.openjdk.org/jdk/commit/de7fd1c3061cfbfdbd5d7cc2b1ba0ee8d432ee0a&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14584665" author="roboduke" created="Thu, 25 May 2023 13:44:32 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/14160&quot;&gt;https://git.openjdk.org/jdk/pull/14160&lt;/a&gt;&lt;br/&gt;
Date: 2023-05-25 20:23:27 +0000</comment>
                            <comment id="14584285" author="mchung" created="Wed, 24 May 2023 20:18:08 -0700"  >Both JDK-8307570 and  &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8306678&quot; title=&quot;Replace use of os.version with an internal Version record&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8306678&quot;&gt;&lt;strike&gt;JDK-8306678&lt;/strike&gt;&lt;/a&gt; change the sequence of classes loaded during startup.  JDK-8307570 causes ClassFileDumper to have a dependency on java.nio.file.Path, i.e. MethodHandleStatics causes java.nio.file.Path and other file system classes to be loaded.   In addition, FilePermission class initialization will also cause the default file system to be initialized (ClassFileDumper uses the limited doPrivileged with FilePermission and PropertyPermission).&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8306678&quot; title=&quot;Replace use of os.version with an internal Version record&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8306678&quot;&gt;&lt;strike&gt;JDK-8306678&lt;/strike&gt;&lt;/a&gt; causes ClassLoaderHelper to call OperatingSystem::version on macOS and OperatingSystem::&amp;lt;clinit&amp;gt; calls Enum::valueOf which in turns invokes the values method of jdk.internal.util.Version enum class via core reflection which will cause invocation of MethodHandle.   This may cause additional lambda forms to be generated and loaded (set -Djdk.invoke.MethodHandle.dumpMethodHandleInternals to check).&lt;br/&gt;
&lt;br/&gt;
Here is the comparison of the number of loaded classes of running java -version:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;431 jdk-21+16.startup.loaded-classes&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;473 jdk-21+17.startup.loaded-classes&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;485 master.startup.loaded-classes&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;527 patch.startup.loaded-classes&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;437 patch+no-enum-valueOf.startup.loaded-classes&lt;br/&gt;
&lt;br/&gt;
where &amp;quot;patch&amp;quot; changes ClassFileDumper to use java.io.File to validate if the given path is a writeable directory if exists.&lt;br/&gt;
Apparently additional lambda forms are spinned and cause more classes to be loaded (need to understand why no LFs are spinned without this patch).&lt;br/&gt;
&lt;br/&gt;
&amp;quot;patch+no-enum-valueOf&amp;quot; includes another patch in OperatingSystem::initOS not to use OperatingSystem.valueOf; instead map manually from the name to the enum constant that makes 90 fewer classes to be loaded.&lt;br/&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5101932">JDK-8308960</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5097029">JDK-8304846</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i31hnv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17411"><![CDATA[b25]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="213"><![CDATA[java.lang.invoke]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>