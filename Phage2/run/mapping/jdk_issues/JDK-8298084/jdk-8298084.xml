<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 14:34:28 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8298084] Memory leak in Method::build_profiling_method_data</title>
                <link>https://bugs.openjdk.org/browse/JDK-8298084</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>LSan has hinted at a memory leak in MethodData related to _extra_data_lock. It looks like MethodData::deallocate_contents is being called before ~MethodData from Method::release_C_heap_structures(), leading to the memory used by _extra_data_lock not being released.&lt;br/&gt;
&lt;br/&gt;
I confirmed this by switching _extra_data_lock to be a pointer and adding a guarantee to MethodData::deallocate_contents that asserts it should be NULL. It crashes at the guarantee. I&amp;#39;ll see if I can get the call trace.</description>
                <environment></environment>
        <key id="5088880">JDK-8298084</key>
            <summary>Memory leak in Method::build_profiling_method_data</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://bugs.openjdk.org/images/jbsImages/p2.png">P2</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="coleenp">Coleen Phillimore</assignee>
                                    <reporter username="jcking">Justin King</reporter>
                        <labels>
                            <label>noreg-hard</label>
                            <label>oracle-triage-20</label>
                            <label>regression</label>
                    </labels>
                <created>Sun, 4 Dec 2022 22:41:59 -0800</created>
                <updated>Tue, 20 Dec 2022 11:36:18 -0800</updated>
                            <resolved>Tue, 13 Dec 2022 05:04:18 -0800</resolved>
                                    <version>20</version>
                                    <fixVersion>20</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14545073" author="dukebot" created="Tue, 13 Dec 2022 05:04:17 -0800"  >Changeset: 04b8d0cf&lt;br/&gt;
Author:    Coleen Phillimore &amp;lt;&lt;a href=&apos;mailto:coleenp@openjdk.org&apos;&gt;coleenp@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2022-12-13 13:02:23 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk20/commit/04b8d0cf5c964e16c583b66d9ab43a8c9a85fd72&quot;&gt;https://git.openjdk.org/jdk20/commit/04b8d0cf5c964e16c583b66d9ab43a8c9a85fd72&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14544253" author="roboduke" created="Fri, 9 Dec 2022 08:25:00 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk20/pull/13&quot;&gt;https://git.openjdk.org/jdk20/pull/13&lt;/a&gt;&lt;br/&gt;
Date: 2022-12-09 16:16:00 +0000</comment>
                            <comment id="14543162" author="thartmann" created="Tue, 6 Dec 2022 07:20:56 -0800"  >ILW = Memory leak, in rare cases when MethodData is allocated by multiple threads, no workaround = HLH = P2</comment>
                            <comment id="14543161" author="thartmann" created="Tue, 6 Dec 2022 07:19:17 -0800"  >Moving to hotspot/compiler because this is a regression from &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8297389&quot; title=&quot;resexhausted003 fails with assert(!thread-&amp;gt;owns_locks()) failed: must release all locks when leaving VM&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8297389&quot;&gt;&lt;strike&gt;JDK-8297389&lt;/strike&gt;&lt;/a&gt;.&lt;br/&gt;
&lt;br/&gt;
EDIT: Moving back to hotspot/runtime who are experts in this code.</comment>
                            <comment id="14543022" author="JIRAUSER20603" created="Mon, 5 Dec 2022 22:26:55 -0800"  >I found it by inspecting the core dump. Method::build_profiling_method_data allocates MethodData and in some cases will immediately deallocate it if it fails an atomic swap. When doing so, it fails to release malloc-based heap memory used by MethodData. Sent &lt;a href=&quot;https://github.com/openjdk/jdk/pull/11526&quot;&gt;https://github.com/openjdk/jdk/pull/11526&lt;/a&gt;.</comment>
                            <comment id="14543020" author="roboduke" created="Mon, 5 Dec 2022 22:25:44 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/11526&quot;&gt;https://git.openjdk.org/jdk/pull/11526&lt;/a&gt;&lt;br/&gt;
Date: 2022-12-06 06:13:23 +0000</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5089562">JDK-8298666</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5088033">JDK-8297389</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5089177">JDK-8298346</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2zhij:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17423"><![CDATA[b28]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="192"><![CDATA[runtime]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>