<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 08:43:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8256302] releasing oopStorage when deflating allows for faster deleting</title>
                <link>https://bugs.openjdk.org/browse/JDK-8256302</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>The loop for deleting ObjectMonitor is slow because of the transition to blocked for each iteration.&lt;br/&gt;
If we release oopStorage when deflating we can do this entire loop while blocked instead, which will be much faster.&lt;br/&gt;
Since we only need to free some c-heap.&lt;br/&gt;
From similar situations the differences can be up to 10x, mainly due to compiler may use much more aggressive optimizations and much better predictions (the list is random access).&lt;br/&gt;
In rare situations when we have a list with 10 k OMs, using 10 usec per item instead of 100 usec can mean we will not &amp;quot;get behind&amp;quot;.&lt;br/&gt;
&lt;br/&gt;
E.g. we then could do:&lt;br/&gt;
&amp;gt;    size_t deleted_count = 0;&lt;br/&gt;
&amp;gt;    ThreadBlockInVM tbivm(self);&lt;br/&gt;
&amp;gt;     for (ObjectMonitor* monitor: delete_list) {&lt;br/&gt;
&amp;gt;       delete monitor;&lt;br/&gt;
&amp;gt;       deleted_count++;&lt;br/&gt;
&amp;gt;     }&lt;br/&gt;
&amp;gt;   }&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
        <key id="5034473">JDK-8256302</key>
            <summary>releasing oopStorage when deflating allows for faster deleting</summary>
                <type id="7" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14707&amp;avatarType=issuetype">Enhancement</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dcubed">Daniel Daugherty</assignee>
                                    <reporter username="dcubed">Daniel Daugherty</reporter>
                        <labels>
                            <label>sync</label>
                    </labels>
                <created>Thu, 12 Nov 2020 13:08:54 -0800</created>
                <updated>Wed, 22 Nov 2023 07:12:54 -0800</updated>
                            <resolved>Wed, 7 Jun 2023 13:07:59 -0700</resolved>
                                    <version>16</version>
                                    <fixVersion>21</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                                                            <comments>
                            <comment id="14628461" author="pchilanomate" created="Wed, 22 Nov 2023 07:12:54 -0800"  >This change has been effectively backed out by &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8319137&quot; title=&quot;release _object in ObjectMonitor dtor to avoid races&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8319137&quot;&gt;&lt;strike&gt;JDK-8319137&lt;/strike&gt;&lt;/a&gt;.</comment>
                            <comment id="14623128" author="dholmes" created="Wed, 1 Nov 2023 16:55:24 -0700"  >This changed has introduced a race condition - see &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8319137&quot; title=&quot;release _object in ObjectMonitor dtor to avoid races&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8319137&quot;&gt;&lt;strike&gt;JDK-8319137&lt;/strike&gt;&lt;/a&gt;</comment>
                            <comment id="14587767" author="dcubed" created="Wed, 7 Jun 2023 13:07:45 -0700"  >Fix was pushed while main bug was targeted to &amp;#39;22&amp;#39;. Reset the main bug to fixed in &amp;#39;21&amp;#39; and copied the Robo Duke entry here.</comment>
                            <comment id="14587766" author="dcubed" created="Wed, 7 Jun 2023 13:07:19 -0700"  >Dukebot added a comment - 5 minutes ago&lt;br/&gt;
Changeset: 64020048&lt;br/&gt;
Author: Daniel D. Daugherty &amp;lt;&lt;a href=&apos;mailto:dcubed@openjdk.org&apos;&gt;dcubed@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date: 2023-06-07 19:59:13 +0000&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/commit/6402004852ccc993bb6e879c49fb71e2afdcdfbe&quot;&gt;https://git.openjdk.org/jdk/commit/6402004852ccc993bb6e879c49fb71e2afdcdfbe&lt;/a&gt;</comment>
                            <comment id="14586793" author="dcubed" created="Sun, 4 Jun 2023 07:11:52 -0700"  >The v03 version of the patch has been rebased to jdk-21+25 and another&lt;br/&gt;
round of Mach5 testing is being done:&lt;br/&gt;
&lt;br/&gt;
Mach5 Tier1:&lt;br/&gt;
- no failures&lt;br/&gt;
&lt;br/&gt;
Mach5 Tier2:&lt;br/&gt;
- no failures&lt;br/&gt;
&lt;br/&gt;
Mach5 Tier3:&lt;br/&gt;
- no failures&lt;br/&gt;
&lt;br/&gt;
Mach5 Tier4:&lt;br/&gt;
- no failures&lt;br/&gt;
&lt;br/&gt;
Mach5 Tier5:&lt;br/&gt;
- 1 unknown, unrelated test failure:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;- javax/management/remote/mandatory/socketFactories/RMISocketFactoriesTest.java&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;failed with:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Unexpected exception caught = java.io.IOException: Cannot bind to URL [&lt;a href=&quot;rmi://:5801/server5801&quot;&gt;rmi://:5801/server5801&lt;/a&gt;]:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;javax.naming.CommunicationException [Root exception is java.rmi.ServerException: RemoteException occurred in server thread; nested exception is:&lt;br/&gt;
java.rmi.UnmarshalException: error unmarshalling arguments; nested exception is:&lt;br/&gt;
java.lang.ClassNotFoundException: RMIClientFactory (no security manager: RMI class loader disabled)]&lt;br/&gt;
&amp;nbsp;&amp;nbsp;- I&amp;#39;ve spotted this exact failure in another adhoc Mach5 job set so I don&amp;#39;t think this failure is related.&lt;br/&gt;
&lt;br/&gt;
Mach5 Tier6:&lt;br/&gt;
- 1 known, unrelated test failure:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;- jdk/jfr/tool/TestView.java failed due to a variant of &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8309238&quot; title=&quot;jdk/jfr/tool/TestView.java failed with &amp;quot;exitValue = 134&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8309238&quot;&gt;&lt;strike&gt;JDK-8309238&lt;/strike&gt;&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Mach5 Tier7:&lt;br/&gt;
- no failures&lt;br/&gt;
&lt;br/&gt;
Mach5 Tier8:&lt;br/&gt;
- 2 known, unrelated test failures, 1 unknown, unrelated test failure&lt;br/&gt;
&amp;nbsp;&amp;nbsp;- vmTestbase/nsk/jvmti/SetFieldModificationWatch/setfmodw001/TestDescription.java&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;failed due to &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8205957&quot; title=&quot;setfldw001/TestDescription.java fails with bad field value&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8205957&quot;&gt;&lt;strike&gt;JDK-8205957&lt;/strike&gt;&lt;/a&gt;.&lt;br/&gt;
&amp;nbsp;&amp;nbsp;- applications/javafuzzer/BigTest.java failed due to &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8309268&quot; title=&quot;C2: &amp;quot;assert(in_bb(n)) failed: must be&amp;quot; after JDK-8306302&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8309268&quot;&gt;&lt;strike&gt;JDK-8309268&lt;/strike&gt;&lt;/a&gt;.&lt;br/&gt;
&amp;nbsp;&amp;nbsp;- applications/microbenchmarks/indy/Test_2.java#id18 failed due to&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;a test harness issue. </comment>
                            <comment id="14539650" author="roboduke" created="Tue, 22 Nov 2022 13:13:29 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/11296&quot;&gt;https://git.openjdk.org/jdk/pull/11296&lt;/a&gt;&lt;br/&gt;
Date: 2022-11-22 17:52:45 +0000</comment>
                            <comment id="14493849" author="dcubed" created="Wed, 4 May 2022 12:43:03 -0700"  >I won&amp;#39;t have time to investigate this issue for JDK19.</comment>
                            <comment id="14380530" author="dcubed" created="Thu, 12 Nov 2020 13:09:28 -0800"  >[~rehn] - Feel free to edit the bug to make things more clear&lt;br/&gt;
since all I did was copy stuff from the PR. </comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5102708">JDK-8309633</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5102666">JDK-8309599</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5113565">JDK-8319137</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5029648">JDK-8253064</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                                              <subtask id="5080448">JDK-8291418</subtask>
                                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17008"><![CDATA[generic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17010"><![CDATA[generic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2qabf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17357"><![CDATA[b26]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="192"><![CDATA[runtime]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>