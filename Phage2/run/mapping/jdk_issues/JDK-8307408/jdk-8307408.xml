<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 10:45:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8307408] Some jdk/sun/tools/jhsdb tests don&apos;t pass test JVM args to the debuggee JVM</title>
                <link>https://bugs.openjdk.org/browse/JDK-8307408</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>The JStackStressTest.java, JShellHeapDumpTest, and HeapDumpTestWithActiveProcess launch the target JVM without any arguments. The end result is that we don&amp;#39;t always get the testing we expect. For example, proper SA testing is heavily depending on the GC of the targetVM, but it will always end up being the default GC (G1). So when you run a test with -XX:+UseZGC, the test will be run with ZGC, jhsdb will be run with ZGC, but the JVM that jhsdb is debugging will use G1, and it is in fact the debuggee that we really want running with ZGC. We don&amp;#39;t care so much about what GC is used for the test and jhsdb.&lt;br/&gt;
&lt;br/&gt;
Using JStackStressTest.java as an example, we can see the problem here:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ProcessBuilder pb = new ProcessBuilder(JDKToolFinder.getTestJDKTool(&amp;quot;jshell&amp;quot;));&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;jShellProcess = ProcessTools.startProcess(&amp;quot;JShell&amp;quot;, pb);&lt;br/&gt;
&lt;br/&gt;
We should be using the JDKToolLauncher class. A working example can be found in ClhsdbLauncher.java:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;JDKToolLauncher launcher = JDKToolLauncher.createUsingTestJDK(&amp;quot;jhsdb&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;launcher.addVMArgs(Utils.getTestJavaOpts());&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;launcher.addToolArg(&amp;quot;clhsdb&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;launcher.addToolArg(&amp;quot;--core=&amp;quot; + coreFileName);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;launcher.addToolArg(&amp;quot;--exe=&amp;quot; + JDKToolFinder.getTestJDKTool(&amp;quot;java&amp;quot;));&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ProcessBuilder processBuilder = new ProcessBuilder(launcher.getCommand());&lt;br/&gt;
&lt;br/&gt;
I think what will work for JStackStressTest.java is (this is completely untested):&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;JDKToolLauncher launcher = JDKToolLauncher.createUsingTestJDK(&amp;quot;jshell&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;launcher.addVMArgs(Utils.getTestJavaOpts());&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ProcessBuilder pb = new ProcessBuilder(launcher.getCommand());&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;jShellProcess = ProcessTools.startProcess(&amp;quot;JShell&amp;quot;, pb);&lt;br/&gt;
&lt;br/&gt;
This will get -XX:+UseZGC passed to the debuggee process. Note if there are any options we want filtered out, we can do something like the following:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;launcher.addVMArgs(Utils.getFilteredTestJavaOpts(&amp;quot;-Xcomp&amp;quot;));&lt;br/&gt;
</description>
                <environment></environment>
        <key id="5100078">JDK-8307408</key>
            <summary>Some jdk/sun/tools/jhsdb tests don&apos;t pass test JVM args to the debuggee JVM</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cjplummer">Chris Plummer</assignee>
                                    <reporter username="cjplummer">Chris Plummer</reporter>
                        <labels>
                            <label>jdk17u-fix-request</label>
                            <label>jdk17u-fix-yes</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>noreg-self</label>
                    </labels>
                <created>Wed, 3 May 2023 16:02:08 -0700</created>
                <updated>Sat, 5 Oct 2024 10:13:00 -0700</updated>
                            <resolved>Mon, 7 Aug 2023 11:52:55 -0700</resolved>
                                                    <fixVersion>22</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14710296" author="roboduke" created="Fri, 4 Oct 2024 04:05:26 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u-dev/pull/2938&quot;&gt;https://git.openjdk.org/jdk17u-dev/pull/2938&lt;/a&gt;&lt;br/&gt;
Date: 2024-10-04 10:59:04 +0000</comment>
                            <comment id="14710294" author="goetz" created="Fri, 4 Oct 2024 04:00:10 -0700"  >Fix request [17u]&lt;br/&gt;
&lt;br/&gt;
I backport this to improve testing in 17.&lt;br/&gt;
No risk, only a test change.&lt;br/&gt;
I had to resolve, probably clean anyways.&lt;br/&gt;
Tests pass. SAP nightly testing passed.</comment>
                            <comment id="14635543" author="roboduke" created="Tue, 19 Dec 2023 08:38:38 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/73&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/73&lt;/a&gt;&lt;br/&gt;
Date: 2023-12-19 16:30:40 +0000</comment>
                            <comment id="14635541" author="goetz" created="Tue, 19 Dec 2023 08:26:46 -0800"  >Fix request [21u]&lt;br/&gt;
&lt;br/&gt;
I backport this to keep the 21u test suite up-to-date. This will simplify future test backports.&lt;br/&gt;
No risk, only a test change.&lt;br/&gt;
Clean backport.&lt;br/&gt;
Tests pass. SAP nightly testing passed.</comment>
                            <comment id="14602333" author="dukebot" created="Mon, 7 Aug 2023 11:52:54 -0700"  >Changeset: 87b08b6e&lt;br/&gt;
Author:    Chris Plummer &amp;lt;&lt;a href=&apos;mailto:cjplummer@openjdk.org&apos;&gt;cjplummer@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-08-07 18:51:29 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/87b08b6e0192d88025c2275c7dd2c4bdecda58e8&quot;&gt;https://git.openjdk.org/jdk/commit/87b08b6e0192d88025c2275c7dd2c4bdecda58e8&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14602040" author="roboduke" created="Fri, 4 Aug 2023 15:47:32 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/15168&quot;&gt;https://git.openjdk.org/jdk/pull/15168&lt;/a&gt;&lt;br/&gt;
Date: 2023-08-04 22:41:43 +0000</comment>
                            <comment id="14586455" author="cjplummer" created="Thu, 1 Jun 2023 15:15:15 -0700"  >Deferring to 22. This could introduce some testing instability, which I don&amp;#39;t want to risk just before RDP1.</comment>
                            <comment id="14578912" author="cjplummer" created="Wed, 3 May 2023 16:07:46 -0700"  >Since SA ZGC support is not very stable, this could possibly result in some new failures when running with ZGC. The failing tests should be problem listed in that case.</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5117651">JDK-8322602</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5140723">JDK-8341579</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5107468">JDK-8313798</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5107277">JDK-8313655</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i31dlf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17338"><![CDATA[b10]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="2072"><![CDATA[svc-agent]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>