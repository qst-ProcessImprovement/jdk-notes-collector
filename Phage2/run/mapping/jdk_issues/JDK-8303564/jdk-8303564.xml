<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 17:25:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8303564] C2: &quot;Bad graph detected in build_loop_late&quot; after a CMove is wrongly split thru phi</title>
                <link>https://bugs.openjdk.org/browse/JDK-8303564</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>Running attached test case with:&lt;br/&gt;
java -XX:-BackgroundCompilation TestWrongCMovSplitIf&lt;br/&gt;
&lt;br/&gt;
results in:&lt;br/&gt;
&lt;br/&gt;
n:   817  AddI  === _ 355 355  [[ 1132 ]]  !orig=[743],[356],803 !jvms: TestWrongCMovSplitIf::testHelper @ bci:37 (line 74) TestWrongCMovSplitIf::test @ bci:43 (line 50)&lt;br/&gt;
early(n):   736  IfFalse  === 735  [[ 355 372 383 ]] #0 !orig=[727] !jvms: TestWrongCMovSplitIf::testHelper @ bci:28 (line 73) TestWrongCMovSplitIf::test @ bci:43 (line 50)&lt;br/&gt;
n-&amp;gt;in(1):   355  LoadI  === 736 7 354  [[ 817 1132 817 ]]  @int[int:&amp;gt;=0] (java/lang/Cloneable,java/io/Serializable):exact+any *, idx=6; #int !orig=[763],[356],803 !jvms: TestWrongCMovSplitIf::testHelper @ bci:36 (line 74) TestWrongCMovSplitIf::test @ bci:43 (line 50)&lt;br/&gt;
early(n-&amp;gt;in(1)):   736  IfFalse  === 735  [[ 355 372 383 ]] #0 !orig=[727] !jvms: TestWrongCMovSplitIf::testHelper @ bci:28 (line 73) TestWrongCMovSplitIf::test @ bci:43 (line 50)&lt;br/&gt;
n-&amp;gt;in(1)-&amp;gt;in(1):     7  Parm  === 3  [[ 730 1137 16 355 273 397 385 465 318 453 372 612 441 409 ]] Memory  Memory: @BotPTR *+bot, idx=Bot; !orig=[73] !jvms: TestWrongCMovSplitIf::test @ bci:-1 (line 43)&lt;br/&gt;
early(n-&amp;gt;in(1)-&amp;gt;in(1)):     3  Start  === 3 0  [[ 3 5 6 7 8 9 10 ]]  #{0:control, 1:abIO, 2:memory, 3:rawptr:BotPTR, 4:return_address, 5:int}&lt;br/&gt;
n-&amp;gt;in(1)-&amp;gt;in(2):   354  AddP  === _ 334 334 353  [[ 355 ]]  !jvms: TestWrongCMovSplitIf::testHelper @ bci:36 (line 74) TestWrongCMovSplitIf::test @ bci:43 (line 50)&lt;br/&gt;
early(n-&amp;gt;in(1)-&amp;gt;in(2)):   724  IfTrue  === 723  [[ 735 334 ]] #1&lt;br/&gt;
n-&amp;gt;in(2):   355  LoadI  === 736 7 354  [[ 817 1132 817 ]]  @int[int:&amp;gt;=0] (java/lang/Cloneable,java/io/Serializable):exact+any *, idx=6; #int !orig=[763],[356],803 !jvms: TestWrongCMovSplitIf::testHelper @ bci:36 (line 74) TestWrongCMovSplitIf::test @ bci:43 (line 50)&lt;br/&gt;
early(n-&amp;gt;in(2)):   736  IfFalse  === 735  [[ 355 372 383 ]] #0 !orig=[727] !jvms: TestWrongCMovSplitIf::testHelper @ bci:28 (line 73) TestWrongCMovSplitIf::test @ bci:43 (line 50)&lt;br/&gt;
n-&amp;gt;in(2)-&amp;gt;in(1):     7  Parm  === 3  [[ 730 1137 16 355 273 397 385 465 318 453 372 612 441 409 ]] Memory  Memory: @BotPTR *+bot, idx=Bot; !orig=[73] !jvms: TestWrongCMovSplitIf::test @ bci:-1 (line 43)&lt;br/&gt;
early(n-&amp;gt;in(2)-&amp;gt;in(1)):     3  Start  === 3 0  [[ 3 5 6 7 8 9 10 ]]  #{0:control, 1:abIO, 2:memory, 3:rawptr:BotPTR, 4:return_address, 5:int}&lt;br/&gt;
n-&amp;gt;in(2)-&amp;gt;in(2):   354  AddP  === _ 334 334 353  [[ 355 ]]  !jvms: TestWrongCMovSplitIf::testHelper @ bci:36 (line 74) TestWrongCMovSplitIf::test @ bci:43 (line 50)&lt;br/&gt;
early(n-&amp;gt;in(2)-&amp;gt;in(2)):   724  IfTrue  === 723  [[ 735 334 ]] #1&lt;br/&gt;
&lt;br/&gt;
LCA(n):   253  IfTrue  === 252  [[ 248 ]] #1 !jvms: TestWrongCMovSplitIf::testHelper @ bci:10 (line 66) TestWrongCMovSplitIf::test @ bci:43 (line 50)&lt;br/&gt;
n-&amp;gt;out(0):  1132  Phi  === 248 355 817  [[ 372 ]]  #int !orig=[1103],[752]&lt;br/&gt;
later(n-&amp;gt;out(0)):   248  Region  === 248 254 253  [[ 248 723 258 1132 ]]  !jvms: TestWrongCMovSplitIf::testHelper @ bci:20 (line 72) TestWrongCMovSplitIf::test @ bci:43 (line 50)&lt;br/&gt;
n-&amp;gt;out(0)-&amp;gt;out(0):   372  StoreI  === 736 7 371 1132  [[ 465 409 385 397 16 612 441 453 ]]  @java/lang/Class (java/io/Serializable,java/lang/constant/Constable,java/lang/reflect/AnnotatedElement,java/lang/invoke/TypeDescriptor,java/lang/reflect/GenericDeclaration,java/lang/reflect/Type,java/lang/invoke/TypeDescriptor$OfField):exact+116 *, name=field3, idx=7;  Memory: @java/lang/Class (java/io/Serializable,java/lang/constant/Constable,java/lang/reflect/AnnotatedElement,java/lang/invoke/TypeDescriptor,java/lang/reflect/GenericDeclaration,java/lang/reflect/Type,java/lang/invoke/TypeDescriptor$OfField):exact+116 *, name=field3, idx=7; !orig=[420] !jvms: TestWrongCMovSplitIf::test @ bci:46 (line 50)&lt;br/&gt;
later(n-&amp;gt;out(0)-&amp;gt;out(0)):   736  IfFalse  === 735  [[ 355 372 383 ]] #0 !orig=[727] !jvms: TestWrongCMovSplitIf::testHelper @ bci:28 (line 73) TestWrongCMovSplitIf::test @ bci:43 (line 50)&lt;br/&gt;
&lt;br/&gt;
idoms of early &amp;quot;736 IfFalse&amp;quot;:&lt;br/&gt;
idom[4]:    252  If&lt;br/&gt;
idom[3]:    248  Region&lt;br/&gt;
idom[2]:    723  If&lt;br/&gt;
idom[1]:    724  IfTrue&lt;br/&gt;
idom[0]:    735  RangeCheck&lt;br/&gt;
n:          736  IfFalse&lt;br/&gt;
&lt;br/&gt;
idoms of (wrong) LCA &amp;quot;253 IfTrue&amp;quot;:&lt;br/&gt;
idom[0]:    252  If&lt;br/&gt;
n:          253  IfTrue&lt;br/&gt;
&lt;br/&gt;
Real LCA of early &amp;quot;736 IfFalse&amp;quot; (idom[4]) and wrong LCA &amp;quot;253 IfTrue&amp;quot; (idom[0]):&lt;br/&gt;
&amp;nbsp;&amp;nbsp;252  If  === 5 251  [[ 253 254 ]] P=0.900000, C=-1.000000 !jvms: TestWrongCMovSplitIf::testHelper @ bci:10 (line 66) TestWrongCMovSplitIf::test @ bci:43 (line 50)&lt;br/&gt;
&lt;br/&gt;
#&lt;br/&gt;
# A fatal error has been detected by the Java Runtime Environment:&lt;br/&gt;
#&lt;br/&gt;
#  Internal Error (/home/roland/jdk-jdk/src/hotspot/share/opto/loopnode.cpp:5957), pid=3104555, tid=3104568&lt;br/&gt;
#  assert(false) failed: Bad graph detected in build_loop_late&lt;br/&gt;
#&lt;br/&gt;
# JRE version: OpenJDK Runtime Environment (21.0) (slowdebug build 21-internal-adhoc.roland.jdk-jdk)&lt;br/&gt;
# Java VM: OpenJDK 64-Bit Server VM (slowdebug 21-internal-adhoc.roland.jdk-jdk, mixed mode, tiered, compressed oops, compressed class ptrs, g1 gc, linux-amd64)&lt;br/&gt;
# Problematic frame:&lt;br/&gt;
# V  [libjvm.so+0xfb4b8a]  PhaseIdealLoop::build_loop_late_post_work(Node*, bool)+0x620&lt;br/&gt;
#&lt;br/&gt;
# Core dump will be written. Default location: Core dumps may be processed with &amp;quot;/usr/lib/systemd/systemd-coredump %P %u %g %s %t %c %h&amp;quot; (or dumping to /home/roland/tmp/core.3104555)&lt;br/&gt;
#&lt;br/&gt;
# An error report file with more information is saved as:&lt;br/&gt;
# /home/roland/tmp/hs_err_pid3104555.log&lt;br/&gt;
#&lt;br/&gt;
# If you would like to submit a bug report, please visit:&lt;br/&gt;
#   &lt;a href=&quot;https://bugreport.java.com/bugreport/crash.jsp&quot;&gt;https://bugreport.java.com/bugreport/crash.jsp&lt;/a&gt;&lt;br/&gt;
#&lt;br/&gt;
Aborted&lt;br/&gt;
</description>
                <environment></environment>
        <key id="5095452">JDK-8303564</key>
            <summary>C2: &quot;Bad graph detected in build_loop_late&quot; after a CMove is wrongly split thru phi</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://bugs.openjdk.org/images/jbsImages/p3.png">P3</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="roland">Roland Westrelin</assignee>
                                    <reporter username="roland">Roland Westrelin</reporter>
                        <labels>
                            <label>c2</label>
                            <label>jdk11u-fix-request</label>
                            <label>jdk11u-fix-yes</label>
                            <label>jdk17u-fix-request</label>
                            <label>jdk17u-fix-yes</label>
                            <label>jdk20u-fix-SQE-ok-next</label>
                            <label>jdk20u-fix-request</label>
                            <label>jdk20u-fix-yes</label>
                            <label>oracle-triage-21</label>
                    </labels>
                <created>Fri, 3 Mar 2023 01:51:00 -0800</created>
                <updated>Thu, 4 May 2023 04:05:17 -0700</updated>
                            <resolved>Thu, 9 Mar 2023 00:02:15 -0800</resolved>
                                    <version>8</version>
                    <version>11</version>
                    <version>17</version>
                    <version>20</version>
                    <version>21</version>
                                    <fixVersion>21</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14577599" author="roboduke" created="Fri, 28 Apr 2023 04:25:00 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk11u-dev/pull/1854&quot;&gt;https://git.openjdk.org/jdk11u-dev/pull/1854&lt;/a&gt;&lt;br/&gt;
Date: 2023-04-28 11:18:01 +0000</comment>
                            <comment id="14577597" author="roboduke" created="Fri, 28 Apr 2023 04:23:40 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u-dev/pull/1309&quot;&gt;https://git.openjdk.org/jdk17u-dev/pull/1309&lt;/a&gt;&lt;br/&gt;
Date: 2023-04-28 11:17:45 +0000</comment>
                            <comment id="14577596" author="goetz" created="Fri, 28 Apr 2023 04:11:08 -0700"  >Fix request [11u,17u]&lt;br/&gt;
&lt;br/&gt;
I backport this for parity with 11.0.20-oracke/17.0.8-oracle.&lt;br/&gt;
Simple change, low but typical C2 risk.&lt;br/&gt;
Clean backport.&lt;br/&gt;
Test passes, but also without the patch. SAP nightly testing passed.</comment>
                            <comment id="14570370" author="roboduke" created="Wed, 29 Mar 2023 04:46:03 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk20u/pull/38&quot;&gt;https://git.openjdk.org/jdk20u/pull/38&lt;/a&gt;&lt;br/&gt;
Date: 2023-03-29 11:41:32 +0000</comment>
                            <comment id="14570363" author="thartmann" created="Wed, 29 Mar 2023 04:42:15 -0700"  >Fix Request (JDK 20u)&lt;br/&gt;
Resolves an assert during C2 compilation. The fix is low risk, was already backported to Oracle JDK 17u / 11u and tested in the JDK 21 and 17u / 11u CIs. The backport applies cleanly.</comment>
                            <comment id="14565462" author="dukebot" created="Thu, 9 Mar 2023 00:02:09 -0800"  >Changeset: 5e232cf0&lt;br/&gt;
Author:    Roland Westrelin &amp;lt;&lt;a href=&apos;mailto:roland@openjdk.org&apos;&gt;roland@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-03-09 07:59:32 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/5e232cf0a96cf81036a2d9d7814127b7bc9ebab1&quot;&gt;https://git.openjdk.org/jdk/commit/5e232cf0a96cf81036a2d9d7814127b7bc9ebab1&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14564328" author="thartmann" created="Fri, 3 Mar 2023 02:56:30 -0800"  >ILW = Assert during C2 compilation, reproducible with test but never showed up &amp;quot;in the wild&amp;quot;, -XX:-SplitIfBlocks or disable compilation of affected method = HLM = P3</comment>
                            <comment id="14564323" author="roboduke" created="Fri, 3 Mar 2023 02:28:10 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/12851&quot;&gt;https://git.openjdk.org/jdk/pull/12851&lt;/a&gt;&lt;br/&gt;
Date: 2023-03-03 10:22:55 +0000</comment>
                            <comment id="14564318" author="roland" created="Fri, 3 Mar 2023 01:54:52 -0800"  >I haven&amp;#39;t tried the test case on older releases but I see 8 has the logic that causes the crash so I expect the bug to be present all the way back to 8.</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5097346">JDK-8305127</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5097365">JDK-8305146</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5097865">JDK-8305560</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5099663">JDK-8307039</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5100106">JDK-8307438</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5100108">JDK-8307440</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="102881" name="TestWrongCMovSplitIf.java" size="1172" author="roland" created="Fri, 3 Mar 2023 01:49:42 -0800"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i30lrv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17407"><![CDATA[b14]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="208"><![CDATA[compiler]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>