<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 11:49:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8319896] Remove monitor deflation from final audit</title>
                <link>https://bugs.openjdk.org/browse/JDK-8319896</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>In &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8318757&quot; title=&quot;VM_ThreadDump asserts in interleaved ObjectMonitor::deflate_monitor calls&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8318757&quot;&gt;&lt;strike&gt;JDK-8318757&lt;/strike&gt;&lt;/a&gt; we can see that running a monitor deflation pass during a safepointed operation can interleave with the async monitor deflation, which causes various problems. The fix is to stop deflating monitors in the thread dump operation and instead only collect relevant monitors.&lt;br/&gt;
&lt;br/&gt;
There is yet another place where we call monitor deflation from outside of the monitor deflation thread. That place is the &amp;quot;final audit&amp;quot; part, which walks over monitors and performs verification and logging. Before the walk over the list of monitors we perform a monitor deflation pass to prune the system from &amp;quot;uninteresting&amp;quot; monitors.&lt;br/&gt;
&lt;br/&gt;
I propose that we remove the monitor deflation from the final audit, and that we instead only visit &amp;quot;interesting&amp;quot; monitors (those that have an owner or &amp;quot;is busy&amp;quot;). After this change it&amp;#39;s only the monitor deflation thread that performs monitor deflation. It is unclear to me if the final audit can actually interleave with the async monitor deflation, but this removal makes it easier to reason around monitor deflation since it is only one thread that is performing it.</description>
                <environment></environment>
        <key id="5114511">JDK-8319896</key>
            <summary>Remove monitor deflation from final audit</summary>
                <type id="7" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14707&amp;avatarType=issuetype">Enhancement</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stefank">Stefan Karlsson</assignee>
                                    <reporter username="stefank">Stefan Karlsson</reporter>
                        <labels>
                            <label>amazon-interest</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>sync</label>
                    </labels>
                <created>Fri, 10 Nov 2023 04:30:41 -0800</created>
                <updated>Mon, 18 Mar 2024 02:02:29 -0700</updated>
                            <resolved>Thu, 16 Nov 2023 23:05:20 -0800</resolved>
                                    <version>17</version>
                    <version>21</version>
                    <version>22</version>
                                    <fixVersion>22</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14656749" author="roboduke" created="Tue, 12 Mar 2024 04:37:30 -0700"  >[jdk21u-fix-request] Approval Request from Aleksey Shipil&amp;#xEB;v&lt;br/&gt;
This resolves the last place that might lead to bugs due to interleaving with concurrent monitor deflation. Less important than &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8318757&quot; title=&quot;VM_ThreadDump asserts in interleaved ObjectMonitor::deflate_monitor calls&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8318757&quot;&gt;&lt;strike&gt;JDK-8318757&lt;/strike&gt;&lt;/a&gt;, since this only happens on JVM shutdown, but it makes relevant backports like &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8320515&quot; title=&quot;assert(monitor-&amp;gt;object_peek() != nullptr) failed: Owned monitors should not have a dead object&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8320515&quot;&gt;&lt;strike&gt;JDK-8320515&lt;/strike&gt;&lt;/a&gt; clean. This is a part of atomic 21u integration, see 21u-dev PR for more details. Applies cleanly. All tests pass. Was in mainline for several months. Small bugtail: needs &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8325437&quot; title=&quot;Safepoint polling in monitor deflation can cause massive logs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8325437&quot;&gt;&lt;strike&gt;JDK-8325437&lt;/strike&gt;&lt;/a&gt; as the followup.</comment>
                            <comment id="14655424" author="roboduke" created="Thu, 7 Mar 2024 02:13:08 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/337&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/337&lt;/a&gt;&lt;br/&gt;
Date: 2024-03-06 19:12:00 +0000</comment>
                            <comment id="14627120" author="dukebot" created="Thu, 16 Nov 2023 23:05:19 -0800"  >Changeset: 369bbecc&lt;br/&gt;
Author:    Stefan Karlsson &amp;lt;&lt;a href=&apos;mailto:stefank@openjdk.org&apos;&gt;stefank@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-11-17 07:04:13 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/369bbecc0dab389b523c09bc332fe1cf6394cb26&quot;&gt;https://git.openjdk.org/jdk/commit/369bbecc0dab389b523c09bc332fe1cf6394cb26&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14625499" author="roboduke" created="Fri, 10 Nov 2023 04:41:07 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/16605&quot;&gt;https://git.openjdk.org/jdk/pull/16605&lt;/a&gt;&lt;br/&gt;
Date: 2023-11-10 12:35:46 +0000</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5124087">JDK-8328080</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5124419">JDK-8328335</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10000">
                    <name>Blocks</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="5113565">JDK-8319137</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="5113126">JDK-8318757</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5115245">JDK-8320561</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5120947">JDK-8325437</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i33txn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17411"><![CDATA[b25]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="192"><![CDATA[runtime]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>