<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 09:10:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8309268] C2: &quot;assert(in_bb(n)) failed: must be&quot; after JDK-8306302</title>
                <link>https://bugs.openjdk.org/browse/JDK-8309268</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>The attached Java Fuzzer test starts to fail after &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8306302&quot; title=&quot;C2 Superword fix: use VectorMaskCmp and VectorBlend instead of CMoveVF/D&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8306302&quot;&gt;&lt;strike&gt;JDK-8306302&lt;/strike&gt;&lt;/a&gt;:&lt;br/&gt;
&lt;br/&gt;
To reproduce:&lt;br/&gt;
$ java -Xcomp -XX:CompileOnly=Test Test.java&lt;br/&gt;
$ java -Xcomp -XX:CompileOnly=Reduced Reduced.java&lt;br/&gt;
$ java -Xcomp -XX:CompileOnly=Test Test2.java&lt;br/&gt;
$ java -Xcomp -XX:CompileOnly=Reduced2 Reduced2.java&lt;br/&gt;
&lt;br/&gt;
#&lt;br/&gt;
# A fatal error has been detected by the Java Runtime Environment:&lt;br/&gt;
#&lt;br/&gt;
#  Internal Error (/opt/mach5/mesos/work_dir/slaves/741e9afd-8c02-45c3-b2e2-9db1450d0832-S179616/frameworks/1735e8a2-a1db-478c-8104-60c8b0af87dd-0196/executors/6b808a31-80b5-48ac-8f1e-28ee5f1e1ca0/runs/ae4fea3e-315f-4e68-a48b-478764fcfcf2/workspace/open/src/hotspot/share/opto/superword.hpp:402), pid=2102908, tid=2102923&lt;br/&gt;
#  assert(in_bb(n)) failed: must be&lt;br/&gt;
#&lt;br/&gt;
# JRE version: Java(TM) SE Runtime Environment (21.0) (fastdebug build 21-internal-LTS-2023-05-30-2140444.coleen.phillimore.21jmethodid-cache)&lt;br/&gt;
# Java VM: Java HotSpot(TM) 64-Bit Server VM (fastdebug 21-internal-LTS-2023-05-30-2140444.coleen.phillimore.21jmethodid-cache, compiled mode, sharing, tiered, compressed oops, compressed class ptrs, g1 gc, linux-amd64)&lt;br/&gt;
# Problematic frame:&lt;br/&gt;
# V  [libjvm.so+0x171c17e]  SuperWord::bb_idx(Node const*) const+0x4e&lt;br/&gt;
...........&lt;br/&gt;
Command Line: -Xmx1G -Xcomp -Xbatch -XX:CompileOnly=Test -XX:CompileCommand=quiet -XX:MaxRAMPercentage=4.16667 -Dtest.boot.jdk=/opt/mach5/mesos/work_dir/jib-master/install/jdk/20/36/bundles/linux-x64/jdk-20_linux-x64_bin.tar.gz/jdk-20 -Djava.io.tmpdir=/opt/mach5/mesos/work_dir/slaves/741e9afd-8c02-45c3-b2e2-9db1450d0832-S179893/frameworks/1735e8a2-a1db-478c-8104-60c8b0af87dd-0196/executors/2ed49270-04df-4db4-8bc3-81f8d37a701b/runs/fe3fe1ea-a469-43e4-aa21-69d5274f57f1/testoutput/test-support/jtreg_closed_test_hotspot_jtreg_applications_javafuzzer_MediumTest_java/tmp Test&lt;br/&gt;
............&lt;br/&gt;
Current CompileTask:&lt;br/&gt;
C2:   1047   71   !b  4       Test::vMeth (466 bytes)&lt;br/&gt;
&lt;br/&gt;
Stack: [0x00007fcf8c0fa000,0x00007fcf8c1fb000],  sp=0x00007fcf8c1f4eb0,  free space=1003k&lt;br/&gt;
Native frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native code)&lt;br/&gt;
V  [libjvm.so+0x171c17e]  SuperWord::bb_idx(Node const*) const+0x4e  (superword.hpp:402)&lt;br/&gt;
V  [libjvm.so+0x171c2a1]  SuperWord::velt_type(Node*)+0x11  (superword.hpp:430)&lt;br/&gt;
V  [libjvm.so+0x17122e1]  SuperWord::compute_vector_element_type()+0x451  (superword.cpp:3711)&lt;br/&gt;
V  [libjvm.so+0x171b458]  SuperWord::SLP_extract()+0x368  (superword.cpp:606)&lt;br/&gt;
V  [libjvm.so+0x171b7a9]  SuperWord::transform_loop(IdealLoopTree*, bool)+0x219  (superword.cpp:178)&lt;br/&gt;
V  [libjvm.so+0x1297696]  PhaseIdealLoop::build_and_optimize()+0x1096  (loopnode.cpp:4655)&lt;br/&gt;
V  [libjvm.so+0x9f3296]  PhaseIdealLoop::optimize(PhaseIterGVN&amp;amp;, LoopOptsMode)+0x306  (loopnode.hpp:1121)&lt;br/&gt;
V  [libjvm.so+0x9ef78a]  Compile::Optimize()+0x104a  (compile.cpp:2156)&lt;br/&gt;
V  [libjvm.so+0x9f1f15]  Compile::Compile(ciEnv*, ciMethod*, int, Options, DirectiveSet*)+0x1aa5  (compile.cpp:839)&lt;br/&gt;
V  [libjvm.so+0x84bbb4]  C2Compiler::compile_method(ciEnv*, ciMethod*, int, bool, DirectiveSet*)+0x3c4  (c2compiler.cpp:118)&lt;br/&gt;
V  [libjvm.so+0x9fdeb0]  CompileBroker::invoke_compiler_on_method(CompileTask*)+0xa00  (compileBroker.cpp:2265)&lt;br/&gt;
V  [libjvm.so+0x9fed38]  CompileBroker::compiler_thread_loop()+0x618  (compileBroker.cpp:1944)&lt;br/&gt;
V  [libjvm.so+0xeb6b9c]  JavaThread::thread_main_inner()+0xcc  (javaThread.cpp:719)&lt;br/&gt;
V  [libjvm.so+0x1796d6a]  Thread::call_run()+0xba  (thread.cpp:217)&lt;br/&gt;
V  [libjvm.so+0x1496e1c]  thread_native_entry(Thread*)+0x11c  (os_linux.cpp:775)</description>
                <environment></environment>
        <key id="5102289">JDK-8309268</key>
            <summary>C2: &quot;assert(in_bb(n)) failed: must be&quot; after JDK-8306302</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://bugs.openjdk.org/images/jbsImages/p2.png">P2</priority>
                        <status id="6" iconUrl="https://bugs.openjdk.org/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="epeter">Emanuel Peter</assignee>
                                    <reporter username="chagedorn">Christian Hagedorn</reporter>
                        <labels>
                            <label>c2</label>
                            <label>c2-superword</label>
                            <label>javafuzzer</label>
                            <label>oracle-triage-11</label>
                            <label>oracle-triage-17</label>
                            <label>oracle-triage-21</label>
                            <label>regression</label>
                            <label>tier8</label>
                    </labels>
                <created>Thu, 1 Jun 2023 02:12:36 -0700</created>
                <updated>Wed, 12 Jul 2023 07:44:48 -0700</updated>
                            <resolved>Sun, 4 Jun 2023 23:44:41 -0700</resolved>
                                    <version>21</version>
                                    <fixVersion>21</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14587129" author="dcubed" created="Mon, 5 Jun 2023 10:00:09 -0700"  >The fix for this bug is integrated in jdk-21+26-2255.</comment>
                            <comment id="14586945" author="dukebot" created="Sun, 4 Jun 2023 23:44:39 -0700"  >Changeset: 22a9a86b&lt;br/&gt;
Author:    Emanuel Peter &amp;lt;&lt;a href=&apos;mailto:epeter@openjdk.org&apos;&gt;epeter@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-06-05 06:43:13 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/22a9a86be088a3e92b231e7180a134f63716cc87&quot;&gt;https://git.openjdk.org/jdk/commit/22a9a86be088a3e92b231e7180a134f63716cc87&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14586530" author="roboduke" created="Fri, 2 Jun 2023 00:01:20 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/14268&quot;&gt;https://git.openjdk.org/jdk/pull/14268&lt;/a&gt;&lt;br/&gt;
Date: 2023-06-01 16:19:41 +0000</comment>
                            <comment id="14586261" author="JIRAUSER19821" created="Thu, 1 Jun 2023 02:49:16 -0700"  >Reduced.java -&amp;gt; Simple1.java&lt;br/&gt;
&lt;br/&gt;
./java -Xcomp -XX:CompileCommand=compileonly,Simple1::test -XX:+TraceLoopOpts -XX:+TraceSuperWord -XX:-TieredCompilation Simple1.java&lt;br/&gt;
&lt;br/&gt;
This is definately a regression to &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8306302&quot; title=&quot;C2 Superword fix: use VectorMaskCmp and VectorBlend instead of CMoveVF/D&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8306302&quot;&gt;&lt;strike&gt;JDK-8306302&lt;/strike&gt;&lt;/a&gt;.&lt;br/&gt;
The issue is that I expect the left input to the comparison to come from within the loop. But in Simple1.java we can see that the float-constant is from outside the loop.&lt;br/&gt;
The assert is triggered when I ask for the velt_type of the inputs to the comparison.&lt;br/&gt;
&lt;br/&gt;
Solution: one of the two inputs must come from inside the loop, otherwise the compare would float outside the loop, and also the bool would float outside the loop. So I just need to check which one is in the loop, and take that one&amp;#39;s velt_type.</comment>
                            <comment id="14586235" author="chagedorn" created="Thu, 1 Jun 2023 02:18:37 -0700"  >[~epeter] can you have a look?</comment>
                            <comment id="14586234" author="chagedorn" created="Thu, 1 Jun 2023 02:17:50 -0700"  >ILW = Assertion failure in Superword, two fuzzer test failures and recent regression, -XX:-UseSuperWord or disable  compilation of affected method = HMM = P2</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5098743">JDK-8306302</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="104158" name="FuzzerUtils.java" size="13240" author="chagedorn" created="Thu, 1 Jun 2023 02:11:21 -0700"/>
                            <attachment id="104159" name="Reduced.java" size="454" author="chagedorn" created="Thu, 1 Jun 2023 02:10:43 -0700"/>
                            <attachment id="104165" name="Reduced2.java" size="380" author="epeter" created="Thu, 1 Jun 2023 03:39:27 -0700"/>
                            <attachment id="104163" name="Simple1.java" size="340" author="epeter" created="Thu, 1 Jun 2023 02:49:14 -0700"/>
                            <attachment id="104160" name="Test.java" size="9428" author="chagedorn" created="Thu, 1 Jun 2023 02:10:41 -0700"/>
                            <attachment id="104161" name="Test2.java" size="5733" author="chagedorn" created="Thu, 1 Jun 2023 02:13:41 -0700"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10003" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Introduced In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17695"><![CDATA[b25]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10004" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Introduced In Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="22711">21</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i31r2r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17357"><![CDATA[b26]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="208"><![CDATA[compiler]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10100" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Verification</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17000"><![CDATA[Verified]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>