<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 15:14:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8299336] InputStream::DEFAULT_BUFFER_SIZE should be 16384</title>
                <link>https://bugs.openjdk.org/browse/JDK-8299336</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>I/O had always been much slower than CPU and memory access, and thanks to physical constraints, always will be.&lt;br/&gt;
While CPUs can get shrinked more and more, and can hold more and more memory cache on or nearby a CPU core, the distance between CPU core and I/O device cannot get reduced much: It will stay &amp;quot;far&amp;quot; away.&lt;br/&gt;
Due to this simple logic (and other factors), the spread between performance of CPU and memory access on one hand, and performance of I/O on the other hand, increases with every new CPU generation.&lt;br/&gt;
As a consequence, internal adjustment factors of the JDK need to get revised from time to time to ensure optimum performance and each hardware generation.&lt;br/&gt;
&lt;br/&gt;
One such factor is the size of the temporary transfer buffer used internally by `InputStream::transferTo`.&lt;br/&gt;
Since its introduction with JDK 9 many years (hence hardware generations) have passed, so it&amp;#39;s time to check the appropriateness of that buffer&amp;#39;s size.&lt;br/&gt;
&lt;br/&gt;
Using JMH on a typical, modern cloud platform, it was proven that the current 8K buffer is (much) too small on modern hardware:&lt;br/&gt;
The small buffer clearly stands in the way of faster transfers.&lt;br/&gt;
The ops/s of a simple `FileInputStream.transferTo(ByteArrayOutputStream)` operation on JDK 21 could be doubled (!) by only doubling the buffer size from 8K to 16K, which seems to be a considerable and cheap deal.&lt;br/&gt;
Doubling the buffer even more shows only marginal improvements of approx. 1% to 3% per duplication of size, which does not justify additional memory consumption.&lt;br/&gt;
&lt;br/&gt;
```&lt;br/&gt;
TransferToPerformance.transferTo          8192       1048576  thrpt   25  1349.929 &amp;#xB1; 47.057  ops/s&lt;br/&gt;
TransferToPerformance.transferTo         16384       1048576  thrpt   25  2633.560 &amp;#xB1; 93.337  ops/s&lt;br/&gt;
TransferToPerformance.transferTo         32768       1048576  thrpt   25  2721.025 &amp;#xB1; 89.555  ops/s&lt;br/&gt;
TransferToPerformance.transferTo         65536       1048576  thrpt   25  2855.949 &amp;#xB1; 96.623  ops/s&lt;br/&gt;
TransferToPerformance.transferTo        131072       1048576  thrpt   25  2903.062 &amp;#xB1; 40.798  ops/s&lt;br/&gt;
```&lt;br/&gt;
&lt;br/&gt;
Even on small or limited platforms, an investment of 8K additonal temporary buffer is very cheap and very useful, as it doubles the performance of `InputStream::transferTo`, in particular for legacy (non-NIO) applications still using `FileInputStream` and `ByteArrayOutputStream`.&lt;br/&gt;
I dare to say, even if not proven, that is a very considerable (possibly the major) number of existing applications, as NIO was only adopted gradually by programmers.&lt;br/&gt;
&lt;br/&gt;
Due to the given reasons, it should be approporiate to change `DEFAULT_BUFFER_SIZE` from 8192 to 16384.&lt;br/&gt;
</description>
                <environment></environment>
        <key id="5090389">JDK-8299336</key>
            <summary>InputStream::DEFAULT_BUFFER_SIZE should be 16384</summary>
                <type id="5" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14716&amp;avatarType=issuetype">Sub-task</type>
                            <parent id="5047856">JDK-8265891</parent>
                                    <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mkarg">Markus Karg</assignee>
                                    <reporter username="mkarg">Markus Karg</reporter>
                        <labels>
                    </labels>
                <created>Fri, 23 Dec 2022 14:19:51 -0800</created>
                <updated>Sun, 2 Apr 2023 09:00:04 -0700</updated>
                            <resolved>Fri, 6 Jan 2023 09:37:50 -0800</resolved>
                                                    <fixVersion>21</fixVersion>
                                    <component>core-libs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14549301" author="dukebot" created="Fri, 6 Jan 2023 09:37:40 -0800"  >Changeset: 3dcf7001&lt;br/&gt;
Author:    Markus KARG &amp;lt;&lt;a href=&apos;mailto:markus@headcrashing.eu&apos;&gt;markus@headcrashing.eu&lt;/a&gt;&amp;gt;&lt;br/&gt;
Committer: Brian Burkhalter &amp;lt;&lt;a href=&apos;mailto:bpb@openjdk.org&apos;&gt;bpb@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-01-06 17:35:17 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/3dcf7001611aa66a7a1b4a01dfa6dfb296e70da1&quot;&gt;https://git.openjdk.org/jdk/commit/3dcf7001611aa66a7a1b4a01dfa6dfb296e70da1&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14547740" author="roboduke" created="Sat, 24 Dec 2022 01:10:25 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/11783&quot;&gt;https://git.openjdk.org/jdk/pull/11783&lt;/a&gt;&lt;br/&gt;
Date: 2022-12-23 22:28:34 +0000</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2zqiz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17315"><![CDATA[b05]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="244"><![CDATA[java.io]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>