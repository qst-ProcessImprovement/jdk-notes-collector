<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 09:25:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8310126] C1: Missing receiver null check in Reference::get intrinsic</title>
                <link>https://bugs.openjdk.org/browse/JDK-8310126</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>Originally reported against Graal &lt;a href=&quot;https://github.com/oracle/graal/issues/6350&quot;&gt;https://github.com/oracle/graal/issues/6350&lt;/a&gt; .&lt;br/&gt;
&lt;br/&gt;
The following code segfaults in C1 compiled tier 1 code with graal (only the tier 1 version crashes, the tier 3 compile of it does not).&lt;br/&gt;
&lt;br/&gt;
#############################&lt;br/&gt;
import java.lang.ref.WeakReference;&lt;br/&gt;
import java.math.MathContext;&lt;br/&gt;
&lt;br/&gt;
class T {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;int f() {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;int q = 43837, p;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;MathContext u = null;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;for (int w = 648; w &amp;lt; 9230; w += 1)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;try {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;p = u.getPrecision();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;} catch (Throwable x) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;} finally {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;WeakReference r = null;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;try {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;while (r.get() != null) {}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;} catch (Throwable x) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;} finally {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return (int) (long) q;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;public static void main(String[] g) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;T t = new T();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;for (; ; ) t.f();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
}&lt;br/&gt;
#############################&lt;br/&gt;
&lt;br/&gt;
Reproduce with /jdk-21/bin/java -XX:TieredStopAtLevel=1 T1 &lt;br/&gt;
&lt;br/&gt;
Does not crash with regular tiered compilation because c2 compile of this is fine. Crashes with Graal because graal does not OSR compile this loop because the call target method of u.getPrecision(); is not resolved (in fact its always null and throws). MDO has exception seen but no profile so graal rejects OSR. This leads to C1 tier 1 compile of it which fails. Simulate with stop at tier 1 to fault immediately. Theoretically if a similar example would trigger C2 rejecting compile of such an example this could lead to a tier 1 compile of it without graal and expose the problem as well. </description>
                <environment>&lt;p&gt;(Reproduced with OpenJDK 64-Bit Server VM (build 21-ea+26-2328, mixed mode, sharing))&lt;/p&gt;</environment>
        <key id="5103288">JDK-8310126</key>
            <summary>C1: Missing receiver null check in Reference::get intrinsic</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://bugs.openjdk.org/images/jbsImages/p3.png">P3</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="thartmann">Tobias Hartmann</assignee>
                                    <reporter username="davleopo">David Leopoldseder</reporter>
                        <labels>
                            <label>amazon-interest</label>
                            <label>c1</label>
                            <label>hgupdate-sync</label>
                            <label>intrinsic</label>
                            <label>jdk17u-fix-request</label>
                            <label>jdk17u-fix-yes</label>
                            <label>oracle-triage-22</label>
                    </labels>
                <created>Thu, 15 Jun 2023 03:08:28 -0700</created>
                <updated>Mon, 24 Jul 2023 21:47:18 -0700</updated>
                            <resolved>Sun, 18 Jun 2023 22:11:08 -0700</resolved>
                                    <version>11</version>
                    <version>17</version>
                    <version>20</version>
                    <version>21</version>
                    <version>22</version>
                                    <fixVersion>22</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="14591601" author="shade" created="Fri, 23 Jun 2023 01:58:29 -0700"  >Fix Request (17u)&lt;br/&gt;
&lt;br/&gt;
Fixes a corner case bug/regression in C1. Applies cleanly. New test fails before the patch and passes with it. The patch itself is simple, and IMO comes with minor/acceptable risk for 17u.</comment>
                            <comment id="14590923" author="roboduke" created="Wed, 21 Jun 2023 03:35:22 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21/pull/51&quot;&gt;https://git.openjdk.org/jdk21/pull/51&lt;/a&gt;&lt;br/&gt;
Date: 2023-06-21 10:28:51 +0000</comment>
                            <comment id="14590525" author="roboduke" created="Tue, 20 Jun 2023 02:41:56 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u-dev/pull/1474&quot;&gt;https://git.openjdk.org/jdk17u-dev/pull/1474&lt;/a&gt;&lt;br/&gt;
Date: 2023-06-20 09:37:09 +0000</comment>
                            <comment id="14590125" author="dukebot" created="Sun, 18 Jun 2023 22:11:07 -0700"  >Changeset: 02aaab12&lt;br/&gt;
Author:    Tobias Hartmann &amp;lt;&lt;a href=&apos;mailto:thartmann@openjdk.org&apos;&gt;thartmann@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-06-19 05:08:45 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/02aaab12e331e5a4c249f1d281c4439e2e7c914f&quot;&gt;https://git.openjdk.org/jdk/commit/02aaab12e331e5a4c249f1d281c4439e2e7c914f&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14589860" author="roboduke" created="Fri, 16 Jun 2023 02:37:08 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/14511&quot;&gt;https://git.openjdk.org/jdk/pull/14511&lt;/a&gt;&lt;br/&gt;
Date: 2023-06-16 09:28:38 +0000</comment>
                            <comment id="14589624" author="thartmann" created="Thu, 15 Jun 2023 06:30:07 -0700"  >The problem is in LIRGenerator::do_Reference_get. After &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8201543&quot; title=&quot;Modularize C1 GC barriers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8201543&quot;&gt;&lt;strike&gt;JDK-8201543&lt;/strike&gt;&lt;/a&gt;, no CodeEmitInfo is passed to access_load_at and therefore no implicit null check is emitted.</comment>
                            <comment id="14589621" author="thartmann" created="Thu, 15 Jun 2023 06:27:21 -0700"  >ILW = Missing null check in C1 compiled code, with Reference::get intrinsic and null argument, -XX:DisableIntrinsic=_Reference_get = HLM = P3</comment>
                            <comment id="14589618" author="thartmann" created="Thu, 15 Jun 2023 06:22:47 -0700"  >This is a regression from &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8201543&quot; title=&quot;Modularize C1 GC barriers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8201543&quot;&gt;&lt;strike&gt;JDK-8201543&lt;/strike&gt;&lt;/a&gt; in JDK 11 b12.</comment>
                            <comment id="14589609" author="thartmann" created="Thu, 15 Jun 2023 05:37:52 -0700"  >I attached a simplified Test.java. The root cause is a missing argument null check in the &amp;#39;_Reference_get&amp;#39; C1 intrinsic.&lt;br/&gt;
&lt;br/&gt;
Run with java -XX:TieredStopAtLevel=1 -XX:CompileCommand=compileonly,Test::test -XX:CompileCommand=quiet -Xbatch Test.java&lt;br/&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5103836">JDK-8310602</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5104315">JDK-8311037</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5104656">JDK-8311329</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5105140">JDK-8311793</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="4957904">JDK-8201543</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="104305" name="T1.java" size="518" author="davleopo" created="Thu, 15 Jun 2023 01:40:57 -0700"/>
                            <attachment id="104319" name="Test.java" size="713" author="thartmann" created="Thu, 15 Jun 2023 05:37:05 -0700"/>
                            <attachment id="104306" name="hs_err_pid86805.log" size="71814" author="davleopo" created="Thu, 15 Jun 2023 01:40:45 -0700"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10003" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Introduced In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17458"><![CDATA[b12]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10004" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Introduced In Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="18723">11</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i31x7v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17305"><![CDATA[b03]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="208"><![CDATA[compiler]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>