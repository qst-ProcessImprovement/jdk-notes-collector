<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 10:40:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8319828] runtime/NMT/VirtualAllocCommitMerge.java may fail if mixing interpreted and compiled native invocations</title>
                <link>https://bugs.openjdk.org/browse/JDK-8319828</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>We saw this problem on s390x, but it was easy to reproduce on x64.&lt;br/&gt;
&lt;br/&gt;
The test creates adjacent commit sections via NMTCommitMemory(), and then expects them to show up as merged sections in the NMT report.&lt;br/&gt;
&lt;br/&gt;
That sometimes fails, as here:&lt;br/&gt;
&lt;br/&gt;
```&lt;br/&gt;
Execution failed: `main&amp;#39; threw exception: java.lang.RuntimeException: &amp;#39;[0x[0]3ff859fc000 - 0x[0]*3ff85a5c000] committed 384KB from.&amp;#39; missing from stdout/stderr&lt;br/&gt;
```&lt;br/&gt;
and the relevant snippet in the NMT report was:&lt;br/&gt;
&lt;br/&gt;
```&lt;br/&gt;
[0x000003ff859fc000 - 0x000003ff85dfc000] reserved 4096KB for Test from&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[0x000003ffb4ad2a58] WB_NMTReserveMemory+0xc0&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[0x000003ff9bf43344]&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[0x000003ff859fc000 - 0x000003ff85a1c000] committed 128KB from&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[0x000003ffb4ad288c] WB_NMTCommitMemory+0xc4&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[0x000003ff85a1c000 - 0x000003ff85a5c000] committed 256KB from&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[0x000003ffb4ad288c] WB_NMTCommitMemory+0xc4&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[0x000003ff9bf43344]&lt;br/&gt;
```&lt;br/&gt;
&lt;br/&gt;
Note that it shows two adjacent commit sections, one 128k, one 256k, that the test expected to show up as one merged section of 384k.&lt;br/&gt;
&lt;br/&gt;
The reason for this is that the first invocation of NMTCommitMemory happened interpreted, the second one compiled. That alters the stack: in the first case we have an Interpreter Codelet on the stack, in the second case the compiled nmethod. See here an annotated stack:&lt;br/&gt;
&lt;br/&gt;
```&lt;br/&gt;
[0x00007fceb0147000 - 0x00007fceb0547000] reserved 4096KB for Test from&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[0x00007fcef3beccd5] WB_NMTReserveMemory+0xa5&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[0x00007fcedb92bbce]0x00007fcedb92bbce is at code_begin+1806 in an Interpreter codelet&lt;br/&gt;
&lt;br/&gt;
	[0x00007fceb0147000 - 0x00007fceb0167000] committed 128KB from&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[0x00007fcef3bed098] WB_NMTCommitMemory+0xa8&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[0x00007fcedc0901a1]0x00007fcedc0901a1 is at entry_point+225 in (nmethod*)0x00007fcedc08ff10&lt;br/&gt;
&lt;br/&gt;
	[0x00007fceb0167000 - 0x00007fceb01a7000] committed 256KB from&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[0x00007fcef3bed098] WB_NMTCommitMemory+0xa8&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[0x00007fcedb92bbce]0x00007fcedb92bbce is at code_begin+1806 in an Interpreter codelet&lt;br/&gt;
&lt;br/&gt;
```&lt;br/&gt;
&lt;br/&gt;
Since the stacks differ, NMT does not merge the sections. And that is fine; it shouldn&amp;#39;t do that. The test should cope somehow.&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
        <key id="5114436">JDK-8319828</key>
            <summary>runtime/NMT/VirtualAllocCommitMerge.java may fail if mixing interpreted and compiled native invocations</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://bugs.openjdk.org/images/jbsImages/p3.png">P3</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stuefe">Thomas Stuefe</assignee>
                                    <reporter username="stuefe">Thomas Stuefe</reporter>
                        <labels>
                            <label>amazon-interest</label>
                            <label>jdk21u-fix-SQE-ok</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>nmt</label>
                    </labels>
                <created>Thu, 9 Nov 2023 07:36:37 -0800</created>
                <updated>Tue, 9 Jan 2024 10:25:18 -0800</updated>
                            <resolved>Fri, 10 Nov 2023 02:46:17 -0800</resolved>
                                    <version>11</version>
                    <version>17</version>
                    <version>21</version>
                    <version>22</version>
                                    <fixVersion>22</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14625539" author="stuefe" created="Fri, 10 Nov 2023 06:55:53 -0800"  >Fix request JDK 21u:&lt;br/&gt;
&lt;br/&gt;
Fixes intermittent errors in NMT tests by disabling compilation in that test (-Xint). No risk, test-change only.</comment>
                            <comment id="14625518" author="roboduke" created="Fri, 10 Nov 2023 06:02:54 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u/pull/349&quot;&gt;https://git.openjdk.org/jdk21u/pull/349&lt;/a&gt;&lt;br/&gt;
Date: 2023-11-10 11:37:52 +0000</comment>
                            <comment id="14625475" author="dukebot" created="Fri, 10 Nov 2023 02:46:16 -0800"  >Changeset: 6b21ff61&lt;br/&gt;
Author:    Thomas Stuefe &amp;lt;&lt;a href=&apos;mailto:stuefe@openjdk.org&apos;&gt;stuefe@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-11-10 10:44:11 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/6b21ff61dad6f633c744c1c33c29ea86183b509d&quot;&gt;https://git.openjdk.org/jdk/commit/6b21ff61dad6f633c744c1c33c29ea86183b509d&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14625275" author="roboduke" created="Thu, 9 Nov 2023 08:12:48 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/16583&quot;&gt;https://git.openjdk.org/jdk/pull/16583&lt;/a&gt;&lt;br/&gt;
Date: 2023-11-09 16:05:14 +0000</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5114696">JDK-8320063</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5118506">JDK-8323374</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="4951295">JDK-8196405</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i33tgz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17436"><![CDATA[b24]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="192"><![CDATA[runtime]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>