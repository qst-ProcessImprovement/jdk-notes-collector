<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 13:08:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8333270] HandlersOnComplexResetUpdate and HandlersOnComplexUpdate tests fail with &quot;Unexpected reference&quot; if timeoutFactor is less than 1/3</title>
                <link>https://bugs.openjdk.org/browse/JDK-8333270</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>When running tests under test/jdk/java/util locally on a macos M1 against latest JDK mainline, the following 2 tests failed:&lt;br/&gt;
&lt;br/&gt;
java/util/logging/LogManager/Configuration/updateConfiguration/HandlersOnComplexResetUpdate.java&lt;br/&gt;
java/util/logging/LogManager/Configuration/updateConfiguration/HandlersOnComplexUpdate.java&lt;br/&gt;
&lt;br/&gt;
Both of them failed with similar failures:&lt;br/&gt;
&lt;br/&gt;
test result: Failed. Execution failed: `main&amp;#39; threw exception: java.lang.RuntimeException: Unexpected reference: &lt;a href=&apos;mailto:java.lang.ref.WeakReference@13697cee&apos;&gt;java.lang.ref.WeakReference@13697cee&lt;/a&gt; expected: &lt;a href=&apos;mailto:java.lang.ref.WeakReference@4a26adb7&apos;&gt;java.lang.ref.WeakReference@4a26adb7&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
The complete stacktrace for each of these tests follows as separate comments.&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
        <key id="5130688">JDK-8333270</key>
            <summary>HandlersOnComplexResetUpdate and HandlersOnComplexUpdate tests fail with &quot;Unexpected reference&quot; if timeoutFactor is less than 1/3</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="6" iconUrl="https://bugs.openjdk.org/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dfuchs">Daniel Fuchs</assignee>
                                    <reporter username="jpai">Jaikiran Pai</reporter>
                        <labels>
                            <label>jdk17u-fix-request</label>
                            <label>jdk17u-fix-yes</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>noreg-self</label>
                            <label>ursqe-triaged</label>
                    </labels>
                <created>Thu, 30 May 2024 06:11:10 -0700</created>
                <updated>Tue, 6 Aug 2024 08:59:45 -0700</updated>
                            <resolved>Thu, 6 Jun 2024 08:23:39 -0700</resolved>
                                                    <fixVersion>23</fixVersion>
                                    <component>core-libs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14695298" author="JIRAUSER20917" created="Thu, 1 Aug 2024 19:09:31 -0700"  >Fix request [17u]&lt;br/&gt;
&lt;br/&gt;
I backport this for parity with 17.0.13-oracle.&lt;br/&gt;
No risk, only tests change.&lt;br/&gt;
Clean backport.&lt;br/&gt;
Test pass. SAP nightly testing passed.</comment>
                            <comment id="14695005" author="roboduke" created="Wed, 31 Jul 2024 19:36:36 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u-dev/pull/2758&quot;&gt;https://git.openjdk.org/jdk17u-dev/pull/2758&lt;/a&gt;&lt;br/&gt;
Date: 2024-08-01 02:28:44 +0000</comment>
                            <comment id="14686703" author="JIRAUSER20917" created="Tue, 2 Jul 2024 23:58:31 -0700"  >Fix request [21u]&lt;br/&gt;
&lt;br/&gt;
I backport this for parity with 21.0.5-oracle.&lt;br/&gt;
No risk, only a test change.&lt;br/&gt;
Clean backport.&lt;br/&gt;
Test pass.  SAP nightly testing passed.</comment>
                            <comment id="14686418" author="roboduke" created="Tue, 2 Jul 2024 02:59:52 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/811&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/811&lt;/a&gt;&lt;br/&gt;
Date: 2024-07-02 09:55:23 +0000</comment>
                            <comment id="14679532" author="dukebot" created="Thu, 6 Jun 2024 08:23:38 -0700"  >Changeset: d02cb742&lt;br/&gt;
Author:    Daniel Fuchs &amp;lt;&lt;a href=&apos;mailto:dfuchs@openjdk.org&apos;&gt;dfuchs@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2024-06-06 15:19:50 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/d02cb742f79e88c6438ca58a6357fe432fb286cb&quot;&gt;https://git.openjdk.org/jdk/commit/d02cb742f79e88c6438ca58a6357fe432fb286cb&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14677846" author="roboduke" created="Fri, 31 May 2024 08:02:01 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/19503&quot;&gt;https://git.openjdk.org/jdk/pull/19503&lt;/a&gt;&lt;br/&gt;
Date: 2024-05-31 14:55:57 +0000</comment>
                            <comment id="14677515" author="dfuchs" created="Thu, 30 May 2024 07:04:31 -0700"  >The test expected the `barRef` reference to get cleared, but  it wasn&amp;#39;t cleared in the imparted time. An exception was thrown at this point and reached the finally close, where the reference queue was polled again, in the expectation that the second reference `fooRef` would be found in the queue. But actually, `barRef` was found instead, triggering a second exception.&lt;br/&gt;
&lt;br/&gt;
Though the logic in the test seems right, I suspect we could improve the code that waits for `barRef` to be cleared by using `remove(long timeout)` instead of `poll()`, and by triggering `System.gc()` more often.&lt;br/&gt;
&lt;br/&gt;
In addition the method adjustCount should be fixed to return a number at least &amp;gt; 1.&lt;br/&gt;
&lt;br/&gt;
```&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;static int adjustCount(int count) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return (int) Math.ceil(TIMEOUT_FACTOR * count);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
```&lt;br/&gt;
The test was run with a timeout factor of 0.25, resulting in `count` being 0.&lt;br/&gt;
</comment>
                            <comment id="14677501" author="jpai" created="Thu, 30 May 2024 06:13:51 -0700"  >The java/util/logging/LogManager/Configuration/updateConfiguration/HandlersOnComplexResetUpdate.java failure:&lt;br/&gt;
&lt;br/&gt;
#section:main&lt;br/&gt;
----------messages:(7/340)----------&lt;br/&gt;
command: main HandlersOnComplexResetUpdate UNSECURE&lt;br/&gt;
reason: User specified action: run main/othervm HandlersOnComplexResetUpdate UNSECURE &lt;br/&gt;
started: Thu May 30 17:59:42 IST 2024&lt;br/&gt;
Mode: othervm [/othervm specified]&lt;br/&gt;
Additional options from @modules: --add-modules java.logging&lt;br/&gt;
finished: Thu May 30 17:59:44 IST 2024&lt;br/&gt;
elapsed time (seconds): 2.5&lt;br/&gt;
----------configuration:(3/40)----------&lt;br/&gt;
Boot Layer&lt;br/&gt;
&amp;nbsp;&amp;nbsp;add modules: java.logging&lt;br/&gt;
&lt;br/&gt;
----------System.out:(5/204)----------&lt;br/&gt;
Running test case: UNSECURE&lt;br/&gt;
&lt;br/&gt;
Testing: UNSECURE&lt;br/&gt;
Setting fooChild to: null&lt;br/&gt;
deleting jdk/JTwork/scratch/8/FileHandler-3bf47a67-e25f-4890-8df9-27931a8805c0.log&lt;br/&gt;
----------System.err:(18/1227)----------&lt;br/&gt;
java.lang.RuntimeException: Unexpected reference: &lt;a href=&apos;mailto:java.lang.ref.WeakReference@34654718&apos;&gt;java.lang.ref.WeakReference@34654718&lt;/a&gt;&lt;br/&gt;
	expected: &lt;a href=&apos;mailto:java.lang.ref.WeakReference@5fb93c45&apos;&gt;java.lang.ref.WeakReference@5fb93c45&lt;/a&gt;&lt;br/&gt;
	at HandlersOnComplexResetUpdate.test(HandlersOnComplexResetUpdate.java:347)&lt;br/&gt;
	at HandlersOnComplexResetUpdate$TestCase.run(HandlersOnComplexResetUpdate.java:79)&lt;br/&gt;
	at HandlersOnComplexResetUpdate.main(HandlersOnComplexResetUpdate.java:379)&lt;br/&gt;
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)&lt;br/&gt;
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)&lt;br/&gt;
	at com.sun.javatest.regtest.agent.MainWrapper$MainTask.run(MainWrapper.java:138)&lt;br/&gt;
	at java.base/java.lang.Thread.run(Thread.java:1575)&lt;br/&gt;
	Suppressed: java.lang.RuntimeException: Expected &amp;#39;barRef&amp;#39; to be cleared&lt;br/&gt;
		at HandlersOnComplexResetUpdate.test(HandlersOnComplexResetUpdate.java:242)&lt;br/&gt;
		... 6 more&lt;br/&gt;
&lt;br/&gt;
JavaTest Message: Test threw exception: java.lang.RuntimeException: Unexpected reference: &lt;a href=&apos;mailto:java.lang.ref.WeakReference@34654718&apos;&gt;java.lang.ref.WeakReference@34654718&lt;/a&gt;&lt;br/&gt;
	expected: &lt;a href=&apos;mailto:java.lang.ref.WeakReference@5fb93c45&apos;&gt;java.lang.ref.WeakReference@5fb93c45&lt;/a&gt;</comment>
                            <comment id="14677498" author="jpai" created="Thu, 30 May 2024 06:12:09 -0700"  >The  java/util/logging/LogManager/Configuration/updateConfiguration/HandlersOnComplexUpdate.java failure:&lt;br/&gt;
&lt;br/&gt;
#section:main&lt;br/&gt;
----------messages:(7/332)----------&lt;br/&gt;
command: main HandlersOnComplexUpdate UNSECURE&lt;br/&gt;
reason: User specified action: run main/othervm HandlersOnComplexUpdate UNSECURE &lt;br/&gt;
started: Thu May 30 17:59:44 IST 2024&lt;br/&gt;
Mode: othervm [/othervm specified]&lt;br/&gt;
Additional options from @modules: --add-modules java.logging&lt;br/&gt;
finished: Thu May 30 17:59:46 IST 2024&lt;br/&gt;
elapsed time (seconds): 2.245&lt;br/&gt;
----------configuration:(3/40)----------&lt;br/&gt;
Boot Layer&lt;br/&gt;
&amp;nbsp;&amp;nbsp;add modules: java.logging&lt;br/&gt;
&lt;br/&gt;
----------System.out:(5/204)----------&lt;br/&gt;
Running test case: UNSECURE&lt;br/&gt;
&lt;br/&gt;
Testing: UNSECURE&lt;br/&gt;
Setting fooChild to: null&lt;br/&gt;
deleting jdk/JTwork/scratch/0/FileHandler-1026deea-8e8b-48d8-a192-f281bd0f7934.log&lt;br/&gt;
----------System.err:(18/1187)----------&lt;br/&gt;
java.lang.RuntimeException: Unexpected reference: &lt;a href=&apos;mailto:java.lang.ref.WeakReference@13697cee&apos;&gt;java.lang.ref.WeakReference@13697cee&lt;/a&gt;&lt;br/&gt;
	expected: &lt;a href=&apos;mailto:java.lang.ref.WeakReference@4a26adb7&apos;&gt;java.lang.ref.WeakReference@4a26adb7&lt;/a&gt;&lt;br/&gt;
	at HandlersOnComplexUpdate.test(HandlersOnComplexUpdate.java:335)&lt;br/&gt;
	at HandlersOnComplexUpdate$TestCase.run(HandlersOnComplexUpdate.java:79)&lt;br/&gt;
	at HandlersOnComplexUpdate.main(HandlersOnComplexUpdate.java:367)&lt;br/&gt;
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)&lt;br/&gt;
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)&lt;br/&gt;
	at com.sun.javatest.regtest.agent.MainWrapper$MainTask.run(MainWrapper.java:138)&lt;br/&gt;
	at java.base/java.lang.Thread.run(Thread.java:1575)&lt;br/&gt;
	Suppressed: java.lang.RuntimeException: Expected &amp;#39;barRef&amp;#39; to be cleared&lt;br/&gt;
		at HandlersOnComplexUpdate.test(HandlersOnComplexUpdate.java:242)&lt;br/&gt;
		... 6 more&lt;br/&gt;
&lt;br/&gt;
JavaTest Message: Test threw exception: java.lang.RuntimeException: Unexpected reference: &lt;a href=&apos;mailto:java.lang.ref.WeakReference@13697cee&apos;&gt;java.lang.ref.WeakReference@13697cee&lt;/a&gt;&lt;br/&gt;
	expected: &lt;a href=&apos;mailto:java.lang.ref.WeakReference@4a26adb7&apos;&gt;java.lang.ref.WeakReference@4a26adb7&lt;/a&gt;&lt;br/&gt;
JavaTest Message: shutting down test&lt;br/&gt;
&lt;br/&gt;
STATUS:Failed.`main&amp;#39; threw exception: java.lang.RuntimeException: Unexpected reference: &lt;a href=&apos;mailto:java.lang.ref.WeakReference@13697cee&apos;&gt;java.lang.ref.WeakReference@13697cee&lt;/a&gt; expected: &lt;a href=&apos;mailto:java.lang.ref.WeakReference@4a26adb7&apos;&gt;java.lang.ref.WeakReference@4a26adb7&lt;/a&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5132209">JDK-8334573</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5133418">JDK-8335653</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5134789">JDK-8336857</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5135850">JDK-8337739</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5136259">JDK-8337943</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i36jir:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17357"><![CDATA[b26]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="250"><![CDATA[java.util.logging]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10100" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Verification</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17000"><![CDATA[Verified]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>