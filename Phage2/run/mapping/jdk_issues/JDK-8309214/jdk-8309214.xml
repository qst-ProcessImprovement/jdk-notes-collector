<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 09:08:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8309214] sun/security/pkcs11/KeyStore/CertChainRemoval.java fails after 8301154</title>
                <link>https://bugs.openjdk.org/browse/JDK-8309214</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>The new test sun/security/pkcs11/KeyStore/CertChainRemoval.java (introduced by &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8301154&quot; title=&quot;SunPKCS11 KeyStore deleteEntry results in dangling PrivateKey entries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8301154&quot;&gt;&lt;strike&gt;JDK-8301154&lt;/strike&gt;&lt;/a&gt;) fails on some tests systems.&lt;br/&gt;
Failures can be seen for example on RHEL 8.5 and SUSE Linux 15.3 .&lt;br/&gt;
Example output :&lt;br/&gt;
&lt;br/&gt;
config CertChainRemoval.setUp(): success&lt;br/&gt;
Beginning test run CertChainRemoval...&lt;br/&gt;
Cannot resolve artifact, please check if JIB jar is present in classpath.&lt;br/&gt;
nssLibDir: /usr/lib64/&lt;br/&gt;
Running test with provider SunPKCS11-nss (security manager disabled) ...&lt;br/&gt;
Starting with: &lt;br/&gt;
Entry# 1 = ca1&lt;br/&gt;
Entry# 2 = root&lt;br/&gt;
Entry# 3 = pk1&lt;br/&gt;
========&lt;br/&gt;
Initial PKCS11 KeyStore: &lt;br/&gt;
========&lt;br/&gt;
Add pk1, ca1 and root, then delete pk1&lt;br/&gt;
test CertChainRemoval.test(): failure&lt;br/&gt;
java.security.KeyStoreException: sun.security.pkcs11.wrapper.PKCS11Exception: CKR_GENERAL_ERROR&lt;br/&gt;
	at jdk.crypto.cryptoki/sun.security.pkcs11.P11KeyStore.engineSetEntry(P11KeyStore.java:1121)&lt;br/&gt;
	at jdk.crypto.cryptoki/sun.security.pkcs11.P11KeyStore.engineSetKeyEntry(P11KeyStore.java:462)&lt;br/&gt;
	at java.base/java.security.KeyStore.setKeyEntry(KeyStore.java:1192)&lt;br/&gt;
	at CertChainRemoval.main(CertChainRemoval.java:141)&lt;br/&gt;
	at PKCS11Test.premain(PKCS11Test.java:174)&lt;br/&gt;
	at PKCS11Test.testNSS(PKCS11Test.java:550)&lt;br/&gt;
	at PKCS11Test.main(PKCS11Test.java:210)&lt;br/&gt;
	at PKCS11Test.main(PKCS11Test.java:186)&lt;br/&gt;
	at CertChainRemoval.test(CertChainRemoval.java:77)&lt;br/&gt;
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)&lt;br/&gt;
	at java.base/java.lang.reflect.Method.invoke(Method.java:578)&lt;br/&gt;
	at org.testng.internal.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:132)&lt;br/&gt;
	at org.testng.internal.TestInvoker.invokeMethod(TestInvoker.java:599)&lt;br/&gt;
	at org.testng.internal.TestInvoker.invokeTestMethod(TestInvoker.java:174)&lt;br/&gt;
	at org.testng.internal.MethodRunner.runInSequence(MethodRunner.java:46)&lt;br/&gt;
	at org.testng.internal.TestInvoker$MethodInvocationAgent.invoke(TestInvoker.java:822)&lt;br/&gt;
	at org.testng.internal.TestInvoker.invokeTestMethods(TestInvoker.java:147)&lt;br/&gt;
	at org.testng.internal.TestMethodWorker.invokeTestMethods(TestMethodWorker.java:146)&lt;br/&gt;
	at org.testng.internal.TestMethodWorker.run(TestMethodWorker.java:128)&lt;br/&gt;
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1593)&lt;br/&gt;
	at org.testng.TestRunner.privateRun(TestRunner.java:764)&lt;br/&gt;
	at org.testng.TestRunner.run(TestRunner.java:585)&lt;br/&gt;
	at org.testng.SuiteRunner.runTest(SuiteRunner.java:384)&lt;br/&gt;
	at org.testng.SuiteRunner.runSequentially(SuiteRunner.java:378)&lt;br/&gt;
	at org.testng.SuiteRunner.privateRun(SuiteRunner.java:337)&lt;br/&gt;
	at org.testng.SuiteRunner.run(SuiteRunner.java:286)&lt;br/&gt;
	at org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:53)&lt;br/&gt;
	at org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:96)&lt;br/&gt;
	at org.testng.TestNG.runSuitesSequentially(TestNG.java:1218)&lt;br/&gt;
	at org.testng.TestNG.runSuitesLocally(TestNG.java:1140)&lt;br/&gt;
	at org.testng.TestNG.runSuites(TestNG.java:1069)&lt;br/&gt;
	at org.testng.TestNG.run(TestNG.java:1037)&lt;br/&gt;
	at com.sun.javatest.regtest.agent.TestNGRunner.main(TestNGRunner.java:102)&lt;br/&gt;
	at com.sun.javatest.regtest.agent.TestNGRunner.main(TestNGRunner.java:58)&lt;br/&gt;
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)&lt;br/&gt;
	at java.base/java.lang.reflect.Method.invoke(Method.java:578)&lt;br/&gt;
	at com.sun.javatest.regtest.agent.MainWrapper$MainTask.run(MainWrapper.java:138)&lt;br/&gt;
	at java.base/java.lang.Thread.run(Thread.java:1583)&lt;br/&gt;
Caused by: sun.security.pkcs11.wrapper.PKCS11Exception: CKR_GENERAL_ERROR&lt;br/&gt;
	at jdk.crypto.cryptoki/sun.security.pkcs11.wrapper.PKCS11.C_CreateObject(Native Method)&lt;br/&gt;
	at jdk.crypto.cryptoki/sun.security.pkcs11.P11KeyStore.storeCert(P11KeyStore.java:1576)&lt;br/&gt;
	at jdk.crypto.cryptoki/sun.security.pkcs11.P11KeyStore.storeChain(P11KeyStore.java:1591)&lt;br/&gt;
	at jdk.crypto.cryptoki/sun.security.pkcs11.P11KeyStore.storePkey(P11KeyStore.java:1814)&lt;br/&gt;
	at jdk.crypto.cryptoki/sun.security.pkcs11.P11KeyStore.engineSetEntry(P11KeyStore.java:1117)&lt;br/&gt;
	... 37 more</description>
                <environment></environment>
        <key id="5102227">JDK-8309214</key>
            <summary>sun/security/pkcs11/KeyStore/CertChainRemoval.java fails after 8301154</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://bugs.openjdk.org/images/jbsImages/p3.png">P3</priority>
                        <status id="6" iconUrl="https://bugs.openjdk.org/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="valeriep">Valerie Peng</assignee>
                                    <reporter username="mbaesken">Matthias Baesken</reporter>
                        <labels>
                            <label>jdk21u-fix-SQE-ok</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                    </labels>
                <created>Wed, 31 May 2023 07:21:13 -0700</created>
                <updated>Wed, 14 Feb 2024 09:29:11 -0800</updated>
                            <resolved>Tue, 22 Aug 2023 16:51:33 -0700</resolved>
                                    <version>21</version>
                    <version>22</version>
                                    <fixVersion>22</fixVersion>
                                    <component>security-libs</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="14608464" author="valeriep" created="Fri, 1 Sep 2023 15:32:01 -0700"  >Fix Request:&lt;br/&gt;
This PR updates the PKCS11 KeyStore impl to work with a NSS behavior change in newer NSS releases. Some platforms bundles new NSS releases and will fail when running the regression test sun/security/pkcs11/KeyStore/CertChainRemoval.java. Changes are verified with new NSS release and also by an external vendor with platform bundling NSS release by default.&lt;br/&gt;
&lt;br/&gt;
Patch applies cleanly. </comment>
                            <comment id="14606202" author="roboduke" created="Wed, 23 Aug 2023 12:07:32 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u/pull/93&quot;&gt;https://git.openjdk.org/jdk21u/pull/93&lt;/a&gt;&lt;br/&gt;
Date: 2023-08-23 19:01:26 +0000</comment>
                            <comment id="14605914" author="dukebot" created="Tue, 22 Aug 2023 16:51:32 -0700"  >Changeset: ba6cdbe2&lt;br/&gt;
Author:    Valerie Peng &amp;lt;&lt;a href=&apos;mailto:valeriep@openjdk.org&apos;&gt;valeriep@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-08-22 23:49:03 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/ba6cdbe2c2897a0fdc266119f0fe4545c3352b8e&quot;&gt;https://git.openjdk.org/jdk/commit/ba6cdbe2c2897a0fdc266119f0fe4545c3352b8e&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14601765" author="roboduke" created="Thu, 3 Aug 2023 13:58:41 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/15146&quot;&gt;https://git.openjdk.org/jdk/pull/15146&lt;/a&gt;&lt;br/&gt;
Date: 2023-08-03 20:51:33 +0000</comment>
                            <comment id="14601759" author="valeriep" created="Thu, 3 Aug 2023 13:37:43 -0700"  >It seems that certain version of NSS returns CKR_GENERAL_ERROR error code when trying to create another X509 Certificate object w/ CKA_ID/CKA_LABEL attributes (when there is already one such Certificate). When running the test against NSS v3.46, it passes vs v3.57, it failed with CRK_GENERAL_ERROR.&lt;br/&gt;
&lt;br/&gt;
The proposed fix is to check for existing certificate object first, if a match is found, set its CKA_ID/CKA_LABEL attribute instead of calling C_CreateObject() again.</comment>
                            <comment id="14600863" author="clanger" created="Wed, 2 Aug 2023 00:54:43 -0700"  >As we see this error showing up constantly in our CI, would it be ok to exclude the test for the time being?</comment>
                            <comment id="14587609" author="mbaesken" created="Wed, 7 Jun 2023 05:13:32 -0700"  >The error occured as well on Ubuntu 22.04 LTS .</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5108816">JDK-8314970</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5092358">JDK-8301154</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17008"><![CDATA[generic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17023"><![CDATA[linux]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i31qoz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17349"><![CDATA[b12]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="249"><![CDATA[javax.crypto:pkcs11]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10100" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Verification</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17000"><![CDATA[Verified]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>