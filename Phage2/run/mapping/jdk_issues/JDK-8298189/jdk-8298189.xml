<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 14:36:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8298189] Regression in SPECjvm2008-MonteCarlo for pre-Cascade Lake Intel processors</title>
                <link>https://bugs.openjdk.org/browse/JDK-8298189</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>Appeared in retriage of 20-b19.&lt;br/&gt;
I did CI build by build testing, this is related to &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8283699&quot; title=&quot;Improve the peephole mechanism of hotspot&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8283699&quot;&gt;&lt;strike&gt;JDK-8283699&lt;/strike&gt;&lt;/a&gt;.&lt;br/&gt;
&lt;br/&gt;
We run with the options:&lt;br/&gt;
-server -XX:+UnlockExperimentalVMOptions -XX:+UseZGC&lt;br/&gt;
&lt;br/&gt;
scimark.monte_carlo -ikv</description>
                <environment></environment>
        <key id="5089006">JDK-8298189</key>
            <summary>Regression in SPECjvm2008-MonteCarlo for pre-Cascade Lake Intel processors</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rcastanedalo">Roberto Castaneda Lozano</assignee>
                                    <reporter username="ecaspole">Eric Caspole</reporter>
                        <labels>
                            <label>oracle-triage-11</label>
                            <label>oracle-triage-17</label>
                            <label>oracle-triage-20</label>
                            <label>perf-regression</label>
                    </labels>
                <created>Tue, 6 Dec 2022 08:50:14 -0800</created>
                <updated>Mon, 1 May 2023 10:11:25 -0700</updated>
                            <resolved>Wed, 26 Apr 2023 01:27:49 -0700</resolved>
                                    <version>20</version>
                    <version>21</version>
                                    <fixVersion>21</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="14576931" author="dukebot" created="Wed, 26 Apr 2023 01:27:48 -0700"  >Changeset: 8d899925&lt;br/&gt;
Author:    Roberto Casta&amp;#xF1;eda Lozano &amp;lt;&lt;a href=&apos;mailto:rcastanedalo@openjdk.org&apos;&gt;rcastanedalo@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-04-26 08:25:11 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/8d899925dc281c5dabbef14d85a6df807f8d300e&quot;&gt;https://git.openjdk.org/jdk/commit/8d899925dc281c5dabbef14d85a6df807f8d300e&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14575952" author="roboduke" created="Mon, 24 Apr 2023 00:18:47 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/13605&quot;&gt;https://git.openjdk.org/jdk/pull/13605&lt;/a&gt;&lt;br/&gt;
Date: 2023-04-24 06:05:21 +0000</comment>
                            <comment id="14551000" author="rcastanedalo" created="Fri, 13 Jan 2023 04:43:50 -0800"  >[~qamai]  Would you mind looking at this again for JDK 21? (see my comments above). In the best of worlds, we might be able to reduce the scope of the peephole rules so that they only apply in the platforms where they are indeed profitable. As I mentioned offline, I am happy to assist you in running experiments and providing relevant details about our macOS x86-64 benchmarking platforms.</comment>
                            <comment id="14550999" author="rcastanedalo" created="Fri, 13 Jan 2023 04:37:44 -0800"  >ILW = slight performance regression in standard benchmark; reproducible on some macOS x86 platforms with ZGC; no known workaround = MLH = P4</comment>
                            <comment id="14550997" author="rcastanedalo" created="Fri, 13 Jan 2023 04:36:08 -0800"  >A more extensive performance study shows that &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8283699&quot; title=&quot;Improve the peephole mechanism of hotspot&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8283699&quot;&gt;&lt;strike&gt;JDK-8283699&lt;/strike&gt;&lt;/a&gt;, and even the individual peephole rule causing this particular regression, has an otherwise overall positive effect on a broader set of benchmarks and for different x86-64 platforms. Hence any (partial or full) reversal of &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8283699&quot; title=&quot;Improve the peephole mechanism of hotspot&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8283699&quot;&gt;&lt;strike&gt;JDK-8283699&lt;/strike&gt;&lt;/a&gt; is likely to do more harm than good. Furthermore, it was not possible to reproduce the reported regression consistently across a range of theoretically equivalent Mac x64 machines. Based on these results, I will adjust the priority of this issue and defer it to JDK 21.&lt;br/&gt;
&lt;br/&gt;
Thanks to [~thartmann] and [~ecaspole] for discussions and benchmarking assistance.</comment>
                            <comment id="14549537" author="rcastanedalo" created="Mon, 9 Jan 2023 03:29:58 -0800"  >Hi [~thartmann], good point. I will test the performance effect of reverting the whole patch vs. reverting the above rule only. If reverting the whole patch does not cause any regression elsewhere, this might indeed be the safest option.</comment>
                            <comment id="14548242" author="thartmann" created="Mon, 2 Jan 2023 23:32:17 -0800"  >Good catch, [~rcastanedalo]. Given that there are similar (leal related) rules in the patch, I&amp;#39;m wondering if we should backout the entire patch to be on the safe side for JDK 20 and re-investigate for JDK 21?</comment>
                            <comment id="14547673" author="rcastanedalo" created="Fri, 23 Dec 2022 08:53:26 -0800"  >The following peephole rule adding by &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8283699&quot; title=&quot;Improve the peephole mechanism of hotspot&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8283699&quot;&gt;&lt;strike&gt;JDK-8283699&lt;/strike&gt;&lt;/a&gt; to src/hotspot/cpu/x86/x86_64.ad is the culprit of the performance regression:&lt;br/&gt;
&lt;br/&gt;
peephole&lt;br/&gt;
%{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;peeppredicate(VM_Version::supports_fast_2op_lea());&lt;br/&gt;
&amp;nbsp;&amp;nbsp;peepmatch (incI_rReg);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;peepprocedure (lea_coalesce_imm);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;peepreplace (leaI_rReg_immI_peep());&lt;br/&gt;
%}&lt;br/&gt;
&lt;br/&gt;
Disabling it leads to the original (before &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8283699&quot; title=&quot;Improve the peephole mechanism of hotspot&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8283699&quot;&gt;&lt;strike&gt;JDK-8283699&lt;/strike&gt;&lt;/a&gt;) throughput for the affected benchmark.</comment>
                            <comment id="14543214" author="rcastanedalo" created="Tue, 6 Dec 2022 09:41:20 -0800"  >[~qamai] It seems RFE &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8283699&quot; title=&quot;Improve the peephole mechanism of hotspot&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8283699&quot;&gt;&lt;strike&gt;JDK-8283699&lt;/strike&gt;&lt;/a&gt; caused this performance regression, could you please have a look and see if you can reproduce it in your environment? Thanks!</comment>
                            <comment id="14543211" author="rcastanedalo" created="Tue, 6 Dec 2022 09:36:41 -0800"  >ILW = slight performance regression in standard benchmark; reproducible reliably on macOS with ZGC; no known workaround = MMH = P3</comment>
                            <comment id="14543202" author="ecaspole" created="Tue, 6 Dec 2022 09:00:39 -0800"  >FYI we test using Minis with 12.6&lt;br/&gt;
$ sw_vers&lt;br/&gt;
ProductName:	macOS&lt;br/&gt;
ProductVersion:	12.6&lt;br/&gt;
BuildVersion:	21G115</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5070984">JDK-8283699</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17004"><![CDATA[x86]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10003" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Introduced In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17431"><![CDATA[b19]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10004" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Introduced In Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="22023">20</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17017"><![CDATA[os_x]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2ziaj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17351"><![CDATA[b20]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="208"><![CDATA[compiler]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>