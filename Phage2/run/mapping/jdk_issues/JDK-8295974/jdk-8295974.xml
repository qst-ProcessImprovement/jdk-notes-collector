<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 14:17:09 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8295974] jni_FatalError and Xcheck:jni warnings should print the native stack when there are no Java frames</title>
                <link>https://bugs.openjdk.org/browse/JDK-8295974</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>JavaThread::print_stack_on is a no-op if there are no Java frames:&lt;br/&gt;
&lt;br/&gt;
void JavaThread::print_stack_on(outputStream* st) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;if (!has_last_Java_frame()) return;&lt;br/&gt;
&lt;br/&gt;
But it is used to show where -Xcheck:jni warnings originate from and from jni_FatalError. That means that when the JNI code is executed at the top-level of a thread, such as in the launcher, with no Java code on the stack, then we get zero information about where the warning, or error, was generated. This makes tracking down such warnings very tedious.&lt;br/&gt;
&lt;br/&gt;
If there are no Java frames the JNI code should call the debug utility print_native_stack; though I note a second problem if we do that is that os::current_frame() will trigger an assertion in the frame code due to a NULL pc. So a little more effort is needed to make that work (I commented out the assertion and got the stack trace I wanted).&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
        <key id="5086222">JDK-8295974</key>
            <summary>jni_FatalError and Xcheck:jni warnings should print the native stack when there are no Java frames</summary>
                <type id="7" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14707&amp;avatarType=issuetype">Enhancement</type>
                                            <priority id="3" iconUrl="https://bugs.openjdk.org/images/jbsImages/p3.png">P3</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dholmes">David Holmes</assignee>
                                    <reporter username="dholmes">David Holmes</reporter>
                        <labels>
                            <label>jdk11u-fix-request</label>
                            <label>jdk11u-fix-yes</label>
                            <label>jdk17u-fix-request</label>
                            <label>jdk17u-fix-yes</label>
                            <label>stack</label>
                            <label>starter</label>
                            <label>threads</label>
                    </labels>
                <created>Wed, 26 Oct 2022 22:33:50 -0700</created>
                <updated>Wed, 5 Jul 2023 17:30:58 -0700</updated>
                            <resolved>Mon, 2 Jan 2023 20:24:48 -0800</resolved>
                                    <version>8-pool</version>
                    <version>11-pool</version>
                    <version>17-pool</version>
                    <version>20</version>
                                    <fixVersion>21</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="14581919" author="mdoerr" created="Tue, 16 May 2023 07:40:25 -0700"  >Fix Request (11u):&lt;br/&gt;
Should get backported for parity with 11.0.20-oracle. Version from 17u applies almost cleanly. The trivial adaptation is described in the PR.</comment>
                            <comment id="14581908" author="roboduke" created="Tue, 16 May 2023 07:00:49 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk11u-dev/pull/1887&quot;&gt;https://git.openjdk.org/jdk11u-dev/pull/1887&lt;/a&gt;&lt;br/&gt;
Date: 2023-05-16 13:52:40 +0000</comment>
                            <comment id="14579655" author="mdoerr" created="Mon, 8 May 2023 00:53:25 -0700"  >Fix Request (17u):&lt;br/&gt;
Should get backported for parity with 17.0.8-oracle. Doesn&amp;#39;t apply cleanly (see PR). Included test has passed and our nightly tests didn&amp;#39;t show any regression.</comment>
                            <comment id="14579580" author="roboduke" created="Sat, 6 May 2023 14:06:11 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u-dev/pull/1328&quot;&gt;https://git.openjdk.org/jdk17u-dev/pull/1328&lt;/a&gt;&lt;br/&gt;
Date: 2023-05-06 20:58:02 +0000</comment>
                            <comment id="14548197" author="dukebot" created="Mon, 2 Jan 2023 20:24:47 -0800"  >Changeset: 37574333&lt;br/&gt;
Author:    David Holmes &amp;lt;&lt;a href=&apos;mailto:dholmes@openjdk.org&apos;&gt;dholmes@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-01-03 04:22:51 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/375743336dc15f9f945a03422eaa7ff773622cd8&quot;&gt;https://git.openjdk.org/jdk/commit/375743336dc15f9f945a03422eaa7ff773622cd8&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14545932" author="roboduke" created="Thu, 15 Dec 2022 23:15:15 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/11703&quot;&gt;https://git.openjdk.org/jdk/pull/11703&lt;/a&gt;&lt;br/&gt;
Date: 2022-12-16 07:07:06 +0000</comment>
                            <comment id="14545911" author="dholmes" created="Thu, 15 Dec 2022 20:57:44 -0800"  >Here&amp;#39;s a fabricated -Xcheck:jni warning occurring in an attached native thread.&lt;br/&gt;
&lt;br/&gt;
Before:&lt;br/&gt;
&lt;br/&gt;
WARNING in native method: JNI call made without checking exceptions when required to from CallStaticObjectMethod&lt;br/&gt;
&lt;br/&gt;
After:&lt;br/&gt;
&lt;br/&gt;
WARNING in native method: JNI call made without checking exceptions when required to from CallStaticObjectMethod&lt;br/&gt;
Native frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native code)&lt;br/&gt;
V  [libjvm.so+0x1186e5c]  functionEnter(JavaThread*)+0xbc  (jniCheck.cpp:193)&lt;br/&gt;
V  [libjvm.so+0x119d77b]  checked_jni_CallStaticObjectMethod+0xdb  (jniCheck.cpp:1290)&lt;br/&gt;
C  [libterminatedThread.so+0xa6f]  thread_start+0xbf  (libterminatedThread.c:63)</comment>
                            <comment id="14542096" author="dholmes" created="Thu, 1 Dec 2022 21:48:07 -0800"  >I injected a fault in the launcher when using -XshowSettings:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (showSettings != NULL) {&lt;br/&gt;
+        (*env)-&amp;gt;FatalError(env, &amp;quot;Injected fatal error in launcher&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ShowSettings(env, showSettings);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;CHECK_EXCEPTION_LEAVE(1);&lt;br/&gt;
&lt;br/&gt;
this is the output before:&lt;br/&gt;
&lt;br/&gt;
java -XshowSettings&lt;br/&gt;
FATAL ERROR in native method: Injected fatal error in launcher&lt;br/&gt;
Aborted (core dumped)&lt;br/&gt;
&lt;br/&gt;
and after:&lt;br/&gt;
&lt;br/&gt;
FATAL ERROR in native method: Injected fatal error in launcher&lt;br/&gt;
Native frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native code)&lt;br/&gt;
V  [libjvm.so+0x114ca6f]  jni_FatalError+0xef  (jni.cpp:630)&lt;br/&gt;
C  [libjli.so+0x3b47]  JavaMain+0xc7  (java.c:419)&lt;br/&gt;
C  [libjli.so+0x7a49]  ThreadJavaMain+0x9  (java_md.c:650)&lt;br/&gt;
Aborted (core dumped)&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5092315">JDK-8300964</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5092484">JDK-8301099</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5101024">JDK-8308186</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5101449">JDK-8308535</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5104873">JDK-8311541</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5104874">JDK-8311542</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5093084">JDK-8301570</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2z1or:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17314"><![CDATA[b04]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="192"><![CDATA[runtime]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>