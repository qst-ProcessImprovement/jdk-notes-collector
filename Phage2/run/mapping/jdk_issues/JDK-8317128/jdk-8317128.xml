<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 12:35:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8317128] java/nio/file/Files/CopyAndMove.java failed with AccessDeniedException</title>
                <link>https://bugs.openjdk.org/browse/JDK-8317128</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>The following test failed in the JDK22 CI:&lt;br/&gt;
&lt;br/&gt;
java/nio/file/Files/CopyAndMove.java&lt;br/&gt;
&lt;br/&gt;
Here&amp;#39;s a snippet from the log file:&lt;br/&gt;
&lt;br/&gt;
#section:main&lt;br/&gt;
----------messages:(6/235)----------&lt;br/&gt;
command: main CopyAndMove&lt;br/&gt;
reason: User specified action: run main/othervm CopyAndMove &lt;br/&gt;
started: Wed Sep 27 07:47:57 UTC 2023&lt;br/&gt;
Mode: othervm [/othervm specified]&lt;br/&gt;
finished: Wed Sep 27 07:48:00 UTC 2023&lt;br/&gt;
elapsed time (seconds): 2.939&lt;br/&gt;
----------configuration:(0/0)----------&lt;br/&gt;
----------System.out:(1/48)----------&lt;br/&gt;
Seed from RandomFactory = 5732842295462496703L&lt;br/&gt;
----------System.err:(27/2299)*----------&lt;br/&gt;
dir1: c:\\sb\\prod\\1695800281\\testoutput\\test-support\\jtreg_open_test_jdk_tier2_part2\\tmp\\name14645804210945068038 (NTFS)&lt;br/&gt;
dir2: .\\name7465159200941705506 (NTFS)&lt;br/&gt;
dir3: c:\\sb\\prod\\1695800281\\testoutput\\test-support\\jtreg_open_test_jdk_tier2_part2\\tmp\\name14645804210945068038 (NTFS)&lt;br/&gt;
java.nio.file.AccessDeniedException: c:\\sb\\prod\\1695800281\\testoutput\\test-support\\jtreg_open_test_jdk_tier2_part2\\tmp\\name14645804210945068038\\target1760060153&lt;br/&gt;
	at java.base/sun.nio.fs.WindowsException.translateToIOException(WindowsException.java:89)&lt;br/&gt;
	at java.base/sun.nio.fs.WindowsException.rethrowAsIOException(WindowsException.java:103)&lt;br/&gt;
	at java.base/sun.nio.fs.WindowsException.rethrowAsIOException(WindowsException.java:108)&lt;br/&gt;
	at java.base/sun.nio.fs.WindowsFileSystemProvider.newByteChannel(WindowsFileSystemProvider.java:234)&lt;br/&gt;
	at java.base/java.nio.file.Files.newByteChannel(Files.java:379)&lt;br/&gt;
	at PassThroughFileSystem$PassThroughProvider.newByteChannel(PassThroughFileSystem.java:323)&lt;br/&gt;
	at java.base/java.nio.file.spi.FileSystemProvider.newOutputStream(FileSystemProvider.java:482)&lt;br/&gt;
	at java.base/java.nio.file.Files.newOutputStream(Files.java:227)&lt;br/&gt;
	at java.base/java.nio.file.Files.copy(Files.java:3145)&lt;br/&gt;
	at java.base/java.nio.file.CopyMoveHelper.copyToForeignTarget(CopyMoveHelper.java:147)&lt;br/&gt;
	at java.base/java.nio.file.Files.copy(Files.java:1307)&lt;br/&gt;
	at CopyAndMove.copyAndVerify(CopyAndMove.java:663)&lt;br/&gt;
	at CopyAndMove.testCopyFileToFile(CopyAndMove.java:755)&lt;br/&gt;
	at CopyAndMove.main(CopyAndMove.java:104)&lt;br/&gt;
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)&lt;br/&gt;
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)&lt;br/&gt;
	at com.sun.javatest.regtest.agent.MainWrapper$MainTask.run(MainWrapper.java:138)&lt;br/&gt;
	at java.base/java.lang.Thread.run(Thread.java:1570)&lt;br/&gt;
&lt;br/&gt;
JavaTest Message: Test threw exception: java.nio.file.AccessDeniedException: c:\\sb\\prod\\1695800281\\testoutput\\test-support\\jtreg_open_test_jdk_tier2_part2\\tmp\\name14645804210945068038\\target1760060153&lt;br/&gt;
JavaTest Message: shutting down test&lt;br/&gt;
&lt;br/&gt;
STATUS:Failed.`main&amp;#39; threw exception: java.nio.file.AccessDeniedException: c:\\sb\\prod\\1695800281\\testoutput\\test-support\\jtreg_open_test_jdk_tier2_part2\\tmp\\name14645804210945068038\\target1760060153&lt;br/&gt;
----------rerun:(41/6362)*----------</description>
                <environment></environment>
        <key id="5111280">JDK-8317128</key>
            <summary>java/nio/file/Files/CopyAndMove.java failed with AccessDeniedException</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://bugs.openjdk.org/images/jbsImages/p3.png">P3</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bpb">Brian Burkhalter</assignee>
                                    <reporter username="dcubed">Daniel Daugherty</reporter>
                        <labels>
                            <label>amazon-interest</label>
                            <label>intermittent</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>noreg-other</label>
                            <label>tier2</label>
                    </labels>
                <created>Wed, 27 Sep 2023 16:52:18 -0700</created>
                <updated>Wed, 14 Aug 2024 06:05:35 -0700</updated>
                            <resolved>Fri, 6 Oct 2023 10:49:03 -0700</resolved>
                                    <version>21</version>
                    <version>22</version>
                                    <fixVersion>22</fixVersion>
                                    <component>core-libs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="14697727" author="roboduke" created="Mon, 12 Aug 2024 16:00:55 -0700"  >[jdk21u-fix-request] Approval Request from Todd V. Jonker&lt;br/&gt;
Backport of bugfix for regression caused by &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8073061&quot; title=&quot;(fs) Files.copy(foo, bar, REPLACE_EXISTING) deletes bar even if foo is not readable&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8073061&quot;&gt;&lt;strike&gt;JDK-8073061&lt;/strike&gt;&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Passes headless tests tiers 1-3</comment>
                            <comment id="14697295" author="roboduke" created="Fri, 9 Aug 2024 13:08:31 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/863&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/863&lt;/a&gt;&lt;br/&gt;
Date: 2024-07-22 20:25:34 +0000</comment>
                            <comment id="14616520" author="dukebot" created="Fri, 6 Oct 2023 10:49:02 -0700"  >Changeset: 6c6beba2&lt;br/&gt;
Author:    Brian Burkhalter &amp;lt;&lt;a href=&apos;mailto:bpb@openjdk.org&apos;&gt;bpb@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-10-06 17:46:03 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/6c6beba2569a2f9f3fd5d6988360ffd8680de821&quot;&gt;https://git.openjdk.org/jdk/commit/6c6beba2569a2f9f3fd5d6988360ffd8680de821&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14615044" author="bpb" created="Fri, 29 Sep 2023 11:02:53 -0700"  >noreg-other: Code is covered by existing tests.</comment>
                            <comment id="14615022" author="roboduke" created="Fri, 29 Sep 2023 09:47:50 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/15991&quot;&gt;https://git.openjdk.org/jdk/pull/15991&lt;/a&gt;&lt;br/&gt;
Date: 2023-09-29 15:57:48 +0000</comment>
                            <comment id="14614848" author="bpb" created="Thu, 28 Sep 2023 16:57:59 -0700"  >Before the change to CopyMoveHelper in &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8073061&quot; title=&quot;(fs) Files.copy(foo, bar, REPLACE_EXISTING) deletes bar even if foo is not readable&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8073061&quot;&gt;&lt;strike&gt;JDK-8073061&lt;/strike&gt;&lt;/a&gt;, a FileAlreadyExistsException was explicitly thrown if the target existed and REPLACE_EXISTING was not specified. After the change, instead CreateFileW is implicitly replied upon to generate an ERROR_FILE_EXISTS (0x50) error, but this function can fail with ERROR_ACCESS_DENIED (0x5) if there is a pending deletion on the file.</comment>
                            <comment id="14614845" author="bpb" created="Thu, 28 Sep 2023 16:34:51 -0700"  >The CreateFileW function can fail with either &amp;quot;The file exists&amp;quot; or &amp;quot;Access is denied&amp;quot; depending on the situation. From the CreateFileW specification:&lt;br/&gt;
&lt;br/&gt;
&amp;quot;If you call CreateFile on a file that is pending deletion as a result of a previous call to DeleteFile, the function fails. The operating system delays file deletion until all handles to the file are closed. GetLastError returns ERROR_ACCESS_DENIED.&amp;quot;</comment>
                            <comment id="14614823" author="bpb" created="Thu, 28 Sep 2023 13:57:06 -0700"  >This is the stack trace of the WindowsException which is caught and translated to an IOException:&lt;br/&gt;
&lt;br/&gt;
sun.nio.fs.WindowsException: The file exists&lt;br/&gt;
sun.nio.fs.WindowsException: Access is denied&lt;br/&gt;
java.nio.file.AccessDeniedException: c:\\sb\\prod\\1695932946\\testoutput\\test-support\\jtreg_open_test_jdk_java_nio_file_Files_CopyAndMove_java\\tmp\\name6363541076200925230\\target-1199255071&lt;br/&gt;
	at java.base/sun.nio.fs.WindowsException.translateToIOException(WindowsException.java:89)&lt;br/&gt;
	at java.base/sun.nio.fs.WindowsException.rethrowAsIOException(WindowsException.java:103)&lt;br/&gt;
	at java.base/sun.nio.fs.WindowsException.rethrowAsIOException(WindowsException.java:108)&lt;br/&gt;
	at java.base/sun.nio.fs.WindowsFileSystemProvider.newByteChannel(WindowsFileSystemProvider.java:235)&lt;br/&gt;
	at java.base/java.nio.file.Files.newByteChannel(Files.java:379)&lt;br/&gt;
&lt;br/&gt;
The initial exception message &amp;quot;The file exists&amp;quot; but this gets translated into an AccessDeniedException instead of a FileAlreadyExistsException.</comment>
                            <comment id="14614531" author="bpb" created="Wed, 27 Sep 2023 18:18:58 -0700"  >Has to be caused by the change to java/nio/file/CopyMoveHelper.java.</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5136800">JDK-8338392</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="4767892">JDK-8073061</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="19000"><![CDATA[x86_64]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17005"><![CDATA[windows]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i33aff:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17414"><![CDATA[b19]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="228"><![CDATA[java.nio]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>