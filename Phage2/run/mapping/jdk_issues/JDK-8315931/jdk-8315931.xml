<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 10:17:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8315931] RISC-V: xxxMaxVectorTestsSmokeTest fails when using RVV</title>
                <link>https://bugs.openjdk.org/browse/JDK-8315931</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>The tests &amp;lt;all-types&amp;gt;MaxVectorTests.maskCompress&amp;lt;all-types&amp;gt;MaxVectorTestsSmokeTest fails when using mask[i % 2].&lt;br/&gt;
It seem to fail regardless of OSR/C1/C2.&lt;br/&gt;
&lt;br/&gt;
test IntMaxVectorTests.maskCompressIntMaxVectorTestsSmokeTest(mask[i % 2]): failure&lt;br/&gt;
java.lang.AssertionError: expected [false] but found [true]&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;21242  438   size: 1056(416) time: 21 inlined: 5 bytes&lt;br/&gt;
&amp;nbsp;&amp;nbsp;21242  439    b        jdk.incubator.vector.AbstractVector::sameSpecies (54 bytes)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;21262  439   size: 984(408) time: 19 inlined: 4 bytes&lt;br/&gt;
&amp;nbsp;&amp;nbsp;21262  440    b        jdk.incubator.vector.IntVector::opCode (11 bytes)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;21273  440   size: 808(304) time: 11 inlined: 3 bytes&lt;br/&gt;
&amp;nbsp;&amp;nbsp;21274  441    b        jdk.incubator.vector.VectorOperators::opCode (10 bytes)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;21286  441   size: 904(352) time: 11 inlined: 2 bytes&lt;br/&gt;
&amp;nbsp;&amp;nbsp;21287  442    b        jdk.incubator.vector.VectorOperators$OperatorImpl::opCode (38 bytes)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;21295  442   size: 688(272) time: 8 inlined: 1 bytes&lt;br/&gt;
&amp;nbsp;&amp;nbsp;21295  443    b        jdk.internal.vm.vector.VectorSupport::compare (39 bytes)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;21522  443   size: 7536(2736) time: 226 inlined: 492 bytes&lt;br/&gt;
&amp;nbsp;&amp;nbsp;21522  444    b        jdk.incubator.vector.IntVector$$Lambda/0x000000002914cbc0::apply (21 bytes)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;21679  444   size: 4792(1688) time: 156 inlined: 218 bytes&lt;br/&gt;
&amp;nbsp;&amp;nbsp;21680  445    b        jdk.incubator.vector.IntVector::lambda$compareTemplate$59 (21 bytes)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;21833  445   size: 4560(1616) time: 152 inlined: 195 bytes&lt;br/&gt;
&amp;nbsp;&amp;nbsp;21833  446    b        jdk.incubator.vector.IntVector$$Lambda/0x000000002914cff0::&amp;lt;init&amp;gt; (10 bytes)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;21837  446   size: 248(128) time: 3 inlined: 1 bytes&lt;br/&gt;
&amp;nbsp;&amp;nbsp;21871  386             org.testng.Assert::assertEquals (7 bytes)   made not entrant&lt;br/&gt;
&lt;br/&gt;
I think this is what happens before we hit assert uncommon trap.&lt;br/&gt;
</description>
                <environment></environment>
        <key id="5109917">JDK-8315931</key>
            <summary>RISC-V: xxxMaxVectorTestsSmokeTest fails when using RVV</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gcao">Gui Cao</assignee>
                                    <reporter username="rehn">Robbin Ehn</reporter>
                        <labels>
                            <label>c2</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>oracle-triage-22</label>
                            <label>oraclejdk-na</label>
                    </labels>
                <created>Fri, 8 Sep 2023 04:59:12 -0700</created>
                <updated>Wed, 20 Sep 2023 22:22:03 -0700</updated>
                            <resolved>Fri, 15 Sep 2023 00:43:47 -0700</resolved>
                                    <version>21</version>
                    <version>22</version>
                                    <fixVersion>22</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14611550" author="roboduke" created="Fri, 15 Sep 2023 07:52:08 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u/pull/165&quot;&gt;https://git.openjdk.org/jdk21u/pull/165&lt;/a&gt;&lt;br/&gt;
Date: 2023-09-15 14:43:20 +0000</comment>
                            <comment id="14611549" author="JIRAUSER20521" created="Fri, 15 Sep 2023 07:44:08 -0700"  >Fix Request (21u):&lt;br/&gt;
Hi, This issue also exists in the JDK21U, so i would like to backport this to jdk21u make vector api work correctly when qemu enabled the parameter rvv_ta_all_1s=true. &lt;br/&gt;
test/jdk/jdk/incubator/vector passed with fastdebug and use build using qemu with rvv_ma_all_1s=true,rvv_ta_all_1s=true and UseRVV.&lt;br/&gt;
tier1-tier3 passed with release and use build using qemu with rvv_ma_all_1s=true,rvv_ta_all_1s=true and UseRVV.</comment>
                            <comment id="14611412" author="dukebot" created="Fri, 15 Sep 2023 00:43:46 -0700"  >Changeset: 4070829a&lt;br/&gt;
Author:    Gui Cao &amp;lt;&lt;a href=&apos;mailto:gcao@openjdk.org&apos;&gt;gcao@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Committer: Fei Yang &amp;lt;&lt;a href=&apos;mailto:fyang@openjdk.org&apos;&gt;fyang@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-09-15 07:42:23 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/4070829ae589678578a93b2886e02e04cf0a1b01&quot;&gt;https://git.openjdk.org/jdk/commit/4070829ae589678578a93b2886e02e04cf0a1b01&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14610371" author="roboduke" created="Tue, 12 Sep 2023 04:12:58 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/15680&quot;&gt;https://git.openjdk.org/jdk/pull/15680&lt;/a&gt;&lt;br/&gt;
Date: 2023-09-12 11:06:45 +0000</comment>
                            <comment id="14610351" author="chagedorn" created="Tue, 12 Sep 2023 02:55:15 -0700"  >Thanks Gui!&lt;br/&gt;
&lt;br/&gt;
ILW = Single test failure due to C2 compiler issue with riscv when using specific QEMU options, edge case and only observed with single test, use different QEMU options = MLM = P4  </comment>
                            <comment id="14610336" author="JIRAUSER20521" created="Tue, 12 Sep 2023 02:03:47 -0700"  >My local debugging shows that this is a riscv-specific c2 compiler issue. I will propose PR soon.</comment>
                            <comment id="14610329" author="chagedorn" created="Tue, 12 Sep 2023 01:36:56 -0700"  >Is the fix related to compiler?</comment>
                            <comment id="14610245" author="JIRAUSER20521" created="Mon, 11 Sep 2023 20:43:50 -0700"  >Hi, Thanks for the log information, after testing and troubleshooting the issue, the problem is related to two QEMU options (rvv_ma_all_1s=true,rvv_ta_all_1s=true), after removing them the problem disappeared. We are preparing a PR to fix this issue.</comment>
                            <comment id="14610073" author="rehn" created="Mon, 11 Sep 2023 06:07:40 -0700"  >Hi, it is partly timing dependent. Meaning depending on how and on what hardware I run, I can reproduce differently.&lt;br/&gt;
Right now I&amp;#39;m reproducing with the rerun command, I have lots of logging on, but if I don&amp;#39;t pipe output to file it passes.&lt;br/&gt;
&lt;br/&gt;
Using qemu tip + &lt;a href=&quot;https://patchew.org/QEMU/bc82203b72d7efb30f1b4a8f9eb3d94699799dc8.camel@rivosinc.com&quot;&gt;https://patchew.org/QEMU/bc82203b72d7efb30f1b4a8f9eb3d94699799dc8.camel@rivosinc.com&lt;/a&gt; (otherwise V is turn off) and jdk/jdk tip.&lt;br/&gt;
With qemu cpu: QEMU_CPU=rv64,v=true,vext_spec=v1.0,vlen=256,elen=64,rvv_ma_all_1s=true,rvv_ta_all_1s=true&lt;br/&gt;
And I have disable all other extension in hotspot. I&amp;#39;ll attach my rerun script.&lt;br/&gt;
&lt;br/&gt;
I have also disabled all other tests in IntMaxVectorTests.java&lt;br/&gt;
&lt;br/&gt;
[&lt;a href=&apos;mailto:rehn@rehn-xps&apos;&gt;rehn@rehn-xps&lt;/a&gt; open]$ ./rr_vanilla.sh &amp;gt; out&lt;br/&gt;
WARNING: Using incubator modules: jdk.incubator.vector&lt;br/&gt;
java.lang.Exception: failures: 1&lt;br/&gt;
...&lt;br/&gt;
STATUS:Failed.`main&amp;#39; threw exception: java.lang.Exception: failures: 1&lt;br/&gt;
[&lt;a href=&apos;mailto:rehn@rehn-xps&apos;&gt;rehn@rehn-xps&lt;/a&gt; open]$ grep &amp;quot;: failure&amp;quot; out&lt;br/&gt;
test IntMaxVectorTests.maskCompressIntMaxVectorTestsSmokeTest(mask[i % 2]): failure&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</comment>
                            <comment id="14609763" author="JIRAUSER20521" created="Fri, 8 Sep 2023 06:20:52 -0700"  >Hi, I am using openjdk git commit version:b3dfc399dae714958f22624daf76831c6ec2dfe0, qemu version is:qemu-7.1.0-rc4, using qemu user mode ,qemu cpu parameter is:-cpu rv64,v= true,vlen=256,vext_spec=v1.0 , jdk/incubator/vector The following test cases all pass. including tests &amp;lt;all-types&amp;gt;MaxVectorTests.maskCompress&amp;lt;all-types&amp;gt; MaxVectorTestsSmokeTest , can you provide us with your test environment so that we can find the problem.&lt;br/&gt;
By the way, in the attachments jtr is a log of the test &amp;lt;all-types&amp;gt;MaxVectorTests.maskCompress&amp;lt;all-types&amp;gt; MaxVectorTestsSmokeTest execution.</comment>
                            <comment id="14609758" author="fyang" created="Fri, 8 Sep 2023 05:41:41 -0700"  >I think these tests are covered when we were adding support for vector-api. [~gcao] Could you please confirm? Thanks.</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5110559">JDK-8316491</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5100306">JDK-8307609</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="106375" name="ByteMaxVectorTests.jtr" size="382435" author="gcao" created="Fri, 8 Sep 2023 06:17:28 -0700"/>
                            <attachment id="106380" name="DoubleMaxVectorTests.jtr" size="300227" author="gcao" created="Fri, 8 Sep 2023 06:17:47 -0700"/>
                            <attachment id="106379" name="FloatMaxVectorTests.jtr" size="290709" author="gcao" created="Fri, 8 Sep 2023 06:17:44 -0700"/>
                            <attachment id="106377" name="IntMaxVectorTests.jtr" size="371173" author="gcao" created="Fri, 8 Sep 2023 06:17:30 -0700"/>
                            <attachment id="106378" name="LongMaxVectorTests.jtr" size="347691" author="gcao" created="Fri, 8 Sep 2023 06:17:39 -0700"/>
                            <attachment id="106376" name="ShortMaxVectorTests.jtr" size="395450" author="gcao" created="Fri, 8 Sep 2023 06:17:29 -0700"/>
                            <attachment id="106388" name="rr_vanilla.sh" size="3616" author="rehn" created="Mon, 11 Sep 2023 06:09:44 -0700"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="20300"><![CDATA[riscv]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3320r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17312"><![CDATA[b16]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="208"><![CDATA[compiler]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>