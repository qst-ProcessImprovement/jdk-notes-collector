<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 12:45:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8324983] Race in CompileBroker::possibly_add_compiler_threads</title>
                <link>https://bugs.openjdk.org/browse/JDK-8324983</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>UseDynamicNumberOfCompilerThreads adds and removes compiler threads as necessary and the logic is driven primarily by AbstractCompiler::_num_compiler_threads.  When a thread is removed this number is decremented by CompileBroker::can_remove by the running CompilerThread.  Later, possibly_add_compiler_threads notices that it can spin up a new thread and it uses JavaThread::start_internal_daemon to associate a new CompilerThread with the existing JavaThread instance.  The problem is that CompileBroker::can_remove is called from the running CompilerThread before it has actually exited.  The exit of the thread clears java.lang.Thread.eetop on the way out.  It&amp;#39;s possible that a new CompilerThread is created before the old one has actually exited.  This will result in Thread.eetop being null for an actual running JavaThread.  For C1 and C2 this mostly doesn&amp;#39;t cause problems but for libgraal this can lead to hangs, particularly with ReentrantLock since eetop being null makes the thread appear dead.</description>
                <environment></environment>
        <key id="5120384">JDK-8324983</key>
            <summary>Race in CompileBroker::possibly_add_compiler_threads</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://bugs.openjdk.org/images/jbsImages/p2.png">P2</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="never">Tom Rodriguez</assignee>
                                    <reporter username="never">Tom Rodriguez</reporter>
                        <labels>
                            <label>amazon-interest</label>
                            <label>graal</label>
                            <label>hgupdate-sync</label>
                            <label>intermittent</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>jdk22-fix-request</label>
                            <label>jdk22-fix-yes</label>
                            <label>oracle-triage-23</label>
                    </labels>
                <created>Tue, 30 Jan 2024 08:55:57 -0800</created>
                <updated>Wed, 12 Jun 2024 12:44:55 -0700</updated>
                            <resolved>Mon, 5 Feb 2024 09:46:58 -0800</resolved>
                                    <version>11</version>
                    <version>17</version>
                    <version>21</version>
                    <version>22</version>
                    <version>23</version>
                                    <fixVersion>23</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="14680825" author="roboduke" created="Wed, 12 Jun 2024 01:03:19 -0700"  >[jdk21u-fix-request] Approval Request from Martin&lt;br/&gt;
Should get backported for parity with 21.0.5-oracle. Applies cleanly and tier 1-4 have passed.</comment>
                            <comment id="14680554" author="roboduke" created="Tue, 11 Jun 2024 05:46:29 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/693&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/693&lt;/a&gt;&lt;br/&gt;
Date: 2024-06-11 12:39:14 +0000</comment>
                            <comment id="14647092" author="kvn" created="Tue, 6 Feb 2024 09:21:06 -0800"  >Please, make sure to push before RDP 3 which is coming morning Feb 8.</comment>
                            <comment id="14647075" author="roboduke" created="Tue, 6 Feb 2024 08:50:21 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk22/pull/108&quot;&gt;https://git.openjdk.org/jdk22/pull/108&lt;/a&gt;&lt;br/&gt;
Date: 2024-02-06 16:46:23 +0000</comment>
                            <comment id="14647068" author="kvn" created="Tue, 6 Feb 2024 08:26:55 -0800"  >Also add 22 as affected version&lt;br/&gt;
</comment>
                            <comment id="14647067" author="kvn" created="Tue, 6 Feb 2024 08:26:26 -0800"  >I suggest to run mach5 testing with JDK 22 before integration.</comment>
                            <comment id="14647064" author="kvn" created="Tue, 6 Feb 2024 08:24:36 -0800"  >Approved for JDK 22.</comment>
                            <comment id="14647024" author="dnsimon" created="Tue, 6 Feb 2024 05:53:19 -0800"  >ILW = Deadlock in common Truffle workloads, occurs regularly in Truffle CI pipeline, -XX:-UseDynamicNumberOfCompilerThreads = HHL = P2</comment>
                            <comment id="14646955" author="dnsimon" created="Tue, 6 Feb 2024 02:08:03 -0800"  >Fix Request:&lt;br/&gt;
&lt;br/&gt;
This race can cause deadlock in Truffle workloads and can only be worked around with either -XX:+UnlockDiagnosticVMOptions -XX:-ReduceNumberOfCompilerThreads to disable idling of compiler threads or -XX:-UseDynamicNumberOfCompilerThreads to disable dynamic threads completely. We&amp;#39;d like to have this fix in for GraalVM 24.0 which will be based on JDK 22. This fix is simple and has gone through a round of CI testing in the mainline.</comment>
                            <comment id="14646692" author="dukebot" created="Mon, 5 Feb 2024 09:46:57 -0800"  >Changeset: 19936526&lt;br/&gt;
Author:    Tom Rodriguez &amp;lt;&lt;a href=&apos;mailto:never@openjdk.org&apos;&gt;never@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2024-02-05 17:43:34 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/1993652653eab8dd7ce2221a97cd2e401f2dcf56&quot;&gt;https://git.openjdk.org/jdk/commit/1993652653eab8dd7ce2221a97cd2e401f2dcf56&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14645806" author="roboduke" created="Wed, 31 Jan 2024 13:38:59 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/17662&quot;&gt;https://git.openjdk.org/jdk/pull/17662&lt;/a&gt;&lt;br/&gt;
Date: 2024-01-31 21:35:05 +0000</comment>
                            <comment id="14645019" author="thartmann" created="Tue, 30 Jan 2024 22:42:30 -0800"  >Graal is only affected since &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8319980&quot; title=&quot;[JVMCI] libgraal should reuse Thread instances as C2 does&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8319980&quot;&gt;&lt;strike&gt;JDK-8319980&lt;/strike&gt;&lt;/a&gt; in JDK 22 but I think the underlying issue exists since &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8198756&quot; title=&quot;Lazy allocation of compiler threads&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8198756&quot;&gt;&lt;strike&gt;JDK-8198756&lt;/strike&gt;&lt;/a&gt; in JDK 11.&lt;br/&gt;
&lt;br/&gt;
ILW = Race condition when reusing Thread instance for UseDynamicNumberOfCompilerThreads, intermittent with libgraal and Truffle, -XX:-UseDynamicNumberOfCompilerThreads = HLM = P3</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5120872">JDK-8325366</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5120926">JDK-8325415</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5131734">JDK-8334158</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5131506">JDK-8333948</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="4954220">JDK-8198756</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5114606">JDK-8319980</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i34t7v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17336"><![CDATA[b09]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="208"><![CDATA[compiler]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>