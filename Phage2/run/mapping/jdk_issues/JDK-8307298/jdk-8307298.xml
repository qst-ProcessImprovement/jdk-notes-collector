<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 19:07:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8307298] JFR: Ensure jdk.jfr.internal.TypeLibrary is initialized only once</title>
                <link>https://bugs.openjdk.org/browse/JDK-8307298</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>As of JDK 21, jdk.jfr.internal.TypeLibrary#initialize() unconditionally initializes TypeLibary. If TypeLibary is initialized more than once, there is the potential for things to break. This is because initialization results in adding elements to jdk.jfr.internal.Type#fields which may have already been changed to an unmodifiableList after the initial initialization of TypeLibrary. (see attached stacktrace). This suggests that TypeLibrary is only intended to be initialized once.&lt;br/&gt;
&lt;br/&gt;
This is of concern for JFR support in GraalVM Native Image. Specifically, multiple initializations of TypeLibrary breaks the ability to use JFR at native image built time. This is because, if JFR is used at image build time, the data of a few of the JFR singletons such as MetadataRepository must be re-initialized for runtime recordings to start with a &amp;quot;clean-slate&amp;quot;. However, re-initializing MetadataRepository, also has the effect of calling TypeLibrary#initialize() which unconditionally attempts to initialize TypeRepository, resulting in errors. &lt;br/&gt;
&lt;br/&gt;
It would be good if the previous behavior of TypeLibrary#initialize() could be re-implemented. A simple check whether the TypeLibrary is already initialized should be enough to fix the problem.</description>
                <environment></environment>
        <key id="5099949">JDK-8307298</key>
            <summary>JFR: Ensure jdk.jfr.internal.TypeLibrary is initialized only once</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://bugs.openjdk.org/images/jbsImages/p3.png">P3</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sgehwolf">Severin Gehwolf</assignee>
                                    <reporter username="rtoyonaga">Robert Toyonaga</reporter>
                        <labels>
                    </labels>
                <created>Tue, 2 May 2023 11:02:15 -0700</created>
                <updated>Wed, 17 May 2023 16:51:47 -0700</updated>
                            <resolved>Thu, 11 May 2023 11:07:30 -0700</resolved>
                                                    <fixVersion>21</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14581000" author="dukebot" created="Thu, 11 May 2023 11:07:28 -0700"  >Changeset: 5d6cce0f&lt;br/&gt;
Author:    Robert Toyonaga &amp;lt;&lt;a href=&apos;mailto:rtoyonag@redhat.com&apos;&gt;rtoyonag@redhat.com&lt;/a&gt;&amp;gt;&lt;br/&gt;
Committer: Severin Gehwolf &amp;lt;&lt;a href=&apos;mailto:sgehwolf@openjdk.org&apos;&gt;sgehwolf@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-05-11 18:05:58 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/5d6cce0f8543e8ae966798aad685b190cc8101aa&quot;&gt;https://git.openjdk.org/jdk/commit/5d6cce0f8543e8ae966798aad685b190cc8101aa&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14580256" author="roboduke" created="Tue, 9 May 2023 08:52:29 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/13760&quot;&gt;https://git.openjdk.org/jdk/pull/13760&lt;/a&gt;&lt;br/&gt;
Date: 2023-05-02 19:04:40 +0000</comment>
                            <comment id="14578855" author="JIRAUSER20715" created="Wed, 3 May 2023 11:37:34 -0700"  >Yes, there&amp;#39;s no need to go back to the previous version. A check should be enough. I have linked the PR in this issue.</comment>
                            <comment id="14578844" author="egahlin" created="Wed, 3 May 2023 10:58:42 -0700"  >The TypeLibrary is initialized once by the MetadataRepository (which is a singleton), so in practice it will not happen.&lt;br/&gt;
&lt;br/&gt;
If a check is needed for the compiler to understand it, it could be added. We should however not go back to the previous version because it contained race conditions. </comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5095596">JDK-8303674</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="103683" name="TypeLibrary_stacktrace" size="1344" author="rtoyonaga" created="Tue, 2 May 2023 09:56:36 -0700"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i31csr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17433"><![CDATA[b23]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="374"><![CDATA[jfr]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>