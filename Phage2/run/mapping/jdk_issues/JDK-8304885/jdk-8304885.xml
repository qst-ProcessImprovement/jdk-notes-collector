<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 08:54:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8304885] Reuse stale data to improve DNS resolver resiliency</title>
                <link>https://bugs.openjdk.org/browse/JDK-8304885</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>Discussion on net-dev@ &lt;a href=&quot;https://mail.openjdk.org/pipermail/net-dev/2023-March/020682.html&quot;&gt;https://mail.openjdk.org/pipermail/net-dev/2023-March/020682.html&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
One of the main issue I try to solve is how the cache handle the intermittent DNS server outages due to overloading or network connection.&lt;br/&gt;
&lt;br/&gt;
At the moment this cache can be configured by the application using the following two properties:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;(1) &amp;quot;networkaddress.cache.ttl&amp;quot;(30 sec) - cache policy for successful lookups&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;(2) &amp;quot;networkaddress.cache.negative.ttl&amp;quot;(10 sec) - cache policy for negative lookups&lt;br/&gt;
&lt;br/&gt;
Default timeout for positive responses is good enough to &amp;quot;have recent dns-records&amp;quot; and to &amp;quot;minimize the amount of requests to the DNS server&amp;quot;.&lt;br/&gt;
&lt;br/&gt;
But the cache for the negative responses is problematic. This is a problem I would like to solve. Caching the negative response means that for **10** seconds the application will not be able to connect to the server.&lt;br/&gt;
&lt;br/&gt;
Possible solutions:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;1. Decreasing timeout &amp;quot;for the negative responses&amp;quot;: unfortunately more requests to the server at the moment of &amp;quot;DNS-outage&amp;quot; cause even more issues, since this is not the right moment to load network/server more.&lt;br/&gt;
&amp;nbsp;&amp;nbsp;2. Increasing timeout &amp;quot;for the positive responses&amp;quot;: this will decrease the chance to get an error, but the cache will start to use stale data longer.&lt;br/&gt;
&amp;nbsp;&amp;nbsp;3. This proposal: it would be good to ignore the negative response and continue to use result of the last &amp;quot;successful lookup&amp;quot; until some additional timeout.&lt;br/&gt;
&lt;br/&gt;
The idea is to split the notion of the TTL and the timeout used for the cache. When TTL for the record will expire we should request the new data from the server. If this request goes fine we will update the record, if it fails we will continue to use the cached date until next sync.&lt;br/&gt;
&lt;br/&gt;
For example if the new property &amp;quot;networkaddress.extended.cache.ttl&amp;quot; is set to 10 minutes, then we will cache positive response for 10 minutes but will try to sync it every 30 seconds. If the new property is not set then as before we will cache positive for 30 seconds and then cache negative response for 10 seconds.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
RFC 8767 Serving Stale Data to Improve DNS Resiliency:&lt;br/&gt;
&lt;a href=&quot;https://www.rfc-editor.org/rfc/rfc8767&quot;&gt;https://www.rfc-editor.org/rfc/rfc8767&lt;/a&gt;</description>
                <environment></environment>
        <key id="5097077">JDK-8304885</key>
            <summary>Reuse stale data to improve DNS resolver resiliency</summary>
                <type id="7" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14707&amp;avatarType=issuetype">Enhancement</type>
                                            <priority id="3" iconUrl="https://bugs.openjdk.org/images/jbsImages/p3.png">P3</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="serb">Sergey Bylokhov</assignee>
                                    <reporter username="serb">Sergey Bylokhov</reporter>
                        <labels>
                            <label>amazon-interest</label>
                            <label>hgupdate-sync</label>
                            <label>jdk21-enhancement-request</label>
                            <label>jdk21-enhancement-yes</label>
                    </labels>
                <created>Fri, 24 Mar 2023 09:19:34 -0700</created>
                <updated>Tue, 4 Jul 2023 16:40:06 -0700</updated>
                            <resolved>Fri, 9 Jun 2023 16:22:31 -0700</resolved>
                                    <version>17</version>
                    <version>21</version>
                                    <fixVersion>22</fixVersion>
                                    <component>core-libs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="14591185" author="roboduke" created="Wed, 21 Jun 2023 15:46:47 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21/pull/53&quot;&gt;https://git.openjdk.org/jdk21/pull/53&lt;/a&gt;&lt;br/&gt;
Date: 2023-06-21 14:50:21 +0000</comment>
                            <comment id="14590640" author="mr" created="Tue, 20 Jun 2023 08:54:10 -0700"  >Late enhancement approved.</comment>
                            <comment id="14588282" author="dukebot" created="Fri, 9 Jun 2023 16:22:29 -0700"  >Changeset: bdd81b31&lt;br/&gt;
Author:    Sergey Bylokhov &amp;lt;&lt;a href=&apos;mailto:serb@openjdk.org&apos;&gt;serb@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-06-09 23:20:06 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/bdd81b31825a9eb6a0f0883fca56a011ac2aebf8&quot;&gt;https://git.openjdk.org/jdk/commit/bdd81b31825a9eb6a0f0883fca56a011ac2aebf8&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14588234" author="dfuchs" created="Fri, 9 Jun 2023 10:57:54 -0700"  >Note that whether the request for late enhancement is granted or not, you will need to integrate in the mainline first&lt;br/&gt;
</comment>
                            <comment id="14588221" author="serb" created="Fri, 9 Jun 2023 09:59:47 -0700"  >JDK 21. Late Enhancement Request:&lt;br/&gt;
&lt;br/&gt;
This is a small addition to the DNS resolver to enhance the stability of the Java applications. The work on this projects was started based on the various reports from people affected by intermittent instability of the DNS. Later implementation of the patch were aligned to the &amp;quot;RFC 8767 Serving Stale Data to Improve DNS Resiliency&amp;quot; and it has a positive motivation point:&lt;br/&gt;
&amp;gt;One of the motivations for serve-stale is to make the DNS more resilient to DoS attacks and thereby make them less attractive as an attack vector. &lt;br/&gt;
&lt;a href=&quot;https://www.rfc-editor.org/rfc/rfc8767&quot;&gt;https://www.rfc-editor.org/rfc/rfc8767&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
As a result the fix have two positive outcomes:&lt;br/&gt;
&amp;nbsp;- The users affected by the DNS or network intermittent outages may set the new property to some &amp;quot;big&amp;quot; value like 10 hours. During 10 hours the application will ignore the negative responses from the DNS and use the latest &amp;quot;positive&amp;quot; response from the server.&lt;br/&gt;
&amp;nbsp;- The users affected by the contention on the DNS cache in Java may set the new property to some &amp;quot;small&amp;quot; value like 2 seconds. This will allow to update the record in the cache by one thread only, while others will continue to use the &amp;quot;stale&amp;quot; data. Current behavior is to block all threads until the record will be updated since it is forbidden to use the stale data.&lt;br/&gt;
&lt;br/&gt;
Risks: the risk of the patch is low, the changes were implemented mostly isolated and could be enabled by the new security and java property. The default behavior is not changed. I&amp;#39;ll continue to maintain the changed code.&lt;br/&gt;
&lt;br/&gt;
The patch/PR is reviewed and approved for JDK22, the CSR is approved for JDK21 and JDK22.&lt;br/&gt;
CSR: &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8306653&quot;&gt;https://bugs.openjdk.org/browse/JDK-8306653&lt;/a&gt;&lt;br/&gt;
PR:    &lt;a href=&quot;https://github.com/openjdk/jdk/pull/13285&quot;&gt;https://github.com/openjdk/jdk/pull/13285&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14571208" author="roboduke" created="Mon, 3 Apr 2023 04:12:11 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/13285&quot;&gt;https://git.openjdk.org/jdk/pull/13285&lt;/a&gt;&lt;br/&gt;
Date: 2023-04-03 05:30:38 +0000</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5103968">JDK-8310726</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5104663">JDK-8311336</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10400">
                    <name>CSR</name>
                                            <outwardlinks description="csr for">
                                        <issuelink>
            <issuekey id="5099147">JDK-8306653</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17008"><![CDATA[generic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17010"><![CDATA[generic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i30vsr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17317"><![CDATA[b02]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="193"><![CDATA[java.net]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>