<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 09:16:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8309531] Incorrect result with unwrapped iotaShuffle.</title>
                <link>https://bugs.openjdk.org/browse/JDK-8309531</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>Following test shows incorrect results with -XX:-TieredCompilation, but works fine with -XX:TieredStopAtLevel=1&lt;br/&gt;
&lt;br/&gt;
IPROMPT&amp;gt;java --add-modules=jdk.incubator.vector -cp . shuffle&lt;br/&gt;
WARNING: Using incubator modules: jdk.incubator.vector&lt;br/&gt;
[res] 30378688 [time] 35 ms&lt;br/&gt;
IPROMPT&amp;gt;java --add-modules=jdk.incubator.vector -XX:TieredStopAtLevel=1 -cp . shuffle&lt;br/&gt;
WARNING: Using incubator modules: jdk.incubator.vector&lt;br/&gt;
[res] 4096 [time] 1351 ms&lt;br/&gt;
&lt;br/&gt;
------------------------------------------------------------------------------------------&lt;br/&gt;
import jdk.incubator.vector.*;&lt;br/&gt;
&lt;br/&gt;
public class shuffle {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;public static int micro(int i) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return ShortVector.SPECIES_512.iotaShuffle(i, 1, false)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;.toVector()&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;.reinterpretAsShorts()&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;.reduceLanes(VectorOperators.ADD);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;public static void main(String [] args) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;int res = 0;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;for (int i = 0; i &amp;lt; 10000; i++) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;res += micro(i &amp;amp; 31);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;long t1 = System.currentTimeMillis();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;for (int i = 0; i &amp;lt; 1000000; i++) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;res += micro(i &amp;amp; 31);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;long t2 = System.currentTimeMillis();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;System.out.println(&amp;quot;[res] &amp;quot; + res + &amp;quot; [time] &amp;quot; + (t2-t1) + &amp;quot; ms&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
}&lt;br/&gt;
--------------------------------------------------------------------------------------------&lt;br/&gt;
&lt;br/&gt;
Looks like the problem with the comparison predicate in iotaShuffle inline expander.&lt;br/&gt;
</description>
                <environment></environment>
        <key id="5102588">JDK-8309531</key>
            <summary>Incorrect result with unwrapped iotaShuffle.</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://bugs.openjdk.org/images/jbsImages/p3.png">P3</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jbhateja">Jatin Bhateja</assignee>
                                    <reporter username="jbhateja">Jatin Bhateja</reporter>
                        <labels>
                            <label>c2</label>
                            <label>hgupdate-sync</label>
                            <label>oracle-triage-11</label>
                            <label>oracle-triage-17</label>
                            <label>oracle-triage-21</label>
                            <label>vectorapi</label>
                    </labels>
                <created>Tue, 6 Jun 2023 04:05:55 -0700</created>
                <updated>Thu, 1 Aug 2024 01:59:33 -0700</updated>
                            <resolved>Tue, 4 Jul 2023 22:48:10 -0700</resolved>
                                    <version>18</version>
                    <version>19</version>
                    <version>20</version>
                    <version>21</version>
                    <version>22</version>
                                    <fixVersion>22</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14593835" author="jbhateja" created="Wed, 5 Jul 2023 00:41:12 -0700"  >Thanks Tobias</comment>
                            <comment id="14593714" author="roboduke" created="Tue, 4 Jul 2023 23:27:41 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21/pull/95&quot;&gt;https://git.openjdk.org/jdk21/pull/95&lt;/a&gt;&lt;br/&gt;
Date: 2023-07-05 06:21:35 +0000</comment>
                            <comment id="14593705" author="thartmann" created="Tue, 4 Jul 2023 23:19:18 -0700"  >I can take care of the backport to JDK 21. I think it&amp;#39;s too late for JDK 20.0.2 and I&amp;#39;m not sure though if anyone is still maintaining 18 and 19.</comment>
                            <comment id="14593701" author="jbhateja" created="Tue, 4 Jul 2023 23:00:40 -0700"  >&amp;gt;&amp;gt; [~jbhateja] this is a P3 bug and we are in RDP 1, no need for a fix request to integrate this into JDK 21, see &lt;a href=&quot;https://openjdk.org/jeps/3&quot;&gt;https://openjdk.org/jeps/3&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Got it, thanks!,  we should still backport it to 20 , 19 and 18 ?</comment>
                            <comment id="14593699" author="jbhateja" created="Tue, 4 Jul 2023 22:54:45 -0700"  >Needs to be backported to jdk21u to fix the incorrectness around unwrapped shuffleIota API, scope of fix is limited to vector API which is an incubating module. Other APIs dependent on shuffleIota i.e. slice / unslice operations use wrapped version of this API and are not effected by the fix.</comment>
                            <comment id="14593698" author="thartmann" created="Tue, 4 Jul 2023 22:53:13 -0700"  >[~jbhateja] this is a P3 bug and we are in RDP 1, no need for a fix request to integrate this into JDK 21, see &lt;a href=&quot;https://openjdk.org/jeps/3&quot;&gt;https://openjdk.org/jeps/3&lt;/a&gt;</comment>
                            <comment id="14593696" author="dukebot" created="Tue, 4 Jul 2023 22:48:09 -0700"  >Changeset: d6578bff&lt;br/&gt;
Author:    Jatin Bhateja &amp;lt;&lt;a href=&apos;mailto:jbhateja@openjdk.org&apos;&gt;jbhateja@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-07-05 05:46:24 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/d6578bff1c69ebc165fc9734e6503bd2d5d021c2&quot;&gt;https://git.openjdk.org/jdk/commit/d6578bff1c69ebc165fc9734e6503bd2d5d021c2&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14592573" author="roboduke" created="Wed, 28 Jun 2023 11:05:11 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/14700&quot;&gt;https://git.openjdk.org/jdk/pull/14700&lt;/a&gt;&lt;br/&gt;
Date: 2023-06-28 17:59:07 +0000</comment>
                            <comment id="14592491" author="jbhateja" created="Wed, 28 Jun 2023 05:20:26 -0700"  >After backing out Shuffle related overhaul from JDK-mainline.&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8310459,&quot;&gt;https://bugs.openjdk.org/browse/JDK-8310459,&lt;/a&gt; problem will also appear in mainline.&lt;br/&gt;
&lt;br/&gt;
I plan to add a fix in mainline followed by a backport to earlier versions.</comment>
                            <comment id="14587303" author="chagedorn" created="Tue, 6 Jun 2023 05:07:18 -0700"  >ILW = Incorrect result with vector API iotaShuffle, low?, disable intrinsic with -XX:DisableIntrinsic=_VectorShuffleIota = HLM = P3</comment>
                            <comment id="14587301" author="chagedorn" created="Tue, 6 Jun 2023 05:00:54 -0700"  >Does not reproduce with latest JDK. inline_vector_shuffle_iota() was removed with &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8304450&quot; title=&quot;[vectorapi] Refactor VectorShuffle implementation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8304450&quot;&gt;&lt;strike&gt;JDK-8304450&lt;/strike&gt;&lt;/a&gt;.</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5104890">JDK-8311558</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5106392">JDK-8312885</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5096566">JDK-8304450</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5104632">JDK-8311305</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i31sx7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17315"><![CDATA[b05]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="208"><![CDATA[compiler]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>