<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 10:43:52 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8264899] C1: -XX:AbortVMOnException does not work if all methods in the call stack are compiled with C1 and there are no exception handlers</title>
                <link>https://bugs.openjdk.org/browse/JDK-8264899</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>The method foo() in the attached Test.java throws MyException. &lt;br/&gt;
&lt;br/&gt;
$ java -XX:AbortVMOnException=MyException Test.java&lt;br/&gt;
$ java -XX:AbortVMOnException=MyException -XX:-TieredCompilation Test.java&lt;br/&gt;
&lt;br/&gt;
successfully results in the expected VM assertion failure:&lt;br/&gt;
&lt;br/&gt;
#&lt;br/&gt;
# A fatal error has been detected by the Java Runtime Environment:&lt;br/&gt;
#&lt;br/&gt;
#  Internal Error (/home/christian/jdk/open/src/hotspot/share/utilities/exceptions.cpp:544), pid=116514, tid=116515&lt;br/&gt;
#  fatal error: Saw MyException, aborting&lt;br/&gt;
#&lt;br/&gt;
# JRE version: Java(TM) SE Runtime Environment (17.0) (slowdebug build 17-internal+0-LTS-2021-03-25-1609321.christian...)&lt;br/&gt;
# Java VM: Java HotSpot(TM) 64-Bit Server VM (slowdebug 17-internal+0-LTS-2021-03-25-1609321.christian..., mixed mode, tiered, compressed oops, compressed class ptrs, g1 gc, linux-amd64)&lt;br/&gt;
# Problematic frame:&lt;br/&gt;
# V  [libjvm.so+0x8f6906]  Exceptions::debug_check_abort(char const*, char const*)+0x8a&lt;br/&gt;
&lt;br/&gt;
However, running it with -Xcomp and C1 only (TieredStopAtLevel) will not abort the VM:&lt;br/&gt;
&lt;br/&gt;
$ java -XX:AbortVMOnException=MyException -Xcomp Test.java&lt;br/&gt;
$ java -XX:AbortVMOnException=MyException -Xcomp -XX:TieredStopAtLevel=1,2,3 Test.java&lt;br/&gt;
&lt;br/&gt;
Exception in thread &amp;quot;main&amp;quot; MyException&lt;br/&gt;
	at Test.foo(Test.java:7)&lt;br/&gt;
	at Test.main(Test.java:3)&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
        <key id="5046403">JDK-8264899</key>
            <summary>C1: -XX:AbortVMOnException does not work if all methods in the call stack are compiled with C1 and there are no exception handlers</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dfenacci">Damon Fenacci</assignee>
                                    <reporter username="chagedorn">Christian Hagedorn</reporter>
                        <labels>
                            <label>c1</label>
                            <label>hs-comp-triaged</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>oracle-triage-17</label>
                            <label>ursqe-triaged</label>
                    </labels>
                <created>Thu, 8 Apr 2021 01:52:46 -0700</created>
                <updated>Fri, 16 Feb 2024 07:15:26 -0800</updated>
                            <resolved>Wed, 21 Jun 2023 05:28:44 -0700</resolved>
                                    <version>8</version>
                    <version>11</version>
                    <version>12</version>
                    <version>13</version>
                    <version>14</version>
                    <version>15</version>
                    <version>16</version>
                    <version>17</version>
                    <version>21</version>
                                    <fixVersion>22</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="14636318" author="roboduke" created="Sat, 23 Dec 2023 08:46:49 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/95&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/95&lt;/a&gt;&lt;br/&gt;
Date: 2023-12-23 16:42:28 +0000</comment>
                            <comment id="14636317" author="goetz" created="Sat, 23 Dec 2023 08:44:51 -0800"  >Fix request [21u]&lt;br/&gt;
&lt;br/&gt;
A useful fix of this feature, clear repro case.&lt;br/&gt;
Low risk, changes rarely used feature.&lt;br/&gt;
Clean backport.&lt;br/&gt;
Test passes and fails without the fix. SAP nightly testing passed.</comment>
                            <comment id="14590965" author="dukebot" created="Wed, 21 Jun 2023 05:28:43 -0700"  >Changeset: 826dcb54&lt;br/&gt;
Author:    Damon Fenacci &amp;lt;&lt;a href=&apos;mailto:dfenacci@openjdk.org&apos;&gt;dfenacci@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-06-21 12:27:02 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/826dcb5424a931953ac1964e7893aec7ec839862&quot;&gt;https://git.openjdk.org/jdk/commit/826dcb5424a931953ac1964e7893aec7ec839862&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14589211" author="roboduke" created="Wed, 14 Jun 2023 01:37:17 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/14240&quot;&gt;https://git.openjdk.org/jdk/pull/14240&lt;/a&gt;&lt;br/&gt;
Date: 2023-05-31 07:06:27 +0000</comment>
                            <comment id="14580961" author="JIRAUSER20518" created="Thu, 11 May 2023 07:59:36 -0700"  >There seem to be a specific case, in which &amp;quot;AbortVMOnException&amp;quot; is not taken into account, i.e. when an exception is thrown from C1 compiled code, the whole call stack is also C1 compiled and there isn&amp;#39;t any handler for the exception thrown.&lt;br/&gt;
In this case there is no call to &amp;quot;Exceptions::debug_check_abort&amp;quot; (which checks for a match between AbortVMOnException and the exception being thrown) anywhere while handling the exception.&lt;br/&gt;
&lt;br/&gt;
In other cases the &amp;quot;Exceptions::debug_check_abort&amp;quot; method is called: in C1&amp;#39;s &amp;quot;exception_handler_for_pc_helper&amp;quot; if a handler is present and from &amp;quot;InterpreterRuntime::exception_handler_for_exception&amp;quot; with the interpreter and C2 (which should deoptimise and run the interpreter code if an exception is thrown).&lt;br/&gt;
&lt;br/&gt;
We could possibly check for AbortVMOnException earlier on e.g. when the exception is being thrown (for all cases?).</comment>
                            <comment id="14412284" author="dholmes" created="Thu, 8 Apr 2021 22:38:45 -0700"  >It appears exception logging also does not work - not surprising as the code is co-located with the abort-check.</comment>
                            <comment id="14412035" author="thartmann" created="Thu, 8 Apr 2021 04:51:49 -0700"  >ILW = Diagnostic flag does not work, with -Xcomp and C1, no workaround (but use C2) = MLM = P4</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5117816">JDK-8322755</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5121685">JDK-8326046</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5104181">JDK-8310919</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="94011" name="Test.java" size="193" author="chagedorn" created="Thu, 8 Apr 2021 01:53:07 -0700"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2sb9n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17305"><![CDATA[b03]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="208"><![CDATA[compiler]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>