<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 11:29:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8303959] tools/jpackage/share/RuntimePackageTest.java fails with java.lang.AssertionError missing files</title>
                <link>https://bugs.openjdk.org/browse/JDK-8303959</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>[21:10:59.015] Succeeded in building MSI Installer Package package&lt;br/&gt;
[21:10:59.065] TRACE: exec: Done. Exit code: 0&lt;br/&gt;
[21:10:59.065] TRACE: assertEquals(0): Check command [c:\\ade\\mesos\\work_dir\\jib-master\\install\\2023-03-02-2350281.mikael.vidstedt.jdk\\windows-x64.jdk\\jdk-21\\bin\\jpackage.exe --dest .\\test\\output --name RuntimePackageTest --type msi --runtime-image c:\\ade\\mesos\\work_dir\\jib-master\\install\\2023-03-02-2350281.mikael.vidstedt.jdk\\windows-x64.jdk\\jdk-21 -J-Djlink.debug=true --verbose](11) exited with 0 code&lt;br/&gt;
[21:10:59.065] TRACE: assertTrue(): Check [.\\test\\output\\RuntimePackageTest-1.0.msi] path exists&lt;br/&gt;
[21:10:59.065] TRACE: assertTrue(): Check [.\\test\\output\\RuntimePackageTest-1.0.msi] is a file&lt;br/&gt;
[21:10:59.065] TRACE: Create [C:\\sb\\prod\\1678392806\\testoutput\\test-support\\jtreg_open_test_jdk_tier2\\scratch\\3_4\\test\\unpacked-msi\\unpack.bat] text file...&lt;br/&gt;
[21:10:59.065] TRACE: icacls &amp;quot;.\\test\\unpacked-msi&amp;quot; /inheritance:e /grant Users:M&lt;br/&gt;
[21:10:59.065] TRACE: msiexec /a &amp;quot;test\\output\\RuntimePackageTest-1.0.msi&amp;quot; /qn TARGETDIR=&amp;quot;C:\\sb\\prod\\1678392806\\testoutput\\test-support\\jtreg_open_test_jdk_tier2\\scratch\\3_4\\test\\unpacked-msi\\Program Files&amp;quot;&lt;br/&gt;
[21:10:59.081] TRACE: Done&lt;br/&gt;
[21:10:59.081] TRACE: exec: Execute [cmd /c .\\test\\unpacked-msi\\unpack.bat](3); discard I/O...&lt;br/&gt;
[21:11:03.948] TRACE: exec: Done. Exit code: 0&lt;br/&gt;
[21:11:03.948] TRACE: assertEquals(0): Check command [cmd /c .\\test\\unpacked-msi\\unpack.bat](3) exited with 0 code&lt;br/&gt;
[21:11:03.948] TRACE: Verify unpacked: [c:\\ade\\mesos\\work_dir\\jib-master\\install\\2023-03-02-2350281.mikael.vidstedt.jdk\\windows-x64.jdk\\jdk-21\\bin\\jpackage.exe --dest .\\test\\output --name RuntimePackageTest --type msi --runtime-image c:\\ade\\mesos\\work_dir\\jib-master\\install\\2023-03-02-2350281.mikael.vidstedt.jdk\\windows-x64.jdk\\jdk-21 jpt-unpacked-folder .\\test\\unpacked-msi](11)&lt;br/&gt;
[21:11:03.948] TRACE: assertEquals(2): Check the package has 2 top installation directories&lt;br/&gt;
[21:11:03.995] TRACE: assertStringListEquals(): Check there are no files with [.jpackage.xml] name in the package&lt;br/&gt;
[21:11:04.011] TRACE: assertStringListEquals(): Check there are no files with [.package] name in the package&lt;br/&gt;
[21:11:04.011] TRACE: assertTrue(): Check [.\\test\\unpacked-msi\\Program Files\\RuntimePackageTest] path exists&lt;br/&gt;
[21:11:04.011] TRACE: assertTrue(): Check [.\\test\\unpacked-msi\\Program Files\\RuntimePackageTest] is a directory&lt;br/&gt;
[21:11:04.073] TRACE: Missing 1 files:&lt;br/&gt;
[21:11:04.073] TRACE: conf\\security\\policy\\testlimited&lt;br/&gt;
[21:11:04.073] TRACE: Done&lt;br/&gt;
[21:11:04.089] ERROR: Failed: Check there are no missing files in installed image&lt;br/&gt;
[21:11:04.089] [  FAILED  ] RuntimePackageTest.test; checks=10&lt;br/&gt;
[21:11:04.089] [ RUN      ] RuntimePackageTest.testUsrInstallDir&lt;br/&gt;
[21:11:04.089] TRACE: Actions: [[initialize], [create], [unpack], [verify-install], [finalize]]&lt;br/&gt;
[21:11:04.089] TRACE: Deleting [.\\testUsrInstallDir] directory recursively&lt;br/&gt;
[21:11:04.104] [       OK ] RuntimePackageTest.testUsrInstallDir; checks=0&lt;br/&gt;
[21:11:04.104] [ RUN      ] RuntimePackageTest.testUsrInstallDir2&lt;br/&gt;
[21:11:04.104] TRACE: Actions: [[initialize], [create], [unpack], [verify-install], [finalize]]&lt;br/&gt;
[21:11:04.104] TRACE: Deleting [.\\testUsrInstallDir2] directory recursively&lt;br/&gt;
[21:11:04.104] [       OK ] RuntimePackageTest.testUsrInstallDir2; checks=0&lt;br/&gt;
[21:11:04.104] [==========] 3 tests ran&lt;br/&gt;
[21:11:04.104] [  PASSED  ] 2 tests&lt;br/&gt;
[21:11:04.104] [  FAILED  ] 1 test, listed below&lt;br/&gt;
[21:11:04.104] [  FAILED  ] RuntimePackageTest.test; workDir=[.\\test]&lt;br/&gt;
[21:11:04.104] 1 FAILED TEST&lt;br/&gt;
----------System.err:(58/3930)----------&lt;br/&gt;
java.lang.AssertionError: Failed: Check there are no missing files in installed image&lt;br/&gt;
	at jdk.jpackage.test.TKit.error(TKit.java:273)&lt;br/&gt;
	at jdk.jpackage.test.TKit.assertTrue(TKit.java:653)&lt;br/&gt;
	at RuntimePackageTest.assertFileListEmpty(RuntimePackageTest.java:160)&lt;br/&gt;
	at RuntimePackageTest.lambda$init$3(RuntimePackageTest.java:126)&lt;br/&gt;
	at jdk.jpackage.test.Functional$ThrowingConsumer.lambda$toConsumer$0(Functional.java:41)&lt;br/&gt;
	at jdk.jpackage.test.PackageTest$Handler.lambda$verifyPackageInstalled$5(PackageTest.java:658)</description>
                <environment></environment>
        <key id="5095950">JDK-8303959</key>
            <summary>tools/jpackage/share/RuntimePackageTest.java fails with java.lang.AssertionError missing files</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="asemenyuk">Alexey Semenyuk</assignee>
                                    <reporter username="msheppar">Mark Sheppard</reporter>
                        <labels>
                            <label>amazon-interest</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>noreg-self</label>
                            <label>sbr</label>
                            <label>sn_144</label>
                            <label>sn_145</label>
                            <label>sn_153</label>
                            <label>vs2022</label>
                    </labels>
                <created>Fri, 10 Mar 2023 02:33:15 -0800</created>
                <updated>Tue, 8 Apr 2025 15:29:09 -0700</updated>
                            <resolved>Fri, 29 Sep 2023 10:22:23 -0700</resolved>
                                    <version>17</version>
                    <version>21</version>
                    <version>22</version>
                                    <fixVersion>22</fixVersion>
                                    <component>tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="14664340" author="roboduke" created="Wed, 10 Apr 2024 03:39:00 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/485&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/485&lt;/a&gt;&lt;br/&gt;
Date: 2024-04-10 10:32:55 +0000</comment>
                            <comment id="14664337" author="goetz" created="Wed, 10 Apr 2024 03:32:35 -0700"  >Fix request [21u]&lt;br/&gt;
&lt;br/&gt;
I backport this for parity with 21.0.4-oracle.&lt;br/&gt;
No risk, only a test change.&lt;br/&gt;
Clean backport.&lt;br/&gt;
Test passes. SAP nightly testing passed.</comment>
                            <comment id="14615027" author="dukebot" created="Fri, 29 Sep 2023 10:22:22 -0700"  >Changeset: 5a6aa569&lt;br/&gt;
Author:    Alexey Semenyuk &amp;lt;&lt;a href=&apos;mailto:asemenyuk@openjdk.org&apos;&gt;asemenyuk@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-09-29 17:17:54 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/5a6aa569aa279141193038dc2e61e18a8b24bc11&quot;&gt;https://git.openjdk.org/jdk/commit/5a6aa569aa279141193038dc2e61e18a8b24bc11&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14614824" author="roboduke" created="Thu, 28 Sep 2023 14:04:38 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/15971&quot;&gt;https://git.openjdk.org/jdk/pull/15971&lt;/a&gt;&lt;br/&gt;
Date: 2023-09-28 20:58:30 +0000</comment>
                            <comment id="14611879" author="asemenyuk" created="Mon, 18 Sep 2023 14:05:31 -0700"  >tools/jpackage/share/RuntimePackageTest.java interfers with test/jdk/javax/crypto/CryptoPermissions/InconsistentEntries.java (&lt;a href=&quot;https://github.com/openjdk/jdk/blob/5308bbbcf8005560478d221d44f00fd2849d44f0/test/jdk/javax/crypto/CryptoPermissions/InconsistentEntries.java&quot;&gt;https://github.com/openjdk/jdk/blob/5308bbbcf8005560478d221d44f00fd2849d44f0/test/jdk/javax/crypto/CryptoPermissions/InconsistentEntries.java&lt;/a&gt;) test that creates $JAVA_HOME/conf/security/policy/testlimited directory. tools/jpackage/share/RuntimePackageTest.java packages contents of $JAVA_HOME directory, then unpacks it and compares directory tree of unpackaged package with the directory tree of $JAVA_HOME. test/jdk/javax/crypto/CryptoPermissions/InconsistentEntries.java is executed after the package is produced adding additional entries in directory tree of $JAVA_HOME. tools/jpackage/share/RuntimePackageTest.java test doesn&amp;#39;t expect changes in the source runtime directory.&lt;br/&gt;
&lt;br/&gt;
There are two options to fix the issue:&lt;br/&gt;
&amp;nbsp;- Use copy of $JAVA_HOME in --runtime-image jpackage parameter to guarantee the source runtime directory will not be altered during the test execution (an overkill to clone JDK home directory).&lt;br/&gt;
&amp;nbsp;- exclude conf/security/policy/testlimited from the comparison (adhoc solution not addressing potential changes to $JAVA_HOME by other tests).</comment>
                            <comment id="14603098" author="serb" created="Wed, 9 Aug 2023 20:44:23 -0700"  >I see exactly the same issue in JDK21b34(VS2022 is used):&lt;br/&gt;
[02:48:18.564] TRACE: assertEquals(2): Check the package has 2 top installation directories&lt;br/&gt;
[02:48:18.587] TRACE: assertStringListEquals(): Check there are no files with [.jpackage.xml] name in the package&lt;br/&gt;
[02:48:18.601] TRACE: assertStringListEquals(): Check there are no files with [.package] name in the package&lt;br/&gt;
[02:48:18.602] TRACE: assertTrue(): Check [.\test\unpacked-msi\Program Files\RuntimePackageTest] path exists&lt;br/&gt;
[02:48:18.602] TRACE: assertTrue(): Check [.\test\unpacked-msi\Program Files\RuntimePackageTest] is a directory&lt;br/&gt;
[02:48:18.648] TRACE: Missing 1 files:&lt;br/&gt;
[02:48:18.649] TRACE: conf\security\policy\testlimited&lt;br/&gt;
[02:48:18.649] TRACE: Done</comment>
                            <comment id="14565929" author="asemenyuk" created="Fri, 10 Mar 2023 09:42:22 -0800"  >[21:11:04.073] TRACE: Missing 1 files:&lt;br/&gt;
[21:11:04.073] TRACE: conf\\security\\policy\\testlimited&lt;br/&gt;
[21:11:04.073] TRACE: Done&lt;br/&gt;
&lt;br/&gt;
The above is something unique. Never seen this before</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5126552">JDK-8329989</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5126671">JDK-8330087</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="19000"><![CDATA[x86_64]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17005"><![CDATA[windows]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i30oub:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17354"><![CDATA[b18]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="2192"><![CDATA[jpackage]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>