<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 12:00:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8324817] Parallel GC does not pre-touch all heap pages when AlwaysPreTouch enabled and large page disabled</title>
                <link>https://bugs.openjdk.org/browse/JDK-8324817</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>AlwaysPreTouch requires all freshly committed pages to be pre-touched. While currently PS GC does not pre-touch heap pages with -XX:+AlwaysPreTouch.&lt;br/&gt;
This issue is related to &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8315923&quot; title=&quot;pretouch_memory by atomic-add-0 fragments huge pages unexpectedly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8315923&quot;&gt;&lt;strike&gt;JDK-8315923&lt;/strike&gt;&lt;/a&gt;, which fixes it when huge pages are used. But the bug still stands if regular page are used. For example, on linux we can reproduce this bug when /sys/kernel/mm/transparent_hugepage/enabled is madvise or never, but cannot reproduce when it is always.&lt;br/&gt;
&lt;br/&gt;
A simple way to reproduce, please make sure large pages are NOT used.&lt;br/&gt;
Just run a test with the following parameters&lt;br/&gt;
-XX:+AlwaysPreTouch -Xms31g -Xmx31g  -XX:+UseParallelGC&lt;br/&gt;
There is no pre-touching during heap initialing stage. After initialization, RSS of the test process is much smaller than memory committed.&lt;br/&gt;
On the contrary, using -XX:+UseG1GC and run the test again&lt;br/&gt;
-XX:+AlwaysPreTouch -Xms31g -Xmx31g  -XX:+UseG1GC&lt;br/&gt;
it takes several seconds to pre-touch heap pages during initialization, and RSS usage after initialization is similar to memory committed. This is the expected behavior of  AlwaysPreTouch&lt;br/&gt;
&lt;br/&gt;
This issue related to &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8283935&quot; title=&quot;Parallel: Crash during pretouch after large pages allocation failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8283935&quot;&gt;&lt;strike&gt;JDK-8283935&lt;/strike&gt;&lt;/a&gt;, which uses alignment() instead of os::vm_page_size() as pre-touching step size. The value of alignment() is usually bigger than OS page size, which causes most heap pages are not pre-touched.&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
        <key id="5120178">JDK-8324817</key>
            <summary>Parallel GC does not pre-touch all heap pages when AlwaysPreTouch enabled and large page disabled</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://bugs.openjdk.org/images/jbsImages/p3.png">P3</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="wzhuo">Wang Zhuo</assignee>
                                    <reporter username="wzhuo">Wang Zhuo</reporter>
                        <labels>
                            <label>amazon-interest</label>
                            <label>gc-parallel</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                    </labels>
                <created>Sun, 28 Jan 2024 23:28:18 -0800</created>
                <updated>Wed, 4 Jun 2025 05:41:51 -0700</updated>
                            <resolved>Sun, 4 Feb 2024 22:21:08 -0800</resolved>
                                    <version>21</version>
                    <version>22</version>
                    <version>23</version>
                                    <fixVersion>23</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14651522" author="roboduke" created="Thu, 22 Feb 2024 01:31:46 -0800"  >[jdk21u-fix-request] Approval Request from Liang Mao&lt;br/&gt;
Clean backport of fix of pretouch for parallel gc. The original issue is reproduced with linux/aarch64 and fix is verified. The risk is quite low since it only fixed the granularity of pretouch size and won&amp;#39;t have any other affection.</comment>
                            <comment id="14651521" author="roboduke" created="Thu, 22 Feb 2024 01:27:13 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/280&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/280&lt;/a&gt;&lt;br/&gt;
Date: 2024-02-22 09:21:24 +0000</comment>
                            <comment id="14646416" author="dukebot" created="Sun, 4 Feb 2024 22:21:07 -0800"  >Changeset: 80642dd7&lt;br/&gt;
Author:    Wang Zhuo &amp;lt;&lt;a href=&apos;mailto:wzhuo@openjdk.org&apos;&gt;wzhuo@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Committer: Denghui Dong &amp;lt;&lt;a href=&apos;mailto:ddong@openjdk.org&apos;&gt;ddong@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2024-02-05 06:19:02 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/80642dd7af3fcc7c042f11798c5cc899e20b9368&quot;&gt;https://git.openjdk.org/jdk/commit/80642dd7af3fcc7c042f11798c5cc899e20b9368&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14644291" author="roboduke" created="Mon, 29 Jan 2024 00:49:27 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/17610&quot;&gt;https://git.openjdk.org/jdk/pull/17610&lt;/a&gt;&lt;br/&gt;
Date: 2024-01-29 08:34:37 +0000</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5122670">JDK-8326896</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5123377">JDK-8327441</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5120689">JDK-8325218</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5109909">JDK-8315923</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5145968">JDK-8346005</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5071251">JDK-8283935</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17008"><![CDATA[generic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_10004" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Introduced In Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="22020">19</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17010"><![CDATA[generic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i34s0z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17336"><![CDATA[b09]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="209"><![CDATA[gc]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>