<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 11:49:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8320061] [nmt] Multiple issues with peak accounting</title>
                <link>https://bugs.openjdk.org/browse/JDK-8320061</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>There are multiple issues with peak printing.&lt;br/&gt;
&lt;br/&gt;
1) Peak values are not considered when deciding whether allocations fall above the scale threshold:&lt;br/&gt;
&lt;br/&gt;
NMT has this logic where it omits printing information if the values involved, expressed with the current NMT scale, don&amp;#39;t raise above 0. For example, with `jcmd myprog VM.native_memory scale=g` we would only be shown allocations that raise above 1Gb. However, we should also show information that had historically large values, even if they currently are small or even 0. For example, we want to see peaks in compiler memory usage even if current compiler memory usage is small.&lt;br/&gt;
&lt;br/&gt;
2) We decided to make peak printing a release-build feature with &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8317772&quot; title=&quot;NMT: Make peak values available in release builds&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8317772&quot;&gt;&lt;strike&gt;JDK-8317772&lt;/strike&gt;&lt;/a&gt;, but peak printing for virtual memory is still debug-only&lt;br/&gt;
&lt;br/&gt;
3) There is a bug in that VirtualMemory::peak that causes the peak value to be wrong; it gets not updated from the actual peak but from the commit increase, so the value shown is too low if we committed in multiple steps. That can be simply observed by &amp;quot;largest_committed&amp;quot; being smaller than &amp;quot;committed&amp;quot;, e.g.: `(mmap: reserved=1048576KB, committed=12928KB, largest_committed=64KB)` &lt;br/&gt;
&lt;br/&gt;
4) Finally, we really should have better regression tests for peak accounting.&lt;br/&gt;
</description>
                <environment></environment>
        <key id="5114694">JDK-8320061</key>
            <summary>[nmt] Multiple issues with peak accounting</summary>
                <type id="7" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14707&amp;avatarType=issuetype">Enhancement</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stuefe">Thomas Stuefe</assignee>
                                    <reporter username="stuefe">Thomas Stuefe</reporter>
                        <labels>
                            <label>amazon-interest</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>nmt</label>
                    </labels>
                <created>Tue, 14 Nov 2023 03:17:27 -0800</created>
                <updated>Fri, 26 Apr 2024 04:20:17 -0700</updated>
                            <resolved>Tue, 28 Nov 2023 09:50:34 -0800</resolved>
                                    <version>17.0.10</version>
                    <version>21.0.2</version>
                    <version>22</version>
                                    <fixVersion>22</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14667471" author="sgehwolf" created="Tue, 23 Apr 2024 07:36:10 -0700"  >OpenJDK 21u: This fixes an issue mentioned in the 21u backport of &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8293850&quot; title=&quot;need a largest_committed  metric for each category of NMT&amp;#39;s output&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8293850&quot;&gt;&lt;strike&gt;JDK-8293850&lt;/strike&gt;&lt;/a&gt;. I.e. is a follow-up fix. Approved.</comment>
                            <comment id="14667465" author="roboduke" created="Tue, 23 Apr 2024 07:23:42 -0700"  >[jdk21u-fix-request] Approval Request from Mar&amp;#xED;a Arias de Reyna&lt;br/&gt;
Fix Request&lt;br/&gt;
This is a backport for &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8320061&quot;&gt;https://bugs.openjdk.org/browse/JDK-8320061&lt;/a&gt; ( [nmt] Multiple issues with peak accounting ). This backport fixes several NMT things, among those, the problem with largest_committed being 0KB as shown on the previous PR.</comment>
                            <comment id="14664303" author="roboduke" created="Wed, 10 Apr 2024 01:43:42 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/481&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/481&lt;/a&gt;&lt;br/&gt;
Date: 2024-04-10 08:35:59 +0000</comment>
                            <comment id="14629609" author="dukebot" created="Tue, 28 Nov 2023 09:50:33 -0800"  >Changeset: dc256fbc&lt;br/&gt;
Author:    Thomas Stuefe &amp;lt;&lt;a href=&apos;mailto:stuefe@openjdk.org&apos;&gt;stuefe@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-11-28 17:48:54 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/dc256fbc6490f8163adb286dbb7380c10e5e1e06&quot;&gt;https://git.openjdk.org/jdk/commit/dc256fbc6490f8163adb286dbb7380c10e5e1e06&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14626564" author="roboduke" created="Wed, 15 Nov 2023 06:03:37 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/16675&quot;&gt;https://git.openjdk.org/jdk/pull/16675&lt;/a&gt;&lt;br/&gt;
Date: 2023-11-15 10:06:48 +0000</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5128035">JDK-8331192</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5083444">JDK-8293850</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5088713">JDK-8297958</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5112014">JDK-8317772</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i33v2b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17357"><![CDATA[b26]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="192"><![CDATA[runtime]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>