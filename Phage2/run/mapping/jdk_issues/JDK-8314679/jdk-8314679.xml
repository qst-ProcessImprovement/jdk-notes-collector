<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 09:53:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8314679] SA fails to properly attach to JVM after having just detached from a different JVM</title>
                <link>https://bugs.openjdk.org/browse/JDK-8314679</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>I noticed issues with both the HSDB GUI and clhsdb when attaching to a JVM, detaching, and then attaching to a different JVM (does not happening when reattaching to the same JVM). After the 2nd attach SA seems to be in a bad state which results in exceptions when issueing some commands. Specifically, instantiating a SA Klass wrapper fails. Here&amp;#39;s one example:&lt;br/&gt;
&lt;br/&gt;
$ build/linux-x64-debug/images/jdk/bin/jhsdb clhsdb&lt;br/&gt;
hsdb&amp;gt; attach 24845&lt;br/&gt;
Attaching to process 24845, please wait...&lt;br/&gt;
hsdb&amp;gt; jstack&lt;br/&gt;
&amp;lt;jstack output&amp;gt;&lt;br/&gt;
hsdb&amp;gt; detach&lt;br/&gt;
hsdb&amp;gt; attach 26842&lt;br/&gt;
Attaching to process 26842, please wait...&lt;br/&gt;
hsdb&amp;gt; jstack&lt;br/&gt;
WARNING: could not get Thread object: (7fa89c28aae0) sun.jvm.hotspot.types.WrongTypeException: No suitable match for type of address 0x00007fa7ff0478c8&lt;br/&gt;
sun.jvm.hotspot.types.WrongTypeException: No suitable match for type of address 0x00007fa7ff3acea0&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.runtime.InstanceConstructor.newWrongTypeException(InstanceConstructor.java:62)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.runtime.VirtualBaseConstructor.instantiateWrapperFor(VirtualBaseConstructor.java:111)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.oops.Metadata.instantiateWrapperFor(Metadata.java:78)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.oops.MetadataField.getValue(MetadataField.java:43)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.oops.MetadataField.getValue(MetadataField.java:40)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.oops.Klass.getNextLinkKlass(Klass.java:125)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.classfile.ClassLoaderData.find(ClassLoaderData.java:86)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.classfile.ClassLoaderDataGraph.find(ClassLoaderDataGraph.java:61)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.memory.SystemDictionary.getAbstractOwnableSynchronizerKlass(SystemDictionary.java:115)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.runtime.DeadlockDetector.print(DeadlockDetector.java:82)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.runtime.DeadlockDetector.print(DeadlockDetector.java:39)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.tools.StackTrace.run(StackTrace.java:62)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.CommandProcessor$27.doit(CommandProcessor.java:1153)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.CommandProcessor.executeCommand(CommandProcessor.java:2212)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.CommandProcessor.executeCommand(CommandProcessor.java:2182)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.CommandProcessor.run(CommandProcessor.java:2053)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.CLHSDB.run(CLHSDB.java:112)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.CLHSDB.main(CLHSDB.java:44)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.SALauncher.runCLHSDB(SALauncher.java:281)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.SALauncher.main(SALauncher.java:500)&lt;br/&gt;
Can&amp;#39;t print deadlocks: sun.jvm.hotspot.types.WrongTypeException: No suitable match for type of address 0x00007fa7ff3acea0&lt;br/&gt;
Error: sun.jvm.hotspot.types.WrongTypeException: No suitable match for type of address 0x00007fa7ff3acea0&lt;br/&gt;
&lt;br/&gt;
I don&amp;#39;t think it has anything to do with the ClassLoaderDataGraph or Klass.getNextLinkKlass(), since there are other exception stacks that don&amp;#39;t include them. For example, in HSDB if you do the same attach/detach/attach sequence, you run into the following when Swing sends an update request to the Threads List window:&lt;br/&gt;
&lt;br/&gt;
Exception in thread &amp;quot;AWT-EventQueue-0&amp;quot; sun.jvm.hotspot.types.WrongTypeException: No suitable match for type of address 0x00007f9827010220&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.runtime.InstanceConstructor.newWrongTypeException(InstanceConstructor.java:62)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.runtime.VirtualBaseConstructor.instantiateWrapperFor(VirtualBaseConstructor.java:111)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.oops.Metadata.instantiateWrapperFor(Metadata.java:78)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.oops.Oop.getKlassForOopHandle(Oop.java:210)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.oops.ObjectHeap.newOop(ObjectHeap.java:181)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.oops.NarrowOopField.getValue(NarrowOopField.java:44)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.oops.OopUtilities.threadOopGetName(OopUtilities.java:199)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.runtime.JavaThread.getThreadName(JavaThread.java:376)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.ui.JavaThreadsPanel$CachedThread.compute(JavaThreadsPanel.java:381)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.ui.JavaThreadsPanel$CachedThread.getThreadID(JavaThreadsPanel.java:363)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.ui.JavaThreadsPanel$JavaThreadsTableModel.getValueAt(JavaThreadsPanel.java:292)&lt;br/&gt;
	at java.desktop/javax.swing.JTable.getValueAt(JTable.java:2769)&lt;br/&gt;
&amp;lt;snip&amp;gt;</description>
                <environment></environment>
        <key id="5108491">JDK-8314679</key>
            <summary>SA fails to properly attach to JVM after having just detached from a different JVM</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://bugs.openjdk.org/images/jbsImages/p3.png">P3</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cjplummer">Chris Plummer</assignee>
                                    <reporter username="cjplummer">Chris Plummer</reporter>
                        <labels>
                            <label>jdk17u-fix-request</label>
                            <label>jdk17u-fix-yes</label>
                            <label>jdk21u-fix-SQE-ok</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                    </labels>
                <created>Mon, 21 Aug 2023 11:38:31 -0700</created>
                <updated>Wed, 20 Sep 2023 00:28:00 -0700</updated>
                            <resolved>Wed, 23 Aug 2023 13:13:05 -0700</resolved>
                                    <version>22</version>
                                    <fixVersion>22</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14611281" author="cjplummer" created="Thu, 14 Sep 2023 11:17:31 -0700"  >Just to clarify, this is a long standing bug in the source, but wasn&amp;#39;t exposed until JDK-8294323 was pushed. The bug was in FileMapInfo.java:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;public Type getTypeForVptrAddress(Address vptrAddress) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (vTableTypeMap == null) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;getHeader().createVtableTypeMapping();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return vTableTypeMap.get(vptrAddress);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&lt;br/&gt;
vTableTypeMap is cached and will be re-used on the next attach. It should be set back to null when initialize() is called.</comment>
                            <comment id="14611278" author="goetz" created="Thu, 14 Sep 2023 11:11:27 -0700"  >I wanted to link &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8313657&quot; title=&quot;com.sun.jndi.ldap.Connection.cleanup does not close connections on SocketTimeoutErrors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8313657&quot;&gt;&lt;strike&gt;JDK-8313657&lt;/strike&gt;&lt;/a&gt; to &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8314063&quot; title=&quot;The socket is not closed in Connection::createSocket when the handshake failed for LDAP connection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8314063&quot;&gt;&lt;strike&gt;JDK-8314063&lt;/strike&gt;&lt;/a&gt; because they depend on each other. Thanks for catching this.</comment>
                            <comment id="14611270" author="cjplummer" created="Thu, 14 Sep 2023 10:28:16 -0700"  >[~goetz], did you intend to link to JDK-8294323, not &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8314063&quot; title=&quot;The socket is not closed in Connection::createSocket when the handshake failed for LDAP connection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8314063&quot;&gt;&lt;strike&gt;JDK-8314063&lt;/strike&gt;&lt;/a&gt;?</comment>
                            <comment id="14611201" author="roboduke" created="Thu, 14 Sep 2023 05:53:02 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u-dev/pull/1741&quot;&gt;https://git.openjdk.org/jdk17u-dev/pull/1741&lt;/a&gt;&lt;br/&gt;
Date: 2023-09-14 12:44:43 +0000</comment>
                            <comment id="14611199" author="goetz" created="Thu, 14 Sep 2023 05:46:07 -0700"  >Fix request [17u]&lt;br/&gt;
&lt;br/&gt;
I backport this for parity with 17.0.10-oracle.&lt;br/&gt;
Low risk, trivial change in debug coding.&lt;br/&gt;
Clean except for dropping change to a test file not in 17.&lt;br/&gt;
Test passes and fails without the fix. SAP nightly testing passed.</comment>
                            <comment id="14611184" author="goetz" created="Thu, 14 Sep 2023 05:03:59 -0700"  >8294323: Improve Shared Class Data&lt;br/&gt;
&lt;a href=&quot;https://github.com/openjdk/jdk/commit/be70bc1c58eaec876aa1ab36eacba90b901ac9b8&quot;&gt;https://github.com/openjdk/jdk/commit/be70bc1c58eaec876aa1ab36eacba90b901ac9b8&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/openjdk/jdk17u-dev/commit/6db7aa688a3f07dadb66f359fc6eb9db0ad5e187&quot;&gt;https://github.com/openjdk/jdk17u-dev/commit/6db7aa688a3f07dadb66f359fc6eb9db0ad5e187&lt;/a&gt;</comment>
                            <comment id="14607001" author="roboduke" created="Mon, 28 Aug 2023 11:11:37 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u/pull/115&quot;&gt;https://git.openjdk.org/jdk21u/pull/115&lt;/a&gt;&lt;br/&gt;
Date: 2023-08-28 18:04:34 +0000</comment>
                            <comment id="14606999" author="cjplummer" created="Mon, 28 Aug 2023 11:07:11 -0700"  >Fix Request (21u).&lt;br/&gt;
Needed to address issue uncovered by JDK-8294323, which was already backported to 21. Simple fix and applies cleanly. </comment>
                            <comment id="14606212" author="dukebot" created="Wed, 23 Aug 2023 13:13:04 -0700"  >Changeset: 38a9edfb&lt;br/&gt;
Author:    Chris Plummer &amp;lt;&lt;a href=&apos;mailto:cjplummer@openjdk.org&apos;&gt;cjplummer@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-08-23 20:11:10 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/38a9edfb7ee2d91ff52074137c5b69e27bcdbdc3&quot;&gt;https://git.openjdk.org/jdk/commit/38a9edfb7ee2d91ff52074137c5b69e27bcdbdc3&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14605913" author="roboduke" created="Tue, 22 Aug 2023 16:28:03 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/15395&quot;&gt;https://git.openjdk.org/jdk/pull/15395&lt;/a&gt;&lt;br/&gt;
Date: 2023-08-22 23:22:37 +0000</comment>
                            <comment id="14605565" author="cjplummer" created="Mon, 21 Aug 2023 19:52:16 -0700"  >Seems to have started in JDK 20. I looked at every changeset in src/jdk.hotspot.agent that was committed during JDK 20 and nothing stood out.</comment>
                            <comment id="14605547" author="cjplummer" created="Mon, 21 Aug 2023 15:48:09 -0700"  >Does not seem to happen with JDK17.&lt;br/&gt;
&lt;br/&gt;
I think the issue is likely the the introduction of a static variable that is not reinitialized every time the Observer&amp;#39;s update() method is called (or perhaps there isn&amp;#39;t even an Observer registered).</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5109164">JDK-8315277</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5109322">JDK-8315402</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5110657">JDK-8316577</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                                        </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i32t7v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17349"><![CDATA[b12]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="2072"><![CDATA[svc-agent]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>