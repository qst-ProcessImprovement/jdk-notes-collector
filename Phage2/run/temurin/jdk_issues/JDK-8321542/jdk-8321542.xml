<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 11:14:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8321542] C2: Missing ChaCha20 stub for x86_32 leads to crashes</title>
                <link>https://bugs.openjdk.org/browse/JDK-8321542</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>x86_32 has no stub for ChaCha20. We therefore assert in LibraryCallKit::inline_chacha20Block() when trying to create a runtime call with the stub address which is null:&lt;br/&gt;
&lt;br/&gt;
#&lt;br/&gt;
# A fatal error has been detected by the Java Runtime Environment:&lt;br/&gt;
#&lt;br/&gt;
#  Internal Error (/home/christian/jdk2/open/src/hotspot/share/opto/graphKit.cpp:2496), pid=583031, tid=583058&lt;br/&gt;
#  assert(call_addr != nullptr) failed: must not call null targets&lt;br/&gt;
#&lt;br/&gt;
# JRE version: Java(TM) SE Runtime Environment (23.0) (slowdebug build 23-internal-2023-12-08-0752178.christian...)&lt;br/&gt;
# Java VM: Java HotSpot(TM) Server VM (slowdebug 23-internal-2023-12-08-0752178.christian..., mixed mode, tiered, g1 gc, linux-x86)&lt;br/&gt;
# Problematic frame:&lt;br/&gt;
# V  [libjvm.so+0x993846]  GraphKit::make_runtime_call(int, TypeFunc const*, unsigned char*, char const*, TypePtr const*, Node*, Node*, Node*, Node*, Node*, Node*, Node*, Node*)+0x38&lt;br/&gt;
&lt;br/&gt;
The fix should be straight forward to bail out on x86_32 (i.e. setting UseChaCha20Intrinsics to false on this platform).&lt;br/&gt;
&lt;br/&gt;
-------&lt;br/&gt;
&lt;br/&gt;
Original report:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8318756&quot; title=&quot;Create better internal buffer for AEADs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8318756&quot;&gt;&lt;strike&gt;JDK-8318756&lt;/strike&gt;&lt;/a&gt; added the CC20P1305 algorithm what is now called AEADBufferTest. A github test run for 32bit mode showed a crash on one of the tests.  This test iterates through different type and sized input buffers in a multi-part operation&lt;br/&gt;
&lt;br/&gt;
The failure is not consistent to a particular buffer size.  In the first known case the buffers lengths were update(96), update(8), and doFinal(10).  In the second case it was update(16), update(77), and doFinal(21).&lt;br/&gt;
&lt;br/&gt;
This test has shown no failures in 64bit and unlikely a result of the new internal buffer change in &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8318756&quot; title=&quot;Create better internal buffer for AEADs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8318756&quot;&gt;&lt;strike&gt;JDK-8318756&lt;/strike&gt;&lt;/a&gt;.  Pre-intrinsic checks should be preventing any incorrect buffers sent to the intrinsic.  It&amp;#39;s more likely the addition to the test has found a pre-existing bug.&lt;br/&gt;
&lt;br/&gt;
2023-12-07T16:17:53.9600749Z # A fatal error has been detected by the Java Runtime Environment:&lt;br/&gt;
2023-12-07T16:17:53.9600885Z #&lt;br/&gt;
2023-12-07T16:17:53.9601156Z #  SIGSEGV (0xb) at pc=0x00000000, pid=2248, tid=10052&lt;br/&gt;
2023-12-07T16:17:53.9601294Z #&lt;br/&gt;
2023-12-07T16:17:53.9602299Z # JRE version: OpenJDK Runtime Environment (22.0) (build 22-internal--9168e8a4b7c205f65e0235dd2a88f9719b1f157a)&lt;br/&gt;
2023-12-07T16:17:53.9603413Z # Java VM: OpenJDK Server VM (22-internal-x-9168e8a4b7c205f65e0235dd2a88f9719b1f157a, mixed mode, tiered, g1 gc, linux-x86)&lt;br/&gt;
2023-12-07T16:17:53.9603571Z # Problematic frame:&lt;br/&gt;
2023-12-07T16:17:53.9604830Z # J 5636 c2 com.sun.crypto.provider.ChaCha20Cipher.chaCha20Transform([BII[BI)V &lt;a href=&apos;mailto:java.base@22-internal&apos;&gt;java.base@22-internal&lt;/a&gt; (193 bytes) @ 0xef57e249 [0xef57dec0+0x00000389]&lt;br/&gt;
2023-12-07T16:17:53.9604957Z #&lt;br/&gt;
2023-12-07T16:17:53.9605263Z # CreateCoredumpOnCrash turned off, no core file dumped&lt;br/&gt;
&lt;br/&gt;
case1: &lt;a href=&quot;https://pipelinesghubeus4.actions.githubusercontent.com/95ZFXFsdGqaiknep1I1IAGcVYmkc9zx2Ed5n2kIsJi5wGebcj6/_apis/pipelines/1/runs/296/signedlogcontent/244?urlExpires=2023-12-07T18%3A19%3A17.2730894Z&amp;urlSigningMethod=HMACV1&amp;urlSignature=yS76mC3cZ%2BKhZtPZgO3M7NETqZuFXWuxKFxrcnlaoHE%3D&quot;&gt;https://pipelinesghubeus4.actions.githubusercontent.com/95ZFXFsdGqaiknep1I1IAGcVYmkc9zx2Ed5n2kIsJi5wGebcj6/_apis/pipelines/1/runs/296/signedlogcontent/244?urlExpires=2023-12-07T18%3A19%3A17.2730894Z&amp;amp;urlSigningMethod=HMACV1&amp;amp;urlSignature=yS76mC3cZ%2BKhZtPZgO3M7NETqZuFXWuxKFxrcnlaoHE%3D&lt;/a&gt;&lt;br/&gt;
case2: &lt;a href=&quot;https://pipelinesghubeus4.actions.githubusercontent.com/95ZFXFsdGqaiknep1I1IAGcVYmkc9zx2Ed5n2kIsJi5wGebcj6/_apis/pipelines/1/runs/298/signedlogcontent/245?urlExpires=2023-12-07T18%3A05%3A13.0339960Z&amp;urlSigningMethod=HMACV1&amp;urlSignature=%2Bz%2FQ3VXIdfW%2FHfZBzssjNkH36xQN4VnLn%2BjbXOF%2F8mc%3D&quot;&gt;https://pipelinesghubeus4.actions.githubusercontent.com/95ZFXFsdGqaiknep1I1IAGcVYmkc9zx2Ed5n2kIsJi5wGebcj6/_apis/pipelines/1/runs/298/signedlogcontent/245?urlExpires=2023-12-07T18%3A05%3A13.0339960Z&amp;amp;urlSigningMethod=HMACV1&amp;amp;urlSignature=%2Bz%2FQ3VXIdfW%2FHfZBzssjNkH36xQN4VnLn%2BjbXOF%2F8mc%3D&lt;/a&gt;</description>
                <environment></environment>
        <key id="5116412">JDK-8321542</key>
            <summary>C2: Missing ChaCha20 stub for x86_32 leads to crashes</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://bugs.openjdk.org/images/jbsImages/p3.png">P3</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jnimeh">Jamil Nimeh</assignee>
                                    <reporter username="ascarpino">Anthony Scarpino</reporter>
                        <labels>
                            <label>c2</label>
                            <label>hgupdate-sync</label>
                            <label>intrinsic</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>noreg-sqe</label>
                            <label>oracle-triage-17</label>
                            <label>oracle-triage-23</label>
                            <label>oraclejdk-na</label>
                    </labels>
                <created>Thu, 7 Dec 2023 10:28:17 -0800</created>
                <updated>Wed, 2 Apr 2025 06:19:08 -0700</updated>
                            <resolved>Tue, 12 Dec 2023 06:39:23 -0800</resolved>
                                    <version>20</version>
                    <version>21</version>
                    <version>22</version>
                    <version>23</version>
                                    <fixVersion>23</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="14635378" author="roboduke" created="Tue, 19 Dec 2023 02:44:30 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/68&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/68&lt;/a&gt;&lt;br/&gt;
Date: 2023-12-19 10:36:25 +0000</comment>
                            <comment id="14635374" author="roboduke" created="Tue, 19 Dec 2023 02:39:40 -0800"  >[jdk21u-fix-request] Approval Request from Aleksey Shipil&amp;#xEB;v&lt;br/&gt;
Clean backport to improve x86_32 reliability and parity with 21.0.3-oracle.</comment>
                            <comment id="14634375" author="roboduke" created="Thu, 14 Dec 2023 09:33:43 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk22/pull/14&quot;&gt;https://git.openjdk.org/jdk22/pull/14&lt;/a&gt;&lt;br/&gt;
Date: 2023-12-14 17:27:03 +0000</comment>
                            <comment id="14634192" author="thartmann" created="Wed, 13 Dec 2023 22:44:33 -0800"  >[~jnimeh] This should be backported to JDK 22. Will you take care of that? Thanks.</comment>
                            <comment id="14633659" author="dukebot" created="Tue, 12 Dec 2023 06:39:22 -0800"  >Changeset: 5718039a&lt;br/&gt;
Author:    Jamil Nimeh &amp;lt;&lt;a href=&apos;mailto:jnimeh@openjdk.org&apos;&gt;jnimeh@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-12-12 14:36:58 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/5718039a46ae51fa9b7042fe7163e3637e981b05&quot;&gt;https://git.openjdk.org/jdk/commit/5718039a46ae51fa9b7042fe7163e3637e981b05&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14633432" author="roboduke" created="Mon, 11 Dec 2023 17:07:54 -0800"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/17072&quot;&gt;https://git.openjdk.org/jdk/pull/17072&lt;/a&gt;&lt;br/&gt;
Date: 2023-12-12 01:02:59 +0000</comment>
                            <comment id="14633420" author="jnimeh" created="Mon, 11 Dec 2023 15:37:53 -0800"  >I am marking this bug with the noreg-sqe.  As stated above, this can be reproduced reliably on 32-bit by building the OpenJDK microbenchmarks and running java -jar benchmarks.jar CC20P1305Bench or AEADBufferTest.&lt;br/&gt;
I have a fix and have confirmed that the above microbenchmarks crash the 32-bit JVM without the fix and work with the fix, while not affecting x86_64&amp;#39;s ability to invoke the intrinsics.</comment>
                            <comment id="14633007" author="chagedorn" created="Sun, 10 Dec 2023 23:29:05 -0800"  >Thanks [~jnimeh]!</comment>
                            <comment id="14632703" author="jnimeh" created="Fri, 8 Dec 2023 08:52:50 -0800"  >[~chagedorn] Yes, I&amp;#39;m already working on it.  I don&amp;#39;t know why at this point it is trying to run an intrinsic on x86_32.  I didn&amp;#39;t write an intrinsic for that platform nor was it intended to be part of &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8247645&quot; title=&quot;ChaCha20 Intrinsics&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8247645&quot;&gt;&lt;strike&gt;JDK-8247645&lt;/strike&gt;&lt;/a&gt;.  So perhaps there&amp;#39;s just a missing switch to prevent 32-bit from trying to load a stub.</comment>
                            <comment id="14632701" author="ascarpino" created="Fri, 8 Dec 2023 08:51:47 -0800"  >The logs were passed on by [~djelinski] after the integration of &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8318756&quot; title=&quot;Create better internal buffer for AEADs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8318756&quot;&gt;&lt;strike&gt;JDK-8318756&lt;/strike&gt;&lt;/a&gt;.  Daniel got this from the openjdk github GHA sanity check runs.  It should be easy to reproduce run in 32bit mode and using open/test/jdk/com/sun/crypto/provider/Cipher/AEAD/AEADBufferTest.java.  Another possibility is running any of the JMH CC20P1305 perf tests.</comment>
                            <comment id="14632590" author="chagedorn" created="Fri, 8 Dec 2023 00:43:54 -0800"  >Hi [~jnimeh], can you have a look at that?</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5116994">JDK-8322069</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5117034">JDK-8322103</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5117600">JDK-8322555</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5117758">JDK-8322700</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10002">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="5108670">JDK-8314848</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5117183">JDK-8322241</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5022219">JDK-8247645</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5113125">JDK-8318756</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17004"><![CDATA[x86]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3458j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17317"><![CDATA[b02]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="208"><![CDATA[compiler]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>