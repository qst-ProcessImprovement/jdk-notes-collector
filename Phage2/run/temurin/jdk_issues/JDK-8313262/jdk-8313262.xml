<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 09:45:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8313262] C2:  Sinking node may cause required cast to be dropped</title>
                <link>https://bugs.openjdk.org/browse/JDK-8313262</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>Recent regression, bisected to &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8303279&quot; title=&quot;C2: crash in SubTypeCheckNode::sub() at IGVN split if&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8303279&quot;&gt;&lt;strike&gt;JDK-8303279&lt;/strike&gt;&lt;/a&gt;.&lt;br/&gt;
&lt;br/&gt;
There are plenty of tier1 tests failing with TEST_VM_OPTS=&amp;quot;-XX:+UseShenandoahGC&amp;quot;.&lt;br/&gt;
&lt;br/&gt;
A sample failure is:&lt;br/&gt;
&lt;br/&gt;
$ CONF=linux-x86_64-server-fastdebug make reconfigure clean test TEST=java/lang/reflect/PublicMethods/PublicMethodsTest.java TEST_VM_OPTS=&amp;quot;-XX:+UseShenandoahGC&amp;quot;&lt;br/&gt;
&lt;br/&gt;
#  Internal Error (/home/shipilev/shipilev-jdk/src/hotspot/share/opto/subtypenode.cpp:37), pid=10644, tid=10672&lt;br/&gt;
#  assert(sub_t != Type::TOP &amp;amp;&amp;amp; !TypePtr::NULL_PTR-&amp;gt;higher_equal(sub_t)) failed: should be not null&lt;br/&gt;
#&lt;br/&gt;
# JRE version: OpenJDK Runtime Environment (22.0) (fastdebug build 22-internal-adhoc.shipilev.shipilev-jdk)&lt;br/&gt;
# Java VM: OpenJDK 64-Bit Server VM (fastdebug 22-internal-adhoc.shipilev.shipilev-jdk, mixed mode, sharing, tiered, compressed oops, compressed class ptrs, shenandoah gc, linux-amd64)&lt;br/&gt;
# Problematic frame:&lt;br/&gt;
# V  [libjvm.so+0x168c4c1]  SubTypeCheckNode::sub(Type const*, Type const*) const+0x191&lt;br/&gt;
</description>
                <environment></environment>
        <key id="5106807">JDK-8313262</key>
            <summary>C2:  Sinking node may cause required cast to be dropped</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://bugs.openjdk.org/images/jbsImages/p2.png">P2</priority>
                        <status id="6" iconUrl="https://bugs.openjdk.org/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="roland">Roland Westrelin</assignee>
                                    <reporter username="shade">Aleksey Shipilev</reporter>
                        <labels>
                            <label>amazon-interest</label>
                            <label>c2</label>
                            <label>gc-shenandoah</label>
                            <label>jdk17u-fix-request</label>
                            <label>jdk17u-fix-yes</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>oracle-triage-22</label>
                            <label>regression</label>
                    </labels>
                <created>Thu, 27 Jul 2023 09:53:35 -0700</created>
                <updated>Thu, 25 Jan 2024 12:01:42 -0800</updated>
                            <resolved>Wed, 23 Aug 2023 02:02:57 -0700</resolved>
                                    <version>17</version>
                    <version>17.0.9</version>
                    <version>21</version>
                    <version>22</version>
                                    <fixVersion>22</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14643843" author="epavlova" created="Thu, 25 Jan 2024 12:01:42 -0800"  >The fix is not specific to Shenandoah but there is no clear way to reproduce it without it. </comment>
                            <comment id="14607502" author="shade" created="Tue, 29 Aug 2023 22:52:17 -0700"  >Have been running Fuzzer tests on mainline with different GCs for a while now after this commit, and there seem to be no new issues.</comment>
                            <comment id="14606656" author="shade" created="Fri, 25 Aug 2023 09:02:43 -0700"  >Fix Request (17u, 21u)&lt;br/&gt;
&lt;br/&gt;
Fixes the regressions for the fix backported to 17.0.9 and 21.0.1 (&lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8303279&quot; title=&quot;C2: crash in SubTypeCheckNode::sub() at IGVN split if&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8303279&quot;&gt;&lt;strike&gt;JDK-8303279&lt;/strike&gt;&lt;/a&gt;). Applies cleanly. New regression test passes, other tests pass, see relevant PRs.</comment>
                            <comment id="14606325" author="roboduke" created="Thu, 24 Aug 2023 01:33:33 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u-dev/pull/1690&quot;&gt;https://git.openjdk.org/jdk17u-dev/pull/1690&lt;/a&gt;&lt;br/&gt;
Date: 2023-08-24 08:25:40 +0000</comment>
                            <comment id="14606298" author="roboduke" created="Thu, 24 Aug 2023 00:18:59 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u/pull/99&quot;&gt;https://git.openjdk.org/jdk21u/pull/99&lt;/a&gt;&lt;br/&gt;
Date: 2023-08-24 07:13:09 +0000</comment>
                            <comment id="14606058" author="dukebot" created="Wed, 23 Aug 2023 02:02:56 -0700"  >Changeset: 1cee3b9f&lt;br/&gt;
Author:    Roland Westrelin &amp;lt;&lt;a href=&apos;mailto:roland@openjdk.org&apos;&gt;roland@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-08-23 08:59:36 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/1cee3b9fd9720e7938029a6992460b9053e65e57&quot;&gt;https://git.openjdk.org/jdk/commit/1cee3b9fd9720e7938029a6992460b9053e65e57&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14605653" author="roboduke" created="Tue, 22 Aug 2023 00:36:26 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/15380&quot;&gt;https://git.openjdk.org/jdk/pull/15380&lt;/a&gt;&lt;br/&gt;
Date: 2023-08-22 07:29:13 +0000</comment>
                            <comment id="14605300" author="roland" created="Mon, 21 Aug 2023 04:50:30 -0700"  >[~shade] I was away. I will most likely create the PR tomorrow.</comment>
                            <comment id="14605249" author="shade" created="Mon, 21 Aug 2023 02:02:23 -0700"  >Since the original fix that causes the regression is in 17.0.9, we need to get to this as soon as possible.</comment>
                            <comment id="14603177" author="thartmann" created="Thu, 10 Aug 2023 04:18:12 -0700"  >I think Roland is still on vacation, right?</comment>
                            <comment id="14603157" author="shade" created="Thu, 10 Aug 2023 02:25:13 -0700"  >Hey Roland! Any progress on this one?</comment>
                            <comment id="14601169" author="thartmann" created="Wed, 2 Aug 2023 04:04:54 -0700"  >ILW = Assert in C2 because Cast is incorrectly removed, reproduces with targeted test and Shenandoah GC, disable compilation of affected method or -XX:-SplitIfBlocks = HMM = P2</comment>
                            <comment id="14601149" author="thartmann" created="Wed, 2 Aug 2023 03:55:26 -0700"  >Prototype fix seems to be specific to code added already by &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8252372&quot; title=&quot;Check if cloning is required to move loads out of loops in PhaseIdealLoop::split_if_with_blocks_post()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8252372&quot;&gt;&lt;strike&gt;JDK-8252372&lt;/strike&gt;&lt;/a&gt;. Are we sure that &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8303279&quot; title=&quot;C2: crash in SubTypeCheckNode::sub() at IGVN split if&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8303279&quot;&gt;&lt;strike&gt;JDK-8303279&lt;/strike&gt;&lt;/a&gt; caused this?&lt;br/&gt;
&lt;br/&gt;
Update: Ah, &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8303279&quot; title=&quot;C2: crash in SubTypeCheckNode::sub() at IGVN split if&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8303279&quot;&gt;&lt;strike&gt;JDK-8303279&lt;/strike&gt;&lt;/a&gt; just added the assert but the actual bug is in there since &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8252372&quot; title=&quot;Check if cloning is required to move loads out of loops in PhaseIdealLoop::split_if_with_blocks_post()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8252372&quot;&gt;&lt;strike&gt;JDK-8252372&lt;/strike&gt;&lt;/a&gt;. </comment>
                            <comment id="14600571" author="shade" created="Tue, 1 Aug 2023 00:55:35 -0700"  >Thanks! I&amp;#39;ll keep an eye on it. Given the &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8303279&quot; title=&quot;C2: crash in SubTypeCheckNode::sub() at IGVN split if&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8303279&quot;&gt;&lt;strike&gt;JDK-8303279&lt;/strike&gt;&lt;/a&gt; is backported to 17.0.9 already, would be good to get this into 17u backport this month.</comment>
                            <comment id="14599901" author="roland" created="Fri, 28 Jul 2023 03:07:39 -0700"  >test case and tentative fix:&lt;br/&gt;
&lt;a href=&quot;https://github.com/rwestrel/jdk/tree/JDK-8313262&quot;&gt;https://github.com/rwestrel/jdk/tree/JDK-8313262&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
The issue is not specific to shenandoah but I don&amp;#39;t see how to reproduce it without it.&lt;br/&gt;
I will be out for a while. I&amp;#39;ll test it and create a PR when I&amp;#39;m back.</comment>
                            <comment id="14599667" author="shade" created="Thu, 27 Jul 2023 09:53:57 -0700"  >Roland, could you please take a look? Might be something simple missing in Shenandoah?</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5109198">JDK-8315308</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5108833">JDK-8314983</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5109199">JDK-8315309</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5028509">JDK-8252372</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5095109">JDK-8303279</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i32ixv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17349"><![CDATA[b12]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="208"><![CDATA[compiler]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>