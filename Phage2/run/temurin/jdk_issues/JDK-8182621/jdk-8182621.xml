<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 13:37:42 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8182621] JSSE should reject empty TLS plaintexts</title>
                <link>https://bugs.openjdk.org/browse/JDK-8182621</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>RFC 5246 [1] says the following about empty TLS plaintexts (section 6.2.1):&lt;br/&gt;
&amp;#xA0;&lt;br/&gt;
...&lt;br/&gt;
Implementations MUST NOT send zero-length fragments of Handshake, Alert, or ChangeCipherSpec content types. Zero-length fragments of Application data MAY be sent as they are potentially useful as a traffic analysis countermeasure.&lt;br/&gt;
...&lt;br/&gt;
&lt;br/&gt;
If a client doesn&amp;#39;t follow this requirement, JSSE server is going to wait for a not-empty TLS plaintext while handshaking. If the client keeps sending empty TLS plaintexts, then JSSE server is going to wait forever. This doesn&amp;#39;t look dangerous, but this behavior may waste some server resources. Please see attached test to reproduce the issue.&lt;br/&gt;
&lt;br/&gt;
Since the spec says that client must not send an empty TLS plaintext when handshaking, JSSE server may probably reject an empty TLS plaintext, and close the connection.&lt;br/&gt;
&lt;br/&gt;
[1]&amp;#xA0;&lt;a href=&quot;https://tools.ietf.org/html/rfc5246#section-6.1&quot;&gt;https://tools.ietf.org/html/rfc5246#section-6.1&lt;/a&gt;</description>
                <environment></environment>
        <key id="4932435">JDK-8182621</key>
            <summary>JSSE should reject empty TLS plaintexts</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://bugs.openjdk.org/images/jbsImages/p3.png">P3</priority>
                        <status id="6" iconUrl="https://bugs.openjdk.org/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mdonovan">Matthew Donovan</assignee>
                                    <reporter username="asmotrak">Artem Smotrakov</reporter>
                        <labels>
                            <label>tlsfun</label>
                    </labels>
                <created>Tue, 20 Jun 2017 19:05:07 -0700</created>
                <updated>Mon, 25 Aug 2025 09:08:55 -0700</updated>
                            <resolved>Mon, 10 Apr 2023 21:23:28 -0700</resolved>
                                    <version>9</version>
                    <version>10</version>
                                    <fixVersion>21</fixVersion>
                                    <component>security-libs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14811139" author="mbaesken" created="Sun, 24 Aug 2025 23:38:51 -0700"  >In the test SSLSocketEmptyFragments that came with this change we get 2-4 exceptions/errors like the one below.&lt;br/&gt;
This happens on Windows.  Can we make the test more reliable (e.g. increase allowed timeouts or retry the inputStream.read operation) ?&lt;br/&gt;
Exception :&lt;br/&gt;
&lt;br/&gt;
java.lang.RuntimeException: An error occurred running the test.&lt;br/&gt;
	at SSLSocketEmptyFragments.testEmptyChangeCipherSpecMessage(SSLSocketEmptyFragments.java:230)&lt;br/&gt;
	at SSLSocketEmptyFragments.executeTest(SSLSocketEmptyFragments.java:123)&lt;br/&gt;
	at SSLSocketEmptyFragments.main(SSLSocketEmptyFragments.java:357)&lt;br/&gt;
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)&lt;br/&gt;
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)&lt;br/&gt;
	at com.sun.javatest.regtest.agent.MainActionHelper$AgentVMRunnable.run(MainActionHelper.java:335)&lt;br/&gt;
	at java.base/java.lang.Thread.run(Thread.java:1474)&lt;br/&gt;
Caused by: java.net.SocketTimeoutException: Read timed out&lt;br/&gt;
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:277)&lt;br/&gt;
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:302)&lt;br/&gt;
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:354)&lt;br/&gt;
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:798)&lt;br/&gt;
	at java.base/java.net.Socket$SocketInputStream.implRead(Socket.java:981)&lt;br/&gt;
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:971)&lt;br/&gt;
	at java.base/java.io.InputStream.read(InputStream.java:222)&lt;br/&gt;
	at SSLSocketEmptyFragments.processServerResponse(SSLSocketEmptyFragments.java:245)&lt;br/&gt;
	at SSLSocketEmptyFragments.testEmptyChangeCipherSpecMessage(SSLSocketEmptyFragments.java:215)</comment>
                            <comment id="14572929" author="dukebot" created="Mon, 10 Apr 2023 21:23:27 -0700"  >Changeset: 39398075&lt;br/&gt;
Author:    Matthew Donovan &amp;lt;&lt;a href=&apos;mailto:matthew.p.donovan@oracle.com&apos;&gt;matthew.p.donovan@oracle.com&lt;/a&gt;&amp;gt;&lt;br/&gt;
Committer: Xue-Lei Andrew Fan &amp;lt;&lt;a href=&apos;mailto:xuelei@openjdk.org&apos;&gt;xuelei@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-04-11 04:21:17 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/39398075b719739513b7610286e19735a8b478b1&quot;&gt;https://git.openjdk.org/jdk/commit/39398075b719739513b7610286e19735a8b478b1&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14572312" author="roboduke" created="Thu, 6 Apr 2023 10:39:43 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/13306&quot;&gt;https://git.openjdk.org/jdk/pull/13306&lt;/a&gt;&lt;br/&gt;
Date: 2023-04-03 18:13:19 +0000</comment>
                            <comment id="14102717" author="asmotrak" created="Wed, 19 Jul 2017 17:36:45 -0700"  >Here is an untested patch for SSLEngineImpl.java&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
diff -r 77ad59329987 src/java.base/share/classes/sun/security/ssl/SSLEngineImpl.java&lt;br/&gt;
--- a/src/java.base/share/classes/sun/security/ssl/SSLEngineImpl.java	Tue Jun 20 13:43:43 2017 -0700&lt;br/&gt;
+++ b/src/java.base/share/classes/sun/security/ssl/SSLEngineImpl.java	Wed Jul 19 17:39:52 2017 -0700&lt;br/&gt;
@@ -1,5 +1,5 @@&lt;br/&gt;
&amp;nbsp;/*&lt;br/&gt;
- * Copyright (c) 2003, 2016, Oracle and/or its affiliates. All rights reserved.&lt;br/&gt;
+ * Copyright (c) 2003, 2017, Oracle and/or its affiliates. All rights reserved.&lt;br/&gt;
&amp;nbsp;&amp;nbsp;* DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.&lt;br/&gt;
&amp;nbsp;&amp;nbsp;*&lt;br/&gt;
&amp;nbsp;&amp;nbsp;* This code is free software; you can redistribute it and/or modify it&lt;br/&gt;
@@ -973,6 +973,10 @@&lt;br/&gt;
&amp;nbsp;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if ((!isDTLS || plainText == null) &amp;amp;&amp;amp; netData != null) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;plainText = inputRecord.decode(netData);&lt;br/&gt;
+                if (!plainText.fragment.hasRemaining()) {&lt;br/&gt;
+                    throw new SSLHandshakeException(&lt;br/&gt;
+                            &amp;quot;Empty TLS plaintext received&amp;quot;);&lt;br/&gt;
+                }&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;} catch (UnsupportedOperationException unsoe) {         // SSLv2Hello&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// Hack code to deliver SSLv2 error message for SSL/TLS connections.</comment>
                            <comment id="14102712" author="asmotrak" created="Wed, 19 Jul 2017 17:00:15 -0700"  >Similar issue seems to be in SSLEngine as well. When an empty TLS plaintext is consumed by SSLEngine, it changes its status from NEED_UNWRAP to NEED_TASK. After running a delegated task, it changes the status to NEED_UNWRAP again. If a new empty TLS plain text message is sent again, then the cycle repeats. It might be better if SSLEngine.unwrap() rejected an empty TLS plaintext.</comment>
                            <comment id="14094642" author="asmotrak" created="Tue, 20 Jun 2017 19:12:26 -0700"  >Something like the following could fix this:&lt;br/&gt;
&lt;br/&gt;
diff -r 77ad59329987 src/java.base/share/classes/sun/security/ssl/SSLSocketImpl.java&lt;br/&gt;
--- a/src/java.base/share/classes/sun/security/ssl/SSLSocketImpl.java	Tue Jun 20 13:43:43 2017 -0700&lt;br/&gt;
+++ b/src/java.base/share/classes/sun/security/ssl/SSLSocketImpl.java	Tue Jun 20 19:10:08 2017 -0700&lt;br/&gt;
@@ -1070,6 +1070,11 @@&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&lt;br/&gt;
+                if (!plainText.fragment.hasRemaining()) {&lt;br/&gt;
+                    throw new SSLHandshakeException(&lt;br/&gt;
+                            &amp;quot;Empty TLS plaintext received&amp;quot;);&lt;br/&gt;
+                }&lt;br/&gt;
+&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// PlainText should never be null. Process input record.&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;int volume = processInputRecord(plainText, needAppData);&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Although, I am not sure it&amp;#39;s a right place. Probably SSLEngine needs to be updated as well.</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5169065">JDK-8366107</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="70715" name="EmptyTLSPlaintext.java" size="5096" author="asmotrak" created="Tue, 20 Jun 2017 19:06:48 -0700"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i295sb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17354"><![CDATA[b18]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="324"><![CDATA[javax.net.ssl]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10100" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Verification</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17000"><![CDATA[Verified]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>