<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 12:30:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8313983] jmod create --target-platform should replace existing ModuleTarget attribute</title>
                <link>https://bugs.openjdk.org/browse/JDK-8313983</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>Attempts to unpack and pack the java.compiler.jmod produces the next exception:&lt;br/&gt;
===========================================&lt;br/&gt;
Error: More than one ModuleTarget attribute&lt;br/&gt;
java.lang.module.InvalidModuleDescriptorException: More than one ModuleTarget attribute&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.base/jdk.internal.module.ModuleInfo.invalidModuleDescriptor(ModuleInfo.java:1216)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.base/jdk.internal.module.ModuleInfo.doRead(ModuleInfo.java:243)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.base/jdk.internal.module.ModuleInfo.read(ModuleInfo.java:129)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at jdk.jlink/jdk.tools.jmod.JmodTask.describe(JmodTask.java:318)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at jdk.jlink/jdk.tools.jmod.JmodTask.run(JmodTask.java:207)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at jdk.jlink/jdk.tools.jmod.Main.main(Main.java:35)&lt;br/&gt;
===========================================&lt;br/&gt;
&lt;br/&gt;
The bug can be reproduced if jmod tool from JDK21 is used for jmods files from jdk20 or jdk21. The tool from JDK20 works fine with jmods files from jdk20.&lt;br/&gt;
&lt;br/&gt;
Steps to reproduce:&lt;br/&gt;
&lt;br/&gt;
JAVA_HOME=/jdk21/build/windows-x86_64-server-release/images/jdk/&lt;br/&gt;
&lt;br/&gt;
JMOD_BINARY=${JAVA_HOME}/bin/jmod.exe&lt;br/&gt;
JMOD_DIR=${JAVA_HOME}/jmods&lt;br/&gt;
TEST_JMOD=java.compiler.jmod&lt;br/&gt;
mkdir extract&lt;br/&gt;
mkdir pack&lt;br/&gt;
${JMOD_BINARY} extract ${JMOD_DIR}/${TEST_JMOD} --dir extract/${TEST_JMOD}&lt;br/&gt;
cd extract/${TEST_JMOD}&lt;br/&gt;
${JMOD_BINARY} create --target-platform -amd64 --module-version 21 --class-path classes --legal-notices legal ../../pack/java.compiler.jmod&lt;br/&gt;
cd ../../&lt;br/&gt;
${JMOD_BINARY} describe pack/java.compiler.jmod&lt;br/&gt;
&lt;br/&gt;
The last command produced this error.&lt;br/&gt;
&lt;br/&gt;
Tested on windows and linux.&lt;br/&gt;
&lt;br/&gt;
The same exception can occur if the java.base jmod file should be repacked using hash+module-path of repacked java.compiler.jmod.</description>
                <environment></environment>
        <key id="5107677">JDK-8313983</key>
            <summary>jmod create --target-platform should replace existing ModuleTarget attribute</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://bugs.openjdk.org/images/jbsImages/p3.png">P3</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="asotona">Adam Sotona</assignee>
                                    <reporter username="serb">Sergey Bylokhov</reporter>
                        <labels>
                            <label>amazon-interest</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>regression</label>
                    </labels>
                <created>Tue, 8 Aug 2023 19:33:07 -0700</created>
                <updated>Fri, 7 Jun 2024 01:00:02 -0700</updated>
                            <resolved>Fri, 1 Sep 2023 01:35:13 -0700</resolved>
                                    <version>21</version>
                                    <fixVersion>22</fixVersion>
                                    <component>tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="14679308" author="serb" created="Wed, 5 Jun 2024 12:39:37 -0700"  >Fix request (21u)&lt;br/&gt;
&lt;br/&gt;
Clean backport. The fix for a regression introduced in jdk21. No new issues were found by the tier1/tier2/tier3/tier4 tests. The fix is verified by the steps from the description.&lt;br/&gt;
Review 21u-dev: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/666&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/666&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14679304" author="roboduke" created="Wed, 5 Jun 2024 12:20:04 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/666&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/666&lt;/a&gt;&lt;br/&gt;
Date: 2024-06-04 23:39:14 +0000</comment>
                            <comment id="14608286" author="dukebot" created="Fri, 1 Sep 2023 01:35:12 -0700"  >Changeset: c2e01eba&lt;br/&gt;
Author:    Adam Sotona &amp;lt;&lt;a href=&apos;mailto:asotona@openjdk.org&apos;&gt;asotona@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-09-01 08:33:33 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/c2e01eba5a537acd573b7d2e6d41811c415c3f68&quot;&gt;https://git.openjdk.org/jdk/commit/c2e01eba5a537acd573b7d2e6d41811c415c3f68&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14608042" author="roboduke" created="Thu, 31 Aug 2023 05:17:23 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/15514&quot;&gt;https://git.openjdk.org/jdk/pull/15514&lt;/a&gt;&lt;br/&gt;
Date: 2023-08-31 12:13:40 +0000</comment>
                            <comment id="14608038" author="asotona" created="Thu, 31 Aug 2023 05:01:11 -0700"  >ModuleTargetAttribute and ModuleResolutionAttribute are both flagged as &amp;#39;allow multiple&amp;#39; in the Classfile API, probably because of lack of reference to a specification and assumption there might be more targets.&lt;br/&gt;
I&amp;#39;ll fix it.</comment>
                            <comment id="14603079" author="mchung" created="Wed, 9 Aug 2023 16:15:18 -0700"  >It works on JDK 20 but fails on JDK 21.</comment>
                            <comment id="14602787" author="alanb" created="Tue, 8 Aug 2023 19:51:16 -0700"  >I&amp;#39;ve changed the title on this issue so that it&amp;#39;s a bit clearer what this is about. When jmod create --target-platform is used then it should replace the ModuletTarget class file attribute if it exists, it shouldn&amp;#39;t add a second attribute. It maybe that changing the module-info extender from using ASM to the new ClassFile API has introduced this issue. The scenario is unusual, surprised it was noticed.</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5131300">JDK-8333773</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5084896">JDK-8294962</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i32o6z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17407"><![CDATA[b14]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="1590"><![CDATA[jlink]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>