<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 14:12:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8294902] Undefined Behavior in C2 regalloc with null references</title>
                <link>https://bugs.openjdk.org/browse/JDK-8294902</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>This is currently obscured by -Waddress warning disabled for Hotspot. If you enable this warning, then GCC would complain:&lt;br/&gt;
&lt;br/&gt;
```&lt;br/&gt;
/home/shade/trunks/jdk/src/hotspot/share/opto/postaloc.cpp: In member function &amp;#39;int PhaseChaitin::elide_copy(Node*, int, Block*, Node_List&amp;amp;, Node_List&amp;amp;, bool)&amp;#39;:&lt;br/&gt;
/home/shade/trunks/jdk/src/hotspot/share/opto/postaloc.cpp:260:14: error: the compiler can assume that the address of &amp;#39;value&amp;#39; will never be NULL [-Werror=address]&lt;br/&gt;
&amp;nbsp;&amp;nbsp;260 |   if( &amp;amp;value == NULL ) return blk_adjust;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;|              ^&lt;br/&gt;
```&lt;br/&gt;
&lt;br/&gt;
This thing is not theoretical, I played with the following snippet in Godbolt:&lt;br/&gt;
&lt;br/&gt;
```&lt;br/&gt;
#include &amp;lt;cstddef&amp;gt;&lt;br/&gt;
&lt;br/&gt;
class X {};&lt;br/&gt;
&lt;br/&gt;
bool test(X&amp;amp; ref) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return (&amp;amp;ref == NULL);&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
int main() {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return test(*((X*)NULL));&lt;br/&gt;
}&lt;br/&gt;
```&lt;br/&gt;
&lt;br/&gt;
With -O2, GCC 5.5 and lower compiles `test` to actual check, like you would expect for pointers:&lt;br/&gt;
&lt;br/&gt;
```&lt;br/&gt;
&amp;nbsp;test   rdi,rdi&lt;br/&gt;
&amp;nbsp;sete   al&lt;br/&gt;
&amp;nbsp;ret    &lt;br/&gt;
```&lt;br/&gt;
&lt;br/&gt;
With -O2, GCC 6.1 and higher compiles `test` to &amp;quot;return false&amp;quot;, as warning told it might happen:&lt;br/&gt;
&lt;br/&gt;
```&lt;br/&gt;
&amp;nbsp;xor    eax,eax&lt;br/&gt;
&amp;nbsp;ret   &lt;br/&gt;
```&lt;br/&gt;
&lt;br/&gt;
Plus, adding these asserts to Hotspot:&lt;br/&gt;
&lt;br/&gt;
```&lt;br/&gt;
diff --git a/src/hotspot/share/opto/postaloc.cpp b/src/hotspot/share/opto/postaloc.cpp&lt;br/&gt;
index 96c30a122bb..23b78305af2 100644&lt;br/&gt;
--- a/src/hotspot/share/opto/postaloc.cpp&lt;br/&gt;
+++ b/src/hotspot/share/opto/postaloc.cpp&lt;br/&gt;
@@ -536,4 +536,6 @@ void PhaseChaitin::post_allocate_copy_removal() {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// Remove copies along phi edges&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;for (uint k = 1; k &amp;lt; phi_dex; k++) {&lt;br/&gt;
+        assert(blk2value[pb-&amp;gt;_pre_order] != nullptr, &amp;quot;UB&amp;quot;);&lt;br/&gt;
+        assert(blk2regnd[pb-&amp;gt;_pre_order] != nullptr, &amp;quot;UB&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;elide_copy(block-&amp;gt;get_node(k), j, block, *blk2value[pb-&amp;gt;_pre_order], *blk2regnd[pb-&amp;gt;_pre_order], false);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
```&lt;br/&gt;
&lt;br/&gt;
Fails immediately during the build,  so we do experience nulls here.</description>
                <environment></environment>
        <key id="5084821">JDK-8294902</key>
            <summary>Undefined Behavior in C2 regalloc with null references</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://bugs.openjdk.org/images/jbsImages/p3.png">P3</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="aph">Andrew Haley</assignee>
                                    <reporter username="shade">Aleksey Shipilev</reporter>
                        <labels>
                            <label>c2</label>
                            <label>c2-regalloc</label>
                            <label>jdk17u-fix-request</label>
                            <label>jdk17u-fix-yes</label>
                            <label>oracle-triage-20</label>
                            <label>redhat-interest</label>
                    </labels>
                <created>Thu, 6 Oct 2022 05:05:55 -0700</created>
                <updated>Thu, 14 Dec 2023 00:07:34 -0800</updated>
                            <resolved>Wed, 14 Dec 2022 05:35:17 -0800</resolved>
                                    <version>8</version>
                    <version>11</version>
                    <version>17</version>
                    <version>19</version>
                    <version>20</version>
                    <version>21</version>
                                    <fixVersion>20</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="14553959" author="goetz" created="Tue, 24 Jan 2023 01:20:55 -0800"  >Fix request [17u]&lt;br/&gt;
&lt;br/&gt;
I backport this for parity with 17.0.7-oracle.&lt;br/&gt;
Medium risk, touches a row of different places. There is also a follow-up because of compiler problems.&lt;br/&gt;
I&amp;#39;ll watch what happens to that change before pushing this.&lt;br/&gt;
I had to do a simple resolve.&lt;br/&gt;
SAP nighlty testing passed.</comment>
                            <comment id="14553956" author="roboduke" created="Tue, 24 Jan 2023 01:17:57 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u-dev/pull/1106&quot;&gt;https://git.openjdk.org/jdk17u-dev/pull/1106&lt;/a&gt;&lt;br/&gt;
Date: 2023-01-24 09:10:37 +0000</comment>
                            <comment id="14545372" author="dukebot" created="Wed, 14 Dec 2022 05:35:16 -0800"  >Changeset: 0bbc4181&lt;br/&gt;
Author:    Andrew Haley &amp;lt;&lt;a href=&apos;mailto:aph@openjdk.org&apos;&gt;aph@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2022-12-14 13:32:21 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk20/commit/0bbc4181cdbccfc3a542f306ce1902cc2e9f36cb&quot;&gt;https://git.openjdk.org/jdk20/commit/0bbc4181cdbccfc3a542f306ce1902cc2e9f36cb&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14545119" author="roboduke" created="Tue, 13 Dec 2022 08:38:06 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk20/pull/26&quot;&gt;https://git.openjdk.org/jdk20/pull/26&lt;/a&gt;&lt;br/&gt;
Date: 2022-12-13 16:27:37 +0000</comment>
                            <comment id="14544736" author="kvn" created="Mon, 12 Dec 2022 13:28:38 -0800"  >testing v15:&lt;br/&gt;
&lt;a href=&quot;https://mach5.us.oracle.com/mdash/jobs/vkozlov-8294902_t1-20221212-2128-39676513&quot;&gt;https://mach5.us.oracle.com/mdash/jobs/vkozlov-8294902_t1-20221212-2128-39676513&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://mach5.us.oracle.com/mdash/jobs/vkozlov-8294902_t2-20221212-2326-39680707&quot;&gt;https://mach5.us.oracle.com/mdash/jobs/vkozlov-8294902_t2-20221212-2326-39680707&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://mach5.us.oracle.com/mdash/jobs/vkozlov-8294902_t3-20221212-2327-39680721&quot;&gt;https://mach5.us.oracle.com/mdash/jobs/vkozlov-8294902_t3-20221212-2327-39680721&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://mach5.us.oracle.com/mdash/jobs/vkozlov-8294902_t4-20221212-2327-39680742&quot;&gt;https://mach5.us.oracle.com/mdash/jobs/vkozlov-8294902_t4-20221212-2327-39680742&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://mach5.us.oracle.com/mdash/jobs/vkozlov-8294902_xcomp-20221212-2327-39680768&quot;&gt;https://mach5.us.oracle.com/mdash/jobs/vkozlov-8294902_xcomp-20221212-2327-39680768&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://mach5.us.oracle.com/mdash/jobs/vkozlov-8294902_stress-20221212-2328-39680791&quot;&gt;https://mach5.us.oracle.com/mdash/jobs/vkozlov-8294902_stress-20221212-2328-39680791&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14533425" author="roboduke" created="Mon, 31 Oct 2022 07:50:41 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/10920&quot;&gt;https://git.openjdk.org/jdk/pull/10920&lt;/a&gt;&lt;br/&gt;
Date: 2022-10-31 14:40:32 +0000</comment>
                            <comment id="14528264" author="kvn" created="Thu, 6 Oct 2022 14:31:33 -0700"  >Yes, Andrew.</comment>
                            <comment id="14528250" author="aph" created="Thu, 6 Oct 2022 13:42:54 -0700"  >This is related to one I analysed a while ago. OK if I grab it?</comment>
                            <comment id="14528183" author="rcastanedalo" created="Thu, 6 Oct 2022 05:33:14 -0700"  >ILW = undefined behavior without observable test failure; exploited by GCC 6.1 and higher; compile with earlier GCC or lower optimization level = MHM = P3</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5089722">JDK-8298805</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5090032">JDK-8299028</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5094996">JDK-8303190</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5091316">JDK-8300080</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2yt1v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17413"><![CDATA[b29]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="208"><![CDATA[compiler]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>