<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 16:41:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8302151] BMPImageReader throws an exception reading BMP images</title>
                <link>https://bugs.openjdk.org/browse/JDK-8302151</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>ADDITIONAL SYSTEM INFORMATION :&lt;br/&gt;
Windows 10, Java 19.0.2&lt;br/&gt;
&lt;br/&gt;
A DESCRIPTION OF THE PROBLEM :&lt;br/&gt;
A black and white BMP image from multiple TWAIN scanners throws this exception:&lt;br/&gt;
&lt;br/&gt;
javax.imageio.IIOException: Invalid width/height for BI_RGB image data.&lt;br/&gt;
	at java.desktop/com.sun.imageio.plugins.bmp.BMPImageReader.readHeader(BMPImageReader.java:621)&lt;br/&gt;
	at java.desktop/com.sun.imageio.plugins.bmp.BMPImageReader.read(BMPImageReader.java:859)&lt;br/&gt;
	at java.desktop/javax.imageio.ImageIO.read(ImageIO.java:1466)&lt;br/&gt;
	at java.desktop/javax.imageio.ImageIO.read(ImageIO.java:1315)&lt;br/&gt;
	at com.usdataworks.javaplay.ReadBmpFromTwainScanner.main(ReadBmpFromTwainScanner.java:14)&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
REGRESSION : Last worked in version 11&lt;br/&gt;
&lt;br/&gt;
STEPS TO FOLLOW TO REPRODUCE THE PROBLEM :&lt;br/&gt;
Run the attached source code on a bitonal (1 bit per pixel) BMP images from a TWAIN scanner.&lt;br/&gt;
I can provide an image if needed.&lt;br/&gt;
&lt;br/&gt;
EXPECTED VERSUS ACTUAL BEHAVIOR :&lt;br/&gt;
EXPECTED -&lt;br/&gt;
BMP image file is read into a BufferedImage.&lt;br/&gt;
ACTUAL -&lt;br/&gt;
This exception is thrown:&lt;br/&gt;
&lt;br/&gt;
javax.imageio.IIOException: Invalid width/height for BI_RGB image data.&lt;br/&gt;
	at java.desktop/com.sun.imageio.plugins.bmp.BMPImageReader.readHeader(BMPImageReader.java:621)&lt;br/&gt;
	at java.desktop/com.sun.imageio.plugins.bmp.BMPImageReader.read(BMPImageReader.java:859)&lt;br/&gt;
	at java.desktop/javax.imageio.ImageIO.read(ImageIO.java:1466)&lt;br/&gt;
	at java.desktop/javax.imageio.ImageIO.read(ImageIO.java:1315)&lt;br/&gt;
	at com.usdataworks.javaplay.ReadBmpFromTwainScanner.main(ReadBmpFromTwainScanner.java:14)&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
---------- BEGIN SOURCE ----------&lt;br/&gt;
package com.usdataworks.javaplay;&lt;br/&gt;
&lt;br/&gt;
import java.awt.image.BufferedImage;&lt;br/&gt;
import java.io.File;&lt;br/&gt;
import java.io.IOException;&lt;br/&gt;
&lt;br/&gt;
import javax.imageio.ImageIO;&lt;br/&gt;
&lt;br/&gt;
public class ReadBmpFromTwainScanner {&lt;br/&gt;
&lt;br/&gt;
	public static void main(String[] args) {&lt;br/&gt;
		try {&lt;br/&gt;
			File input = new File(&amp;quot;The Scanner Image 1675710585648.bmp&amp;quot;);&lt;br/&gt;
			BufferedImage theImage = ImageIO.read(input);&lt;br/&gt;
			System.out.println(&amp;quot;theImage width=&amp;quot; + theImage.getWidth() + &amp;quot; height=&amp;quot; + theImage.getHeight());&lt;br/&gt;
		} catch (IOException e) {&lt;br/&gt;
			e.printStackTrace();&lt;br/&gt;
		}&lt;br/&gt;
	}&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
---------- END SOURCE ----------&lt;br/&gt;
&lt;br/&gt;
FREQUENCY : always&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
        <key id="5093462">JDK-8302151</key>
            <summary>BMPImageReader throws an exception reading BMP images</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://bugs.openjdk.org/images/jbsImages/p3.png">P3</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jdv">Jayathirth D V</assignee>
                                    <reporter username="webbuggrp">Webbug Group</reporter>
                        <labels>
                            <label>additional-information-received</label>
                            <label>dcspn</label>
                            <label>jdk11u-fix-request</label>
                            <label>jdk11u-fix-yes</label>
                            <label>jdk17u-fix-request</label>
                            <label>jdk17u-fix-yes</label>
                            <label>regression</label>
                            <label>reproducer-yes</label>
                            <label>sn_138</label>
                            <label>webbug</label>
                    </labels>
                <created>Mon, 6 Feb 2023 11:56:32 -0800</created>
                <updated>Thu, 20 Apr 2023 01:38:07 -0700</updated>
                            <resolved>Mon, 20 Feb 2023 23:32:25 -0800</resolved>
                                    <version>8u311</version>
                    <version>11.0.13</version>
                    <version>17.0.1</version>
                    <version>18</version>
                    <version>19</version>
                    <version>20</version>
                                    <fixVersion>21</fixVersion>
                                    <component>client-libs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="14574727" author="roboduke" created="Tue, 18 Apr 2023 08:53:44 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk11u-dev/pull/1836&quot;&gt;https://git.openjdk.org/jdk11u-dev/pull/1836&lt;/a&gt;&lt;br/&gt;
Date: 2023-04-18 15:48:11 +0000</comment>
                            <comment id="14574724" author="roboduke" created="Tue, 18 Apr 2023 08:47:56 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u-dev/pull/1263&quot;&gt;https://git.openjdk.org/jdk17u-dev/pull/1263&lt;/a&gt;&lt;br/&gt;
Date: 2023-04-18 15:39:03 +0000</comment>
                            <comment id="14574709" author="goetz" created="Tue, 18 Apr 2023 08:36:50 -0700"  >Fix request [11u,17u]&lt;br/&gt;
&lt;br/&gt;
I backport this for parity with 11.0.20/17.0.8-oracle.&lt;br/&gt;
Low risk, simple fix.&lt;br/&gt;
Clean backport.&lt;br/&gt;
Test passes and fails without the fix. SAP nightly testing passed.</comment>
                            <comment id="14561563" author="dukebot" created="Mon, 20 Feb 2023 23:32:24 -0800"  >Changeset: aa10f0d3&lt;br/&gt;
Author:    Jayathirth D V &amp;lt;&lt;a href=&apos;mailto:jdv@openjdk.org&apos;&gt;jdv@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-02-21 07:30:17 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/aa10f0d3ee5d77d83950c9ed4aab11589b822ff4&quot;&gt;https://git.openjdk.org/jdk/commit/aa10f0d3ee5d77d83950c9ed4aab11589b822ff4&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14560353" author="roboduke" created="Wed, 15 Feb 2023 05:25:37 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/12573&quot;&gt;https://git.openjdk.org/jdk/pull/12573&lt;/a&gt;&lt;br/&gt;
Date: 2023-02-15 13:18:31 +0000</comment>
                            <comment id="14559439" author="jdv" created="Mon, 13 Feb 2023 02:22:12 -0800"  >FileSize from metadata is 14, which is wrong for image with width 1698 and height 2228.&lt;br/&gt;
But the check added under &lt;a href=&quot;https://github.com/openjdk/jdk/commit/c70f7cad47c9be0a203079de52ffab0ce53ba965&quot;&gt;https://github.com/openjdk/jdk/commit/c70f7cad47c9be0a203079de52ffab0ce53ba965&lt;/a&gt; will not work properly if we have color palette.&lt;br/&gt;
Its better to avoid this check when we have color palette and bpp is less than 16 (According to &lt;a href=&quot;https://learn.microsoft.com/en-us/windows/win32/api/wingdi/ns-wingdi-bitmapv4header&quot;&gt;https://learn.microsoft.com/en-us/windows/win32/api/wingdi/ns-wingdi-bitmapv4header&lt;/a&gt; it is not necessary to have color palette from 16bpp)</comment>
                            <comment id="14559133" author="pnarayanaswa" created="Fri, 10 Feb 2023 05:23:40 -0800"  >Additional information from submitter&lt;br/&gt;
============================&lt;br/&gt;
I&amp;#39;ve attached a bitonal scan of a printer test sheet. We&amp;#39;ve found this happens for any bitonal BMP image, from this or any other TWAIN scanner.&lt;br/&gt;
&lt;br/&gt;
Attached image from submitter&amp;lt;The Scanner Image 1675710585648.bmp&amp;gt;&lt;br/&gt;
More info:&lt;br/&gt;
&lt;br/&gt;
Not sure if that was in the original bug report, but the problem was introduced by this commit:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;https://github.com/openjdk/jdk/commit/c70f7cad47c9be0a203079de52ffab0ce53ba965&quot;&gt;https://github.com/openjdk/jdk/commit/c70f7cad47c9be0a203079de52ffab0ce53ba965&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14559104" author="pnarayanaswa" created="Fri, 10 Feb 2023 03:13:38 -0800"  >Mail to submitter&lt;br/&gt;
=============&lt;br/&gt;
Please share the image, to analyze the issue better.</comment>
                            <comment id="14559086" author="jdv" created="Fri, 10 Feb 2023 01:58:20 -0800"  >We need 1bpp image that customer is mentioning of getting generated from TWAIN scanner. This will give some idea about how relevant are these images to verify whether we need update our tighter checks in our BMP implementation.&lt;br/&gt;
&lt;br/&gt;
Attached flower.bmp image doesn&amp;#39;t comply with BMP specification as mentioned below:&lt;br/&gt;
FileSize = 21713&lt;br/&gt;
Width = 186&lt;br/&gt;
Height = 155&lt;br/&gt;
bitsPerPixel = 24&lt;br/&gt;
&lt;br/&gt;
From the above info we expect image data size without padding to be : (width * height * (bitsPerPixel / 8)) = 86490 bytes </comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5094887">JDK-8303107</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5094890">JDK-8303109</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5094892">JDK-8303111</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5098967">JDK-8306497</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5098988">JDK-8306517</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="102600" name="ReadBmpFromTwainScanner.java" size="456" author="pnarayanaswa" created="Thu, 9 Feb 2023 06:26:28 -0800"/>
                            <attachment id="102614" name="The Scanner Image 1675710585648.bmp" size="481374" author="pnarayanaswa" created="Fri, 10 Feb 2023 05:23:22 -0800"/>
                            <attachment id="102599" name="flower.bmp" size="86854" author="pnarayanaswa" created="Thu, 9 Feb 2023 06:26:29 -0800"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17008"><![CDATA[generic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10003" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Introduced In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17318"><![CDATA[b02]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10004" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Introduced In Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="21822">8u311</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17010"><![CDATA[generic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i309hn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17311"><![CDATA[b11]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="323"><![CDATA[javax.imageio]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>