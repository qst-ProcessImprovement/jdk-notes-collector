<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 15:24:12 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8299677] Formatter.format might take a long time to format an integer or floating-point</title>
                <link>https://bugs.openjdk.org/browse/JDK-8299677</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>ADDITIONAL SYSTEM INFORMATION :&lt;br/&gt;
Any OS (tested on Ubuntu, and MacOS) and also tested on JDK8 and JDK17&lt;br/&gt;
&lt;br/&gt;
A DESCRIPTION OF THE PROBLEM :&lt;br/&gt;
String.format takes tens of minutes to format a floating point if format specifies that it should be prepended with large number of 0. e.g. String.format(&amp;quot;%09000000d&amp;quot;, 2);&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&lt;br/&gt;
&lt;br/&gt;
STEPS TO FOLLOW TO REPRODUCE THE PROBLEM :&lt;br/&gt;
The code below took 1693 seconds  (28 minutes) to return a string with 9 millions of chars. Same happens for &amp;#39;f&amp;#39; format specifier. Time spent in format seems to increase quadric with the width of the generated string. &lt;br/&gt;
&lt;br/&gt;
String s = String.format(&amp;quot;%09000000d&amp;quot;, 2);&lt;br/&gt;
&lt;br/&gt;
However, the code below, that use &amp;#39;x&amp;#39; as specifier returns way faster&lt;br/&gt;
&lt;br/&gt;
String s = String.format(&amp;quot;%09000000x&amp;quot;, 2);&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
EXPECTED VERSUS ACTUAL BEHAVIOR :&lt;br/&gt;
EXPECTED -&lt;br/&gt;
I expect the String.format to take similar amount of time regardless of formatter. &lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
ACTUAL -&lt;br/&gt;
Returns correct result but very slow for &amp;#39;d&amp;#39; and &amp;#39;f&amp;#39; format specifier. Works as expected on for &amp;#39;x&amp;#39; format specifier&lt;br/&gt;
&lt;br/&gt;
---------- BEGIN SOURCE ----------&lt;br/&gt;
public class SystemFormat {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;public static void main(String[] args) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;long t1 = System.currentTimeMillis();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;String sd = String.format(&amp;quot;%0500000d&amp;quot;, 2);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;long t2 = System.currentTimeMillis();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;String sx = String.format(&amp;quot;%0500000x&amp;quot;, 2);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;long t3 = System.currentTimeMillis();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;long diff1 = t2 - t1;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;long diff2 = t3 - t2;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;System.out.format(&amp;quot;diff1 = %d%n&amp;quot;, diff1);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;System.out.format(&amp;quot;diff2 = %d%n&amp;quot;, diff2);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
// outputs&lt;br/&gt;
// diff1 = 5927&lt;br/&gt;
// diff2 = 10&lt;br/&gt;
---------- END SOURCE ----------&lt;br/&gt;
&lt;br/&gt;
CUSTOMER SUBMITTED WORKAROUND :&lt;br/&gt;
do not use String.format with larger specifier and prepend it with &amp;#39;0&amp;#39;. &lt;br/&gt;
&lt;br/&gt;
FREQUENCY : always&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
        <key id="5090723">JDK-8299677</key>
            <summary>Formatter.format might take a long time to format an integer or floating-point</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rgiulietti">Raffaello Giulietti</assignee>
                                    <reporter username="webbuggrp">Webbug Group</reporter>
                        <labels>
                            <label>amazon-interest</label>
                            <label>dcsaw</label>
                            <label>jdk11u-fix-request</label>
                            <label>jdk11u-fix-yes</label>
                            <label>jdk17u-fix-request</label>
                            <label>jdk17u-fix-yes</label>
                            <label>jdk8u-fix-request</label>
                            <label>jdk8u-fix-yes</label>
                            <label>reproducer-yes</label>
                            <label>webbug</label>
                    </labels>
                <created>Wed, 4 Jan 2023 15:12:32 -0800</created>
                <updated>Thu, 26 Jun 2025 14:22:29 -0700</updated>
                            <resolved>Mon, 26 Feb 2024 14:36:44 -0800</resolved>
                                    <version>8</version>
                    <version>11</version>
                    <version>17</version>
                    <version>19</version>
                    <version>20</version>
                                    <fixVersion>21</fixVersion>
                                    <component>core-libs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>10</watches>
                                                                                                                <comments>
                            <comment id="14662866" author="roboduke" created="Thu, 4 Apr 2024 05:40:59 -0700"  >[jdk11u-fix-request] Approval Request from Paul Hohensee&lt;br/&gt;
Simple clean (net of copyright date) backport from JDK 17 (in 17.0.10) of a potential DOS attack vector fix. New test passes.</comment>
                            <comment id="14662625" author="roboduke" created="Wed, 3 Apr 2024 09:57:59 -0700"  >[jdk8u-fix-request] Approval Request from Chad Rakoczy&lt;br/&gt;
Backport for fix that improves String.format for large number of zero padding. Backport was not clean since String.repeat and ParameterizedTest are not in JDK8. Users ran into issues with other versions so would like to backport for completeness. Change is simple but medium risk as it touches String.format code</comment>
                            <comment id="14652365" author="JIRAUSER20915" created="Mon, 26 Feb 2024 14:07:00 -0800"  >Fix Request (8u)&lt;br/&gt;
&lt;br/&gt;
Backport was not clean. Rewrote test to not include junit ParameterizedTest. Rewrote fix since String.repeat is not in JDK8</comment>
                            <comment id="14652364" author="roboduke" created="Mon, 26 Feb 2024 13:58:37 -0800"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk8u-dev/pull/459&quot;&gt;https://git.openjdk.org/jdk8u-dev/pull/459&lt;/a&gt;&lt;br/&gt;
Date: 2024-02-26 21:54:16 +0000</comment>
                            <comment id="14609246" author="phh" created="Wed, 6 Sep 2023 08:32:23 -0700"  >Fix Request (11u).&lt;br/&gt;
&lt;br/&gt;
Clean backport from 17u of a potential DOS attack vector fix.</comment>
                            <comment id="14609222" author="phh" created="Wed, 6 Sep 2023 07:54:49 -0700"  >Fix Request (17u).&lt;br/&gt;
&lt;br/&gt;
Simple almost clean backport of a potential DOS attack vector fix, has been running in production at Amazon for over a year, low risk.&lt;br/&gt;
</comment>
                            <comment id="14551772" author="roboduke" created="Tue, 17 Jan 2023 11:03:53 -0800"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk11u-dev/pull/1667&quot;&gt;https://git.openjdk.org/jdk11u-dev/pull/1667&lt;/a&gt;&lt;br/&gt;
Date: 2023-01-17 18:17:08 +0000</comment>
                            <comment id="14551715" author="roboduke" created="Tue, 17 Jan 2023 09:22:10 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u-dev/pull/1077&quot;&gt;https://git.openjdk.org/jdk17u-dev/pull/1077&lt;/a&gt;&lt;br/&gt;
Date: 2023-01-17 17:11:04 +0000</comment>
                            <comment id="14550828" author="dukebot" created="Thu, 12 Jan 2023 11:24:21 -0800"  >Changeset: 33412c10&lt;br/&gt;
Author:    Raffaello Giulietti &amp;lt;&lt;a href=&apos;mailto:rgiulietti@openjdk.org&apos;&gt;rgiulietti@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-01-12 19:21:09 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/33412c102ce799ff2de3512df77e6e07d76acd36&quot;&gt;https://git.openjdk.org/jdk/commit/33412c102ce799ff2de3512df77e6e07d76acd36&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14550287" author="roboduke" created="Wed, 11 Jan 2023 02:55:01 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/11939&quot;&gt;https://git.openjdk.org/jdk/pull/11939&lt;/a&gt;&lt;br/&gt;
Date: 2023-01-11 10:47:03 +0000</comment>
                            <comment id="14549621" author="JIRAUSER19600" created="Mon, 9 Jan 2023 09:24:10 -0800"  >I can confirm the observations of the reporter.</comment>
                            <comment id="14548977" author="tongwan" created="Thu, 5 Jan 2023 07:23:44 -0800"  >The observations on Windows 10:&lt;br/&gt;
JDK 8: Failed, very slow for &amp;#39;d&amp;#39; format&lt;br/&gt;
JDK 11: Failed.&lt;br/&gt;
JDK 17: Failed.&lt;br/&gt;
JDK 19: Failed.&lt;br/&gt;
JDK 20ea+23: Failed.&lt;br/&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5109834">JDK-8315858</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5126240">JDK-8329716</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5133719">JDK-8335924</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5162943">JDK-8360768</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5106869">JDK-8313307</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5122480">JDK-8326718</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="102210" name="Main.java" size="488" author="tongwan" created="Thu, 5 Jan 2023 07:18:07 -0800"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17008"><![CDATA[generic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17010"><![CDATA[generic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2zsl7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17334"><![CDATA[b06]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="216"><![CDATA[java.util]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10100" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Verification</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17000"><![CDATA[Verified]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>