<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 13:47:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8272288] Funky multiresolution image breaks graphics context</title>
                <link>https://bugs.openjdk.org/browse/JDK-8272288</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>I discovered this problem when a system service returned a 2x image with user size 28.0 x 0.5. I created a multiresolution image to preserve the extra resolution, but (erroneously) gave it a size of 28 x 0. Prior to JDK 16, this erroneous image was rejected when painted (see below). However, in JDK 16 and 17, there is no exception. Instead, the graphics context is apparently damaged. In this example, the label text is not painted. In other examples, it seems to have cleared the rendering buffer.&lt;br/&gt;
&lt;br/&gt;
(Actually, I believe the exception is thrown but is caught internally, at which point different drawing code is used.)&lt;br/&gt;
&lt;br/&gt;
The exception from JDK 15:&lt;br/&gt;
&lt;br/&gt;
Exception in thread &amp;quot;AWT-EventQueue-0&amp;quot; java.lang.IllegalArgumentException: Invalid Image variant&lt;br/&gt;
	at java.desktop/sun.awt.image.SurfaceManager.getManager(SurfaceManager.java:82)&lt;br/&gt;
	at java.desktop/sun.java2d.SurfaceData.getSourceSurfaceData(SurfaceData.java:219)&lt;br/&gt;
	at java.desktop/sun.java2d.opengl.OGLDrawImage.renderImageXform(OGLDrawImage.java:62)&lt;br/&gt;
	at java.desktop/sun.java2d.pipe.DrawImage.transformImage(DrawImage.java:264)&lt;br/&gt;
	at java.desktop/sun.java2d.pipe.DrawImage.copyImage(DrawImage.java:76)&lt;br/&gt;
	at java.desktop/sun.java2d.pipe.DrawImage.copyImage(DrawImage.java:1027)&lt;br/&gt;
	at java.desktop/sun.java2d.pipe.ValidatePipe.copyImage(ValidatePipe.java:186)&lt;br/&gt;
	at java.desktop/sun.java2d.SunGraphics2D.drawImage(SunGraphics2D.java:3425)&lt;br/&gt;
	at java.desktop/sun.java2d.SunGraphics2D.drawImage(SunGraphics2D.java:3401)&lt;br/&gt;
</description>
                <environment></environment>
        <key id="5056429">JDK-8272288</key>
            <summary>Funky multiresolution image breaks graphics context</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="serb">Sergey Bylokhov</assignee>
                                    <reporter username="alans">Alan Snyder</reporter>
                        <labels>
                    </labels>
                <created>Tue, 10 Aug 2021 10:53:19 -0700</created>
                <updated>Wed, 15 Feb 2023 23:17:48 -0800</updated>
                            <resolved>Thu, 9 Feb 2023 11:24:45 -0800</resolved>
                                    <version>16</version>
                    <version>17</version>
                                    <fixVersion>21</fixVersion>
                                    <component>client-libs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14558933" author="dukebot" created="Thu, 9 Feb 2023 11:24:44 -0800"  >Changeset: 51479692&lt;br/&gt;
Author:    Sergey Bylokhov &amp;lt;&lt;a href=&apos;mailto:serb@openjdk.org&apos;&gt;serb@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-02-09 19:22:51 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/5147969253a9792d883fdd505a62b959c5541566&quot;&gt;https://git.openjdk.org/jdk/commit/5147969253a9792d883fdd505a62b959c5541566&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14547957" author="roboduke" created="Thu, 29 Dec 2022 22:30:24 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/11664&quot;&gt;https://git.openjdk.org/jdk/pull/11664&lt;/a&gt;&lt;br/&gt;
Date: 2022-12-14 08:20:31 +0000</comment>
                            <comment id="14547951" author="alans" created="Thu, 29 Dec 2022 14:11:51 -0800"  >I don&amp;#39;t know. Unfortunately, I cannot force the system into this state and it has not happened recently.</comment>
                            <comment id="14547950" author="serb" created="Thu, 29 Dec 2022 14:05:58 -0800"  >&amp;gt;  If Java renders on demand, then either the request was not made or the rendering somehow failed and was not retried. &lt;br/&gt;
&lt;br/&gt;
Then yes, it is possible. Is there any difference between OpenGL and metal?</comment>
                            <comment id="14547810" author="alans" created="Mon, 26 Dec 2022 08:37:40 -0800"  >The menus I was referring to are contextual menus.&lt;br/&gt;
If Java renders on demand, then either the request was not made or the rendering somehow failed and was not retried.&lt;br/&gt;
I do not see this behavior from non-Java applications.&lt;br/&gt;
</comment>
                            <comment id="14546763" author="serb" created="Tue, 20 Dec 2022 01:03:18 -0800"  >If the &amp;quot;blank menus&amp;quot; are actually global menus, then I think it is related to the macOS slowdown, since java does not render them.&lt;br/&gt;
Note that java does not render directly to the window, it uses the back buffer similar to a volatile image, and copies it to the window when macOS requests it to do so.</comment>
                            <comment id="14545539" author="alans" created="Wed, 14 Dec 2022 14:12:14 -0800"  >I&amp;#39;m wondering if the contentLost issue explains another problem. I have observed that when my macOS system is severely bogged down, Java applications are prone to reliably display blank windows (including blank menus). I don&amp;#39;t know if Java is getting an error in this case. It could also be a timing problem if Java expects the creation of a native window to happen quickly and does not check to see if it was actually created before doing the initial painting of the window content.</comment>
                            <comment id="14545259" author="serb" created="Tue, 13 Dec 2022 22:38:56 -0800"  >All accelerated pipelines except D3D do not set contentLost flag if some errors occurred during rendering. As a result, the Swing library do not try to use a fallback path for that and nothing appeared on the screen.</comment>
                            <comment id="14545227" author="serb" created="Tue, 13 Dec 2022 15:54:03 -0800"  >The problem is in the OGL, on windows the test works fine for GDI and d3d.</comment>
                            <comment id="14497422" author="serb" created="Fri, 20 May 2022 11:07:50 -0700"  >I&amp;#39;ll take a look.</comment>
                            <comment id="14497207" author="vdyakov" created="Thu, 19 May 2022 12:11:24 -0700"  >[~serb] please share your plans (see above)&lt;br/&gt;
</comment>
                            <comment id="14497184" author="prr" created="Thu, 19 May 2022 10:47:59 -0700"  >Do you still intend to look at this ? If not assign it back to me.</comment>
                            <comment id="14446847" author="serb" created="Sat, 11 Sep 2021 18:22:12 -0700"  >I can take a look to this one.</comment>
                            <comment id="14446846" author="serb" created="Sat, 11 Sep 2021 18:13:39 -0700"  >When the text works the OGLTextRenderer is used, when the bug is occurred the AATextRenderer is used. Looks like the SG2D object invalidation/validation logic is buggy.</comment>
                            <comment id="14446845" author="serb" created="Sat, 11 Sep 2021 17:13:46 -0700"  >It is not particularly related to the MRI, the test use the custom image as a base image. Since the resolution size is zero we skip it and try to draw the base image instead, our default java2d pipeline do not know how to draw such images so it is just ignored(related drawImage return false)&lt;br/&gt;
&lt;a href=&quot;https://bugs.openjdk.java.net/browse/JDK-7183828&quot;&gt;https://bugs.openjdk.java.net/browse/JDK-7183828&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Why the text is not drawn after is a good question.</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5093778">JDK-8302169</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="95971" name="TestFunkyImage.java" size="2196" author="alans" created="Tue, 10 Aug 2021 10:52:21 -0700"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_10004" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Introduced In Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="20800">16</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17010"><![CDATA[generic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2tzx7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17338"><![CDATA[b10]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="197"><![CDATA[2d]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>