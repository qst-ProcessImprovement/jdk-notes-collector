<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 16:19:12 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8301402] os::print_location gets is_global_handle assert</title>
                <link>https://bugs.openjdk.org/browse/JDK-8301402</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>The os::print_location() code is trying to figure out what the data is and gets an assert&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;error_msg=error_msg@entry=0x1532167670d0 &amp;quot;assert(!is_global_tagged(handle) || is_storage_handle(global_handles(), global_ptr(handle))) failed&amp;quot;, detail_fmt=detail_fmt@entry=0x15321667c15f &amp;quot;invalid storage&amp;quot;)&lt;br/&gt;
&lt;br/&gt;
It should just return false for this case and not get a secondary assert.&lt;br/&gt;
&lt;br/&gt;
#12 0x0000153215b6a713 in JNIHandles::is_global_handle (handle=handle@entry=0x1532166997aa)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at src/hotspot/share/runtime/jniHandles.cpp:245&lt;br/&gt;
#13 0x00001532160b6388 in os::print_location (st=st@entry=0x153193ffc310, x=23304868566954, verbose=verbose@entry=false)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at src/hotspot/share/runtime/os.cpp:1155&lt;br/&gt;
#14 0x00001532160cead2 in os::print_register_info (st=0x153193ffc310, context=0x153216c204e0 &amp;lt;g_stored_assertion_context&amp;gt;)&lt;br/&gt;
--Type &amp;lt;RET&amp;gt; for more, q to quit, c to continue without paging--&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at src/hotspot/os_cpu/linux_x86/os_linux_x86.cpp:595&lt;br/&gt;
#15 0x000015321651ce4b in VMError::report (st=st@entry=0x153193ffc310, _verbose=_verbose@entry=true)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at src/hotspot/share/utilities/vmError.cpp:867&lt;br/&gt;
&lt;br/&gt;
Or ask a safer question.</description>
                <environment></environment>
        <key id="5092870">JDK-8301402</key>
            <summary>os::print_location gets is_global_handle assert</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="aboldtch">Axel Boldt-Christmas</assignee>
                                    <reporter username="coleenp">Coleen Phillimore</reporter>
                        <labels>
                            <label>os</label>
                    </labels>
                <created>Mon, 30 Jan 2023 14:43:23 -0800</created>
                <updated>Mon, 6 Feb 2023 10:42:27 -0800</updated>
                            <resolved>Wed, 1 Feb 2023 01:49:35 -0800</resolved>
                                    <version>21</version>
                                    <fixVersion>21</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14556466" author="dukebot" created="Wed, 1 Feb 2023 01:49:34 -0800"  >Changeset: ef0d0a70&lt;br/&gt;
Author:    Axel Boldt-Christmas &amp;lt;&lt;a href=&apos;mailto:aboldtch@openjdk.org&apos;&gt;aboldtch@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-02-01 09:47:15 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/ef0d0a7092df7b3ce098fb25860fb839fd34c944&quot;&gt;https://git.openjdk.org/jdk/commit/ef0d0a7092df7b3ce098fb25860fb839fd34c944&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14555995" author="roboduke" created="Tue, 31 Jan 2023 01:35:12 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/12312&quot;&gt;https://git.openjdk.org/jdk/pull/12312&lt;/a&gt;&lt;br/&gt;
Date: 2023-01-31 09:27:50 +0000</comment>
                            <comment id="14555979" author="JIRAUSER20303" created="Tue, 31 Jan 2023 01:02:48 -0800"  >Problem is that JNIHandles::is_[weak_]global_handle assumes that the jobject handle is a valid handle. I restricted this because we now tagged up all different handle types. But I did not think of the print_location code which sends in none handles.&lt;br/&gt;
&lt;br/&gt;
Either revert the handle check to always checking storage and ignore the tags. Or add another is_*_handle method which takes an void*/address and makes no assumptions, just checks the underlying storage, which can be used by print_location.&lt;br/&gt;
&lt;br/&gt;
Looking at this JNIHandles::is_weak_global_handle seems more fragile as when it gets called from checked_jni_DeleteWeakGlobalRef we do not validate the storage at all. While for checked_jni_DeleteGlobalRef (which uses JNIHandles::is_global_handle) is validated with jniCheck::validate_object.&lt;br/&gt;
&lt;br/&gt;
So maybe just always checking the storage is the proper solution even if we have contexts where just checking the tag is valid.</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5090094">JDK-8299089</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i305ub:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17337"><![CDATA[b08]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="192"><![CDATA[runtime]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>