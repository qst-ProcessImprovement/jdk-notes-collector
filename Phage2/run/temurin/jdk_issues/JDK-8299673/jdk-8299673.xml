<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 15:24:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8299673] Simplify object pinning interactions with string deduplication</title>
                <link>https://bugs.openjdk.org/browse/JDK-8299673</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>When raw char* String contents are exposed to JNI code, we&lt;br/&gt;
&lt;br/&gt;
1. Load the string.value and pin it&lt;br/&gt;
2. Run native code&lt;br/&gt;
3. Load the string.value and unpin it&lt;br/&gt;
&lt;br/&gt;
Given this sequence we would be in trouble if between 1 and 3, string deduplication changed the value object. Then the pinning and unpinning wouldn&amp;#39;t be balanced.&lt;br/&gt;
&lt;br/&gt;
The current approach for dealing with this is to have a bunch of code to guard against deduplication. An alternative simpler solution is to just change step 3 to pass in the same value. We already have enough information available to do that. Then the pinning and unpinning is also balanced, and we don&amp;#39;t need to have any special interactions with string deduplication and can decouple these orthogonal concerns.</description>
                <environment></environment>
        <key id="5090771">JDK-8299673</key>
            <summary>Simplify object pinning interactions with string deduplication</summary>
                <type id="7" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14707&amp;avatarType=issuetype">Enhancement</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="eosterlund">Erik &#214;sterlund</assignee>
                                    <reporter username="eosterlund">Erik &#214;sterlund</reporter>
                        <labels>
                    </labels>
                <created>Thu, 5 Jan 2023 05:55:15 -0800</created>
                <updated>Mon, 23 Jan 2023 15:42:01 -0800</updated>
                            <resolved>Tue, 17 Jan 2023 00:02:22 -0800</resolved>
                                    <version>21</version>
                                    <fixVersion>21</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14553401" author="eosterlund" created="Mon, 23 Jan 2023 01:00:34 -0800"  >&lt;a href=&quot;https://github.com/openjdk/jdk/pull/12089&quot;&gt;https://github.com/openjdk/jdk/pull/12089&lt;/a&gt;</comment>
                            <comment id="14552624" author="eosterlund" created="Wed, 18 Jan 2023 23:38:24 -0800"  >Sounds fair.</comment>
                            <comment id="14552364" author="mbaesken" created="Wed, 18 Jan 2023 04:58:08 -0800"  >Hi [~eosterlund] , thanks for clarifying. So I guess you will make a follow up and change or remove the test, correct?</comment>
                            <comment id="14552361" author="eosterlund" created="Wed, 18 Jan 2023 04:50:16 -0800"  >[~mbaesken] yes that sounds very related indeed. Sorry - I did not see this test. The test seems to check that deduplication should have been prevented because it would be unsafe with the previous mechanism. The point of the new mechanism is to just make it safe instead, which kind of removes the point of this test. So I suppose I should have removed this test; it no longer makes sense.</comment>
                            <comment id="14552316" author="mbaesken" created="Wed, 18 Jan 2023 03:36:29 -0800"  >We started this night seeing failures in the test  gc/shenandoah/jni/TestStringCriticalWithDedup.java#id0 .&lt;br/&gt;
java.lang.RuntimeException: String value should be pinned&lt;br/&gt;
	at TestStringCriticalWithDedup.test(TestStringCriticalWithDedup.java:132)&lt;br/&gt;
	at TestStringCriticalWithDedup.main(TestStringCriticalWithDedup.java:88)&lt;br/&gt;
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)&lt;br/&gt;
	at java.base/java.lang.reflect.Method.invoke(Method.java:578)&lt;br/&gt;
	at com.sun.javatest.regtest.agent.MainWrapper$MainThread.run(MainWrapper.java:125)&lt;br/&gt;
	at java.base/java.lang.Thread.run(Thread.java:1623)&lt;br/&gt;
Is this related ?</comment>
                            <comment id="14551565" author="dukebot" created="Tue, 17 Jan 2023 00:02:21 -0800"  >Changeset: 9a36f8aa&lt;br/&gt;
Author:    Erik &amp;#xD6;sterlund &amp;lt;&lt;a href=&apos;mailto:eosterlund@openjdk.org&apos;&gt;eosterlund@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-01-17 08:00:56 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/9a36f8aadb08f8ade578530c70d9abe38f1826c6&quot;&gt;https://git.openjdk.org/jdk/commit/9a36f8aadb08f8ade578530c70d9abe38f1826c6&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14549852" author="roboduke" created="Tue, 10 Jan 2023 02:13:08 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/11923&quot;&gt;https://git.openjdk.org/jdk/pull/11923&lt;/a&gt;&lt;br/&gt;
Date: 2023-01-10 10:04:48 +0000</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2zsvv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17334"><![CDATA[b06]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="209"><![CDATA[gc]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>