<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 14:25:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8297302] gtest/AsyncLogGtest.java fails AsyncLogTest.stdoutOutput_vm</title>
                <link>https://bugs.openjdk.org/browse/JDK-8297302</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>The following test failed in the JDK20 CI:&lt;br/&gt;
&lt;br/&gt;
gtest/AsyncLogGtest.java&lt;br/&gt;
&lt;br/&gt;
Here&amp;#39;s a log file snippet:&lt;br/&gt;
&lt;br/&gt;
#section:main&lt;br/&gt;
----------messages:(8/384)----------&lt;br/&gt;
command: main GTestWrapper --gtest_filter=AsyncLogTest* -Xlog:async&lt;br/&gt;
reason: User specified action: run main/native GTestWrapper --gtest_filter=AsyncLogTest* -Xlog:async &lt;br/&gt;
started: Sun Nov 20 00:21:58 UTC 2022&lt;br/&gt;
Mode: agentvm&lt;br/&gt;
Agent id: 9&lt;br/&gt;
Additional exports to unnamed modules from @modules: java.base/jdk.internal.misc&lt;br/&gt;
finished: Sun Nov 20 00:21:59 UTC 2022&lt;br/&gt;
elapsed time (seconds): 0.901&lt;br/&gt;
----------configuration:(15/1896)----------&lt;br/&gt;
&lt;br/&gt;
&amp;lt;snip&amp;gt;&lt;br/&gt;
&lt;br/&gt;
----------System.out:(48/2406)----------&lt;br/&gt;
Command line: [/opt/mach5/mesos/work_dir/jib-master/install/jdk-20+25-1855/linux-x64-open.test/hotspot/gtest/server/gtestLauncher -jdk /opt/mach5/mesos/work_dir/jib-master/install/jdk-20+25-1855/linux-x64-open.jdk/jdk-20 --gtest_output=xml:test_result.xml --gtest_catch_exceptions=0 --gtest_filter=AsyncLogTest* -Xlog:async]&lt;br/&gt;
[2022-11-20T00:21:58.948021094Z] Gathering output for process 2105500&lt;br/&gt;
[2022-11-20T00:21:59.027231203Z] Waiting for completion for process 2105500&lt;br/&gt;
[2022-11-20T00:21:59.028549366Z] Waiting for completion finished for process 2105500&lt;br/&gt;
Output and diagnostic info for process 2105500 was saved into &amp;#39;pid-2105500-output.log&amp;#39;&lt;br/&gt;
Note: Google Test filter = AsyncLogTest*&lt;br/&gt;
[==========] Running 6 tests from 1 test case.&lt;br/&gt;
[----------] Global test environment set-up.&lt;br/&gt;
[----------] 6 tests from AsyncLogTest&lt;br/&gt;
[ RUN      ] AsyncLogTest.asynclog_vm&lt;br/&gt;
[0.078s][warning][logging] 1Warning&lt;br/&gt;
[0.078s][error  ][logging] 1Error&lt;br/&gt;
[       OK ] AsyncLogTest.asynclog_vm (2 ms)&lt;br/&gt;
[ RUN      ] AsyncLogTest.logMessage_vm&lt;br/&gt;
[       OK ] AsyncLogTest.logMessage_vm (1 ms)&lt;br/&gt;
[ RUN      ] AsyncLogTest.logBuffer_vm&lt;br/&gt;
[       OK ] AsyncLogTest.logBuffer_vm (0 ms)&lt;br/&gt;
[ RUN      ] AsyncLogTest.droppingMessage_vm&lt;br/&gt;
[       OK ] AsyncLogTest.droppingMessage_vm (1 ms)&lt;br/&gt;
[ RUN      ] AsyncLogTest.stdoutOutput_vm&lt;br/&gt;
open/test/hotspot/gtest/logging/test_asynclog.cpp:268: Failure&lt;br/&gt;
Value of: file_contains_substring(TestLogFileName, &amp;quot;LogStreamWithAsyncLogImpl&amp;quot;)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;Actual: false&lt;br/&gt;
Expected: true&lt;br/&gt;
open/test/hotspot/gtest/logging/test_asynclog.cpp:269: Failure&lt;br/&gt;
Value of: file_contains_substring(TestLogFileName, &amp;quot;logStream msg1-msg2-msg3&amp;quot;)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;Actual: false&lt;br/&gt;
Expected: true&lt;br/&gt;
open/test/hotspot/gtest/logging/test_asynclog.cpp:270: Failure&lt;br/&gt;
Value of: file_contains_substring(TestLogFileName, &amp;quot;logStream newline&amp;quot;)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;Actual: false&lt;br/&gt;
Expected: true&lt;br/&gt;
[  FAILED  ] AsyncLogTest.stdoutOutput_vm (1 ms)&lt;br/&gt;
[ RUN      ] AsyncLogTest.stderrOutput_vm&lt;br/&gt;
[       OK ] AsyncLogTest.stderrOutput_vm (1 ms)&lt;br/&gt;
[----------] 6 tests from AsyncLogTest (83 ms total)&lt;br/&gt;
&lt;br/&gt;
[----------] Global test environment tear-down&lt;br/&gt;
[==========] 6 tests from 1 test case ran. (83 ms total)&lt;br/&gt;
[  PASSED  ] 5 tests.&lt;br/&gt;
[  FAILED  ] 1 test, listed below:&lt;br/&gt;
[  FAILED  ] AsyncLogTest.stdoutOutput_vm&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;1 FAILED TEST&lt;br/&gt;
ERROR: RUN_ALL_TESTS() failed. Error 1&lt;br/&gt;
&lt;br/&gt;
[2022-11-20T00:21:59.033912868Z] Waiting for completion for process 2105500&lt;br/&gt;
[2022-11-20T00:21:59.034670902Z] Waiting for completion finished for process 2105500&lt;br/&gt;
----------System.err:(10/646)----------&lt;br/&gt;
java.lang.AssertionError: gtest execution failed; exit code = 2. the failed tests: [AsyncLogTest::stdoutOutput_vm, AsyncLogTest::stdoutOutput_vm, AsyncLogTest::stdoutOutput_vm]&lt;br/&gt;
	at GTestWrapper.main(GTestWrapper.java:98)&lt;br/&gt;
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)&lt;br/&gt;
	at java.base/java.lang.reflect.Method.invoke(Method.java:578)&lt;br/&gt;
	at com.sun.javatest.regtest.agent.MainActionHelper$AgentVMRunnable.run(MainActionHelper.java:312)&lt;br/&gt;
	at java.base/java.lang.Thread.run(Thread.java:1591)&lt;br/&gt;
&lt;br/&gt;
JavaTest Message: Test threw exception: java.lang.AssertionError</description>
                <environment></environment>
        <key id="5087922">JDK-8297302</key>
            <summary>gtest/AsyncLogGtest.java fails AsyncLogTest.stdoutOutput_vm</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="xliu">Xin Liu</assignee>
                                    <reporter username="dcubed">Daniel Daugherty</reporter>
                        <labels>
                            <label>amazon-interest</label>
                            <label>intermittent</label>
                            <label>jdk17u-fix-request</label>
                            <label>logging</label>
                            <label>tier6</label>
                            <label>tier8</label>
                    </labels>
                <created>Sat, 19 Nov 2022 20:20:45 -0800</created>
                <updated>Mon, 29 Sep 2025 10:54:20 -0700</updated>
                            <resolved>Thu, 20 Apr 2023 10:03:38 -0700</resolved>
                                    <version>17</version>
                    <version>20</version>
                    <version>21</version>
                                    <fixVersion>21</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="14820790" author="roboduke" created="Fri, 26 Sep 2025 11:51:13 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u-dev/pull/3996&quot;&gt;https://git.openjdk.org/jdk17u-dev/pull/3996&lt;/a&gt;&lt;br/&gt;
Date: 2025-09-26 18:41:57 +0000</comment>
                            <comment id="14820786" author="roboduke" created="Fri, 26 Sep 2025 11:46:13 -0700"  >[jdk17u-fix-request] Approval Request from Elif Aslan&lt;br/&gt;
to resolve intermittent failures gtest/AsyncLogGtest.java test. Clean backport&lt;br/&gt;
Tested with GHA and Tier 1 test run locally. Test changes. Low risk</comment>
                            <comment id="14575470" author="dukebot" created="Thu, 20 Apr 2023 10:03:37 -0700"  >Changeset: 9412c0a2&lt;br/&gt;
Author:    Xin Liu &amp;lt;&lt;a href=&apos;mailto:xliu@openjdk.org&apos;&gt;xliu@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-04-20 17:02:53 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/9412c0a2caf7d1c279f933e1f767eb3689a2a1ca&quot;&gt;https://git.openjdk.org/jdk/commit/9412c0a2caf7d1c279f933e1f767eb3689a2a1ca&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14574972" author="roboduke" created="Tue, 18 Apr 2023 23:39:51 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/13524&quot;&gt;https://git.openjdk.org/jdk/pull/13524&lt;/a&gt;&lt;br/&gt;
Date: 2023-04-19 06:32:51 +0000</comment>
                            <comment id="14574934" author="xliu" created="Tue, 18 Apr 2023 18:13:13 -0700"  >We get stdout content captured by gtest. testing::internal::GetCapturedStdout() and then write it back to a file. The same process applies to stderr. &lt;br/&gt;
I need to look into gtest and see if it guarantee the full contents of stdout/err.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</comment>
                            <comment id="14560837" author="xliu" created="Thu, 16 Feb 2023 14:40:36 -0800"  >Thanks for the lead. I will check the theory you proposed. </comment>
                            <comment id="14560836" author="xliu" created="Thu, 16 Feb 2023 14:39:27 -0800"  >investigating. </comment>
                            <comment id="14560518" author="dholmes" created="Wed, 15 Feb 2023 16:40:02 -0800"  >These failures are very rare. We have seen only 4 cases since November. One on linux-x64, one on macos-x64 and the two most recent on linux-aarch64.&lt;br/&gt;
&lt;br/&gt;
I would have to guess this is a glitch with file flushing.</comment>
                            <comment id="14560511" author="xliu" created="Wed, 15 Feb 2023 14:55:59 -0800"  >all failures are in AsyncLogTest.stdoutOutput_vm  and AsyncLogTest.stderrOutput_vm ?&lt;br/&gt;
How intermittent do you see these failures? </comment>
                            <comment id="14560468" author="xliu" created="Wed, 15 Feb 2023 10:45:00 -0800"  >I will investigate this crash.  feel free to assign this to me. &lt;br/&gt;
Afshin Zafari do you have any lead? &lt;br/&gt;
&amp;nbsp;</comment>
                            <comment id="14560456" author="xliu" created="Wed, 15 Feb 2023 09:48:51 -0800"  >only &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8292989&quot; title=&quot;Avoid dynamic memory in AsyncLogWriter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8292989&quot;&gt;&lt;strike&gt;JDK-8292989&lt;/strike&gt;&lt;/a&gt; is introduced in jdk20. &lt;br/&gt;
</comment>
                            <comment id="14545502" author="JIRAUSER20009" created="Wed, 14 Dec 2022 11:54:02 -0800"  >It&amp;#39;s also AsyncLogTest.stderrOutput_vm and always run with Xlog:async.</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5102059">JDK-8309067</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="19000"><![CDATA[x86_64]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17023"><![CDATA[linux]]></customfieldvalue>
    <customfieldvalue key="17017"><![CDATA[os_x]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2zblv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17351"><![CDATA[b20]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="192"><![CDATA[runtime]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>