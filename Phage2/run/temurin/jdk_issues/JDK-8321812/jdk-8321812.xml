<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 11:55:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8321812] Update GC tests to use execute[Limited]TestJava</title>
                <link>https://bugs.openjdk.org/browse/JDK-8321812</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>A lot of our tests use a multi-step recipe to spawn and wait for a process. Here&amp;#39;s an example&lt;br/&gt;
```&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ProcessBuilder pb = ProcessTools.createTestJavaProcessBuilder(&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;-XX:-UseTLAB&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;-XX:+UnlockDiagnosticVMOptions&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;-XX:+VerifyDuringStartup&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;-Xlog:gc+verify=debug&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;-version&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;OutputAnalyzer output = new OutputAnalyzer(pb.start());&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;... do something with output and wait for the process to complete ...&lt;br/&gt;
```&lt;br/&gt;
&lt;br/&gt;
These are the steps involved:&lt;br/&gt;
&lt;br/&gt;
1) Create a `ProcessBuilder`&lt;br/&gt;
2) Call `ProcessBuilder::start`&lt;br/&gt;
3) Create an `OutputAnalyzer`&lt;br/&gt;
4) Perform an operation that finally waits for the process to, at least partially, complete (OutputAnalyzer::getOutput, OutputAnalyzer::shouldHaveExitValue(), and more).&lt;br/&gt;
&lt;br/&gt;
Almost all our tests could be converted to use a single call to `ProcessTools.executeTestJava` (or `executeLimitedTestJava`), which spawns the process, makes sure that it has fully completed, and then returns a filled-in OutputAnalyzer to the caller. The above example would become:&lt;br/&gt;
&lt;br/&gt;
```&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;OutputAnalyzer output = ProcessTools.executeTestJava(&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;-XX:-UseTLAB&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;-XX:+UnlockDiagnosticVMOptions&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;-XX:+VerifyDuringStartup&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;-Xlog:gc+verify=debug&amp;quot;,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;-version&amp;quot;);&lt;br/&gt;
```&lt;br/&gt;
&lt;br/&gt;
I propose that we make this change in the GC tests, to make our code simpler and hopefully easier to read.</description>
                <environment></environment>
        <key id="5116710">JDK-8321812</key>
            <summary>Update GC tests to use execute[Limited]TestJava</summary>
                <type id="7" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14707&amp;avatarType=issuetype">Enhancement</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stefank">Stefan Karlsson</assignee>
                                    <reporter username="stefank">Stefan Karlsson</reporter>
                        <labels>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>noreg-self</label>
                    </labels>
                <created>Mon, 11 Dec 2023 11:20:32 -0800</created>
                <updated>Thu, 10 Oct 2024 23:59:37 -0700</updated>
                            <resolved>Fri, 5 Jan 2024 01:13:22 -0800</resolved>
                                    <version>23</version>
                                    <fixVersion>23</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14712116" author="stefank" created="Thu, 10 Oct 2024 23:59:37 -0700"  >&amp;gt; Should we convert those too to ProcessTools.executeLimitedTestJava / ProcessTools.executeTestJava ? &lt;br/&gt;
&lt;br/&gt;
[~mbaesken] I wouldn&amp;#39;t mind that. When I did this change I got push-back from non-GC devs, so I limited my changes in the GC code.</comment>
                            <comment id="14711879" author="mbaesken" created="Thu, 10 Oct 2024 04:42:40 -0700"  >There are quite a few similar test patterns in the hotspot runtimes tests, e.g.&lt;br/&gt;
&lt;br/&gt;
--&lt;br/&gt;
cds/appcds/VerifyWithDefaultArchive.java-40-        ProcessBuilder pb = ProcessTools.createLimitedTestJavaProcessBuilder(&amp;quot;-Xlog:cds&amp;quot;, &amp;quot;-XX:+VerifySharedSpaces&amp;quot;, &amp;quot;-version&amp;quot;);&lt;br/&gt;
cds/appcds/VerifyWithDefaultArchive.java:41:        OutputAnalyzer out = new OutputAnalyzer(pb.start());&lt;br/&gt;
--&lt;br/&gt;
&lt;br/&gt;
Should we convert those too to ProcessTools.executeLimitedTestJava / ProcessTools.executeTestJava  ?</comment>
                            <comment id="14675209" author="roboduke" created="Wed, 22 May 2024 01:22:49 -0700"  >[jdk21u-fix-request] Approval Request from Martin&lt;br/&gt;
This GC test cleanup change has been backported to 21.0.5-oracle. We should have it in order to reduce merge conflicts with other backports. It only touches test files and the change is simple, but changes many files. Most of it applies cleanly and the PR with a few manual integrations has been reviewed. Tier 1-4 tests have passed.</comment>
                            <comment id="14675005" author="roboduke" created="Tue, 21 May 2024 12:36:15 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/594&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/594&lt;/a&gt;&lt;br/&gt;
Date: 2024-05-21 16:35:16 +0000</comment>
                            <comment id="14637657" author="dukebot" created="Fri, 5 Jan 2024 01:13:21 -0800"  >Changeset: 1d1cd32b&lt;br/&gt;
Author:    Stefan Karlsson &amp;lt;&lt;a href=&apos;mailto:stefank@openjdk.org&apos;&gt;stefank@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2024-01-05 09:12:24 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/1d1cd32bc355a33448d8f15555e142570bb49c21&quot;&gt;https://git.openjdk.org/jdk/commit/1d1cd32bc355a33448d8f15555e142570bb49c21&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14633211" author="roboduke" created="Mon, 11 Dec 2023 11:39:23 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/17067&quot;&gt;https://git.openjdk.org/jdk/pull/17067&lt;/a&gt;&lt;br/&gt;
Date: 2023-12-11 19:31:49 +0000</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5129000">JDK-8331913</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5130159">JDK-8332804</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3472b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17315"><![CDATA[b05]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="209"><![CDATA[gc]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>