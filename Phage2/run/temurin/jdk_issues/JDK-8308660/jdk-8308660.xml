<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 12:26:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8308660] C2 compilation hits &apos;node must be dead&apos; assert</title>
                <link>https://bugs.openjdk.org/browse/JDK-8308660</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>RenaissanceStressTest24H fails with:&lt;br/&gt;
&lt;br/&gt;
#&lt;br/&gt;
# A fatal error has been detected by the Java Runtime Environment:&lt;br/&gt;
#&lt;br/&gt;
#  Internal Error ((...)/src/hotspot/share/opto/phaseX.hpp:518), pid=15727, tid=15776&lt;br/&gt;
#  assert(dead-&amp;gt;outcnt() == 0 &amp;amp;&amp;amp; !dead-&amp;gt;is_top()) failed: node must be dead&lt;br/&gt;
#&lt;br/&gt;
# JRE version: Java(TM) SE Runtime Environment (21.0+23) (fastdebug build 21-ea+23-LTS-1937)&lt;br/&gt;
# Java VM: Java HotSpot(TM) 64-Bit Server VM (fastdebug 21-ea+23-LTS-1937, mixed mode, sharing, tiered, compressed class ptrs, z gc, linux-amd64)&lt;br/&gt;
# Problematic frame:&lt;br/&gt;
# V  [libjvm.so+0xe23ea7]  PhaseIterGVN::remove_dead_node(Node*)+0x117&lt;br/&gt;
...&lt;br/&gt;
---------------  T H R E A D  ---------------&lt;br/&gt;
&lt;br/&gt;
Current thread (0x00007fd674287510):  JavaThread &amp;quot;C2 CompilerThread0&amp;quot; daemon [_thread_in_native, id=15776, stack(0x00007fd654eff000,0x00007fd655000000) (1028K)]&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Current CompileTask:&lt;br/&gt;
C2:5012159 300833   !   4       com.sun.tools.javac.util.ByteBuffer::appendLong (53 bytes)&lt;br/&gt;
&lt;br/&gt;
Stack: [0x00007fd654eff000,0x00007fd655000000],  sp=0x00007fd654ffaf60,  free space=1007k&lt;br/&gt;
Native frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native code)&lt;br/&gt;
V  [libjvm.so+0xe23ea7]  PhaseIterGVN::remove_dead_node(Node*)+0x117  (phaseX.hpp:518)&lt;br/&gt;
V  [libjvm.so+0xe1d5fb]  IfNode::fold_compares_helper(ProjNode*, ProjNode*, ProjNode*, PhaseIterGVN*)+0xc1b  (ifnode.cpp:1044)&lt;br/&gt;
V  [libjvm.so+0xe209bd]  IfNode::fold_compares(PhaseIterGVN*)+0x21d  (ifnode.cpp:1336)&lt;br/&gt;
V  [libjvm.so+0xe22c2a]  IfNode::Ideal(PhaseGVN*, bool)+0x11a  (ifnode.cpp:1463)&lt;br/&gt;
V  [libjvm.so+0x151699d]  PhaseIterGVN::transform_old(Node*)+0xcd  (phaseX.cpp:833)&lt;br/&gt;
V  [libjvm.so+0x1510441]  PhaseIterGVN::optimize()+0x81  (phaseX.cpp:1218)&lt;br/&gt;
V  [libjvm.so+0x9ef6c4]  Compile::Optimize()+0x234  (compile.cpp:2223)&lt;br/&gt;
V  [libjvm.so+0x9f2c65]  Compile::Compile(ciEnv*, ciMethod*, int, Options, DirectiveSet*)+0x1aa5  (compile.cpp:839)</description>
                <environment></environment>
        <key id="5101582">JDK-8308660</key>
            <summary>C2 compilation hits &apos;node must be dead&apos; assert</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://bugs.openjdk.org/images/jbsImages/p3.png">P3</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="roland">Roland Westrelin</assignee>
                                    <reporter username="rcastanedalo">Roberto Castaneda Lozano</reporter>
                        <labels>
                            <label>amazon-interest</label>
                            <label>c2</label>
                            <label>ci-replay-failed</label>
                            <label>conformance</label>
                            <label>intermittent</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>oracle-triage-21</label>
                            <label>test-bigapps-Renaissance</label>
                    </labels>
                <created>Tue, 23 May 2023 06:24:57 -0700</created>
                <updated>Tue, 18 Jun 2024 02:17:55 -0700</updated>
                            <resolved>Tue, 19 Mar 2024 01:01:57 -0700</resolved>
                                    <version>17</version>
                    <version>21</version>
                    <version>22</version>
                    <version>23</version>
                                    <fixVersion>23</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14682048" author="roboduke" created="Mon, 17 Jun 2024 03:47:52 -0700"  >[jdk21u-fix-request] Approval Request from Martin&lt;br/&gt;
Should get backported for parity with 21.0.5-oracle. Applies almost cleanly, has been reviewed and tier 1-4 have passed.</comment>
                            <comment id="14681769" author="roboduke" created="Fri, 14 Jun 2024 09:05:43 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/729&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/729&lt;/a&gt;&lt;br/&gt;
Date: 2024-06-14 15:59:38 +0000</comment>
                            <comment id="14658441" author="dukebot" created="Tue, 19 Mar 2024 01:01:55 -0700"  >Changeset: 053ff76e&lt;br/&gt;
Author:    Roland Westrelin &amp;lt;&lt;a href=&apos;mailto:roland@openjdk.org&apos;&gt;roland@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2024-03-19 07:57:53 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/053ff76e14046f796f6e10a9cb2ede1f1ae22ed6&quot;&gt;https://git.openjdk.org/jdk/commit/053ff76e14046f796f6e10a9cb2ede1f1ae22ed6&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14657433" author="roboduke" created="Thu, 14 Mar 2024 07:27:08 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/18305&quot;&gt;https://git.openjdk.org/jdk/pull/18305&lt;/a&gt;&lt;br/&gt;
Date: 2024-03-14 14:12:09 +0000</comment>
                            <comment id="14637649" author="thartmann" created="Fri, 5 Jan 2024 00:38:48 -0800"  >That code was added by &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8269230&quot; title=&quot;C2: main loop in micro benchmark never executed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8269230&quot;&gt;&lt;strike&gt;JDK-8269230&lt;/strike&gt;&lt;/a&gt; in JDK 17 b30. [~roland], could you please have a look?</comment>
                            <comment id="14637648" author="thartmann" created="Fri, 5 Jan 2024 00:38:21 -0800"  >The problem is that &amp;#39;adjusted_val&amp;#39; is top:&lt;br/&gt;
&lt;br/&gt;
#1  0x00007f1e39891bdb in IfNode::fold_compares_helper (this=this@entry=0x7f1e1c177ed8, proj=proj@entry=0x7f1e1c175b60, success=success@entry=0x7f1e1c178010, fail=fail@entry=0x7f1e1c177f78, igvn=igvn@entry=0x7f1e0dc2c550)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at /oracle/jdk3/open/src/hotspot/share/opto/ifnode.cpp:1050&lt;br/&gt;
1050	          igvn-&amp;gt;remove_dead_node(adjusted_val);&lt;br/&gt;
(rr) p adjusted_val-&amp;gt;dump(0)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;1  Con  === 0  [[ ]]  #top&lt;br/&gt;
&lt;br/&gt;
And that&amp;#39;s because &amp;#39;n&amp;#39; is an AddI with a top input here:&lt;br/&gt;
&lt;br/&gt;
1028	    Node* adjusted_val = igvn-&amp;gt;transform(new SubINode(n,  lo)&lt;br/&gt;
&lt;br/&gt;
(rr) p n-&amp;gt;dump(1)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;83  ConI  === 0  [[ 84 95 106 11583 11210 11200 11190 1792 9958 1466 9282 546 538 1766 9097 9087 9077 8949 7982 7989 593 597 603 607 613 617 7713 7290 7164 2941 1788 2758 2748 2738 2495 1422 2494 1453 2387 2347 2289 2285 2279 2275 2269 2265 2218 767 2221 1773 2489 2164 2096 2075 2028 1617 1996 1563 1974 1585 1798 1664 1802 1542 1812 1808 1953 1885 11919 ]]  #int:1&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;1  Con  === 0  [[ ]]  #top&lt;br/&gt;
&amp;nbsp;&amp;nbsp;1466  AddI  === _ 1 83  [[ 1996 1503 1664 1585 1657 1617 1610 2075 2131 2021 2028 2068 ]]  !orig=[11691],[11690] !jvms: BitSet::recalculateWordsInUse @ bci:34 (line 141) BitSet::clear @ bci:62 (line 553) DefaultListSelectionModel::clear @ bci:17 (line 329) DefaultListSelectionModel::changeSelection @ bci:82 (line 452) DefaultListSelectionModel::changeSelection @ bci:7 (line 469) DefaultListSelectionModel::addSelectionInterval @ bci:96 (line 572) JList::setSelectedIndices @ bci:57 (line 2257)</comment>
                            <comment id="14637631" author="thartmann" created="Thu, 4 Jan 2024 23:52:34 -0800"  >I found another replay file (see attached replay_pid5417.log) from a JCK failure and that one worked:&lt;br/&gt;
&lt;br/&gt;
java -XX:+ReplayCompiles -XX:+ReplayIgnoreInitErrors -XX:ReplayDataFile=replay_pid5417.log -ea -esa -XX:+PrintCompilation -XX:-TieredCompilation -cp jck/JCK-runtime-22/classes/ -XX:+StressIGVN -XX:RepeatCompilation=1000&lt;br/&gt;
&lt;br/&gt;
# A fatal error has been detected by the Java Runtime Environment:&lt;br/&gt;
#&lt;br/&gt;
#  Internal Error (workspace/open/src/hotspot/share/opto/phaseX.hpp:526), pid=3676967, tid=3676981&lt;br/&gt;
#  assert(dead-&amp;gt;outcnt() == 0 &amp;amp;&amp;amp; !dead-&amp;gt;is_top()) failed: node must be dead&lt;br/&gt;
#&lt;br/&gt;
# JRE version: Java(TM) SE Runtime Environment (23.0+4) (fastdebug build 23-ea+4-173)&lt;br/&gt;
# Java VM: Java HotSpot(TM) 64-Bit Server VM (fastdebug 23-ea+4-173, mixed mode, sharing, compressed oops, compressed class ptrs, g1 gc, linux-amd64)&lt;br/&gt;
# Problematic frame:&lt;br/&gt;
# V  [libjvm.so+0xe1fc8f]  PhaseIterGVN::remove_dead_node(Node*)+0x11f&lt;br/&gt;
&lt;br/&gt;
Current CompileTask:&lt;br/&gt;
C2:8360  203 %  b        javax.swing.JList::setSelectedIndices @ 32 (69 bytes)&lt;br/&gt;
&lt;br/&gt;
Stack: [0x00007ff82f537000,0x00007ff82f638000],  sp=0x00007ff82f6331a0,  free space=1008k&lt;br/&gt;
Native frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native code)&lt;br/&gt;
V  [libjvm.so+0xe1fc8f]  PhaseIterGVN::remove_dead_node(Node*)+0x11f  (phaseX.hpp:526)&lt;br/&gt;
V  [libjvm.so+0xe18bcb]  IfNode::fold_compares_helper(ProjNode*, ProjNode*, ProjNode*, PhaseIterGVN*)+0x9bb&lt;br/&gt;
V  [libjvm.so+0xe1b9cf]  IfNode::fold_compares(PhaseIterGVN*)+0x1bf&lt;br/&gt;
V  [libjvm.so+0xe1dde7]  IfNode::Ideal(PhaseGVN*, bool)+0x117&lt;br/&gt;
V  [libjvm.so+0x153252d]  PhaseIterGVN::transform_old(Node*)+0xbd&lt;br/&gt;
V  [libjvm.so+0x1528ee4]  PhaseIterGVN::optimize()+0x94&lt;br/&gt;
V  [libjvm.so+0x9ec139]  Compile::Optimize()+0x1e9&lt;br/&gt;
V  [libjvm.so+0x9f050b]  Compile::Compile(ciEnv*, ciMethod*, int, Options, DirectiveSet*)+0x1beb&lt;br/&gt;
V  [libjvm.so+0x83dc57]  C2Compiler::compile_method(ciEnv*, ciMethod*, int, bool, DirectiveSet*)+0x1e7&lt;br/&gt;
V  [libjvm.so+0x9fbb3f]  CompileBroker::invoke_compiler_on_method(CompileTask*)+0x99f&lt;br/&gt;
V  [libjvm.so+0x9fc758]  CompileBroker::compiler_thread_loop()+0x468&lt;br/&gt;
V  [libjvm.so+0xeb99ec]  JavaThread::thread_main_inner()+0xcc&lt;br/&gt;
V  [libjvm.so+0x179ea66]  Thread::call_run()+0xb6&lt;br/&gt;
&lt;br/&gt;
It&amp;#39;s with G1, so this bug is not ZGC specific.</comment>
                            <comment id="14637626" author="thartmann" created="Thu, 4 Jan 2024 23:28:32 -0800"  >The new failures generated a replay file (see attached replay_pid10691.log) but I still couldn&amp;#39;t reproduce the issue yet.</comment>
                            <comment id="14586283" author="thartmann" created="Thu, 1 Jun 2023 03:43:11 -0700"  >This did not show up again and I&amp;#39;m not able to reproduce. There is a slight chance that this is another failure mode of &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8303512&quot; title=&quot;Race condition when computing is_loaded property of TypePtr::InterfaceSet&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8303512&quot;&gt;&lt;strike&gt;JDK-8303512&lt;/strike&gt;&lt;/a&gt; so I&amp;#39;m closing this as Cannot Reproduce for now.&lt;br/&gt;
&lt;br/&gt;
Please re-open if this shows up again.</comment>
                            <comment id="14585570" author="thartmann" created="Tue, 30 May 2023 05:53:59 -0700"  >I executed a full run with -XX:CompileCommand=option,com.sun.tools.javac.util.ByteBuffer::appendLong,DumpReplay but no replay was generated which seems to suggest that the offending method is often not even compiled.&lt;br/&gt;
&lt;br/&gt;
UPDATE: In the meantime, I was able to create some replay files (from passing runs) hoping that they might reproduce the issue with C2 stress options enabled. But unfortunately, no luck.</comment>
                            <comment id="14584518" author="thartmann" created="Thu, 25 May 2023 06:42:04 -0700"  >I also had no luck in attaching to the core file with jhsdb to extract a replay file:&lt;br/&gt;
&lt;br/&gt;
Doesn&amp;#39;t appear to be a HotSpot VM (could not find symbol &amp;quot;gHotSpotVMTypes&amp;quot; in remote process)&lt;br/&gt;
sun.jvm.hotspot.debugger.DebuggerException: Doesn&amp;#39;t appear to be a HotSpot VM (could not find symbol &amp;quot;gHotSpotVMTypes&amp;quot; in remote process)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.HotSpotAgent.setupVM(HotSpotAgent.java:428)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.HotSpotAgent.go(HotSpotAgent.java:338)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.HotSpotAgent.attach(HotSpotAgent.java:158)&lt;br/&gt;
	at jdk.hotspot.agent/sun.jvm.hotspot.CLHSDB.attachDebugger(CLHSDB.java:210)&lt;br/&gt;
</comment>
                            <comment id="14584015" author="chagedorn" created="Wed, 24 May 2023 00:47:03 -0700"  >ILW = Assert due to removing a non-dead node, 4 occurrences so far in big apps, disable compilation of affected method = HLM = P3 </comment>
                            <comment id="14583795" author="thartmann" created="Tue, 23 May 2023 08:53:26 -0700"  >The call to PhaseIterGVN::remove_dead_node was added by &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8269230&quot; title=&quot;C2: main loop in micro benchmark never executed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8269230&quot;&gt;&lt;strike&gt;JDK-8269230&lt;/strike&gt;&lt;/a&gt; in JDK 17 so it might be an old issue:&lt;br/&gt;
&lt;a href=&quot;https://github.com/openjdk/jdk/blob/master/src/hotspot/share/opto/ifnode.cpp#L1044&quot;&gt;https://github.com/openjdk/jdk/blob/master/src/hotspot/share/opto/ifnode.cpp#L1044&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Since &amp;#39;adjusted_val-&amp;gt;outcnt() == 0&amp;#39; is checked, &amp;#39;adjusted_val&amp;#39; must be top for the assert to trigger.</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5131654">JDK-8334086</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5132086">JDK-8334453</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5052497">JDK-8269230</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="107803" name="hs_err_pid10691.log" size="961104" author="thartmann" created="Thu, 4 Jan 2024 23:27:53 -0800"/>
                            <attachment id="103942" name="hs_err_pid15727.log" size="833089" author="rcastanedalo" created="Tue, 23 May 2023 06:20:28 -0700"/>
                            <attachment id="107804" name="replay_pid10691.log" size="989502" author="thartmann" created="Thu, 4 Jan 2024 23:27:53 -0800"/>
                            <attachment id="107805" name="replay_pid5417.log" size="599109" author="thartmann" created="Thu, 4 Jan 2024 23:51:26 -0800"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i31mpn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17352"><![CDATA[b15]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="208"><![CDATA[compiler]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>