<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 09:58:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8308103] Massive (up to ~30x) increase in C2 compilation time since JDK 17</title>
                <link>https://bugs.openjdk.org/browse/JDK-8308103</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>I noticed that attached JavaFuzzer generated test runs significantly longer with -Xcomp due to an increase in compilation time with C2.&lt;br/&gt;
&lt;br/&gt;
Command line:&lt;br/&gt;
java -Xmx1G -Xcomp -Xbatch -XX:CompileOnly=Test -XX:MaxRAMPercentage=4.16667 Test&lt;br/&gt;
&lt;br/&gt;
JDK 16&lt;br/&gt;
real	0m0,383s&lt;br/&gt;
user	0m0,326s&lt;br/&gt;
sys	0m0,029s&lt;br/&gt;
&lt;br/&gt;
JDK 17+23 (contains &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8252372&quot; title=&quot;Check if cloning is required to move loads out of loops in PhaseIdealLoop::split_if_with_blocks_post()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8252372&quot;&gt;&lt;strike&gt;JDK-8252372&lt;/strike&gt;&lt;/a&gt;)&lt;br/&gt;
real	0m0,483s&lt;br/&gt;
user	0m0,421s&lt;br/&gt;
sys	0m0,032s&lt;br/&gt;
&lt;br/&gt;
JDK 17+35&lt;br/&gt;
real	0m4,388s&lt;br/&gt;
user	0m4,310s&lt;br/&gt;
sys	0m0,056s&lt;br/&gt;
&lt;br/&gt;
JDK 18 and later&lt;br/&gt;
real	0m10,312s&lt;br/&gt;
user	0m10,116s&lt;br/&gt;
sys	0m0,140s&lt;br/&gt;
&lt;br/&gt;
With 5s test timeout it fails since &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8267988&quot; title=&quot;C2: assert(!addp-&amp;gt;is_AddP() || addp-&amp;gt;in(AddPNode::Base)-&amp;gt;is_top() || addp-&amp;gt;in(AddPNode::Base) == n-&amp;gt;in(AddPNode::Base)) failed: Base pointers must match (addp 1301)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8267988&quot;&gt;&lt;strike&gt;JDK-8267988&lt;/strike&gt;&lt;/a&gt; in JDK 17 b27.&lt;br/&gt;
With 8s test timeout it fails since &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8272873&quot; title=&quot;C2: Inlining should not depend on absolute call site counts&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8272873&quot;&gt;&lt;strike&gt;JDK-8272873&lt;/strike&gt;&lt;/a&gt; in JDK 18 b13.&lt;br/&gt;
&lt;br/&gt;
We seem to spend most time in here:&lt;br/&gt;
&lt;br/&gt;
#0  0x00007ffff70d9608 in Unique_Node_List::remove (n=&amp;lt;optimized out&amp;gt;, this=&amp;lt;optimized out&amp;gt;) at /oracle/valhalla/open/src/hotspot/share/opto/node.hpp:1590&lt;br/&gt;
#1  Unique_Node_List::remove (this=0x7fffac2ede30, n=0x7fffae517ae0) at /oracle/valhalla/open/src/hotspot/share/opto/node.cpp:2944&lt;br/&gt;
#2  0x00007ffff64ea758 in Compile::remove_modified_node (n=0x7fffae517ae0, this=0x7fffd47d4a30) at /oracle/valhalla/open/src/hotspot/share/opto/compile.cpp:1237&lt;br/&gt;
#3  Compile::remove_useless_node (this=0x7fffd47d4a30, dead=0x7fffae517ae0) at /oracle/valhalla/open/src/hotspot/share/opto/compile.cpp:374&lt;br/&gt;
#4  0x00007ffff71e9ceb in PhaseIterGVN::remove_globally_dead_node (this=this@entry=0x7fffd47d23f0, dead=dead@entry=0x7fffae517ae0) at /oracle/valhalla/open/src/hotspot/share/opto/phaseX.cpp:1442&lt;br/&gt;
#5  0x00007ffff71eae1e in PhaseIterGVN::remove_dead_node (dead=0x7fffae517ae0, this=0x7fffd47d23f0) at /oracle/valhalla/open/src/hotspot/share/opto/phaseX.hpp:507&lt;br/&gt;
#6  PhaseIterGVN::subsume_node (this=0x7fffd47d23f0, old=0x7fffae517ae0, nn=0x7fffaea5fae0) at /oracle/valhalla/open/src/hotspot/share/opto/phaseX.cpp:1491&lt;br/&gt;
#7  0x00007ffff6ee8878 in PhaseIdealLoop::try_sink_out_of_loop (n=&amp;lt;optimized out&amp;gt;, this=0x7fffd47d1720) at /oracle/valhalla/open/src/hotspot/share/opto/loopopts.cpp:1821&lt;br/&gt;
#8  PhaseIdealLoop::try_sink_out_of_loop (this=0x7fffd47d1720, n=&amp;lt;optimized out&amp;gt;) at /oracle/valhalla/open/src/hotspot/share/opto/loopopts.cpp:1763&lt;br/&gt;
#9  0x00007ffff6ee8ad5 in PhaseIdealLoop::split_if_with_blocks_post (this=0x7fffd47d1720, n=&amp;lt;optimized out&amp;gt;) at /oracle/valhalla/open/src/hotspot/share/opto/loopopts.cpp:1618&lt;br/&gt;
#10 0x00007ffff6ee9eb4 in PhaseIdealLoop::split_if_with_blocks_post (n=0x7fffac383d08, this=0x7fffd47d1720) at /oracle/valhalla/open/src/hotspot/share/opto/loopopts.cpp:2001&lt;br/&gt;
#11 PhaseIdealLoop::split_if_with_blocks (this=this@entry=0x7fffd47d1720, visited=..., nstack=...) at /oracle/valhalla/open/src/hotspot/share/opto/loopopts.cpp:2001&lt;br/&gt;
#12 0x00007ffff6eda5cf in PhaseIdealLoop::build_and_optimize (this=this@entry=0x7fffd47d1720) at /oracle/valhalla/open/src/hotspot/share/opto/loopnode.cpp:4517&lt;br/&gt;
#13 0x00007ffff650d674 in PhaseIdealLoop::PhaseIdealLoop (mode=LoopOptsDefault, igvn=..., this=0x7fffd47d1720) at /oracle/valhalla/open/src/hotspot/share/opto/loopnode.hpp:1101&lt;br/&gt;
&lt;br/&gt;
Running with -XX:-SplitIfBlocks or explicitly disabling PhaseIdealLoop::try_sink_out_of_loop brings back old speed.&lt;br/&gt;
&lt;br/&gt;
This also shows with -XX:+CITime:&lt;br/&gt;
&lt;br/&gt;
JDK 16:&lt;br/&gt;
Accumulated compiler times&lt;br/&gt;
----------------------------------------------------------&lt;br/&gt;
&amp;nbsp;&amp;nbsp;Total compilation time   :   0,293 s&lt;br/&gt;
&lt;br/&gt;
JDK 21:&lt;br/&gt;
Accumulated compiler times&lt;br/&gt;
----------------------------------------------------------&lt;br/&gt;
&amp;nbsp;&amp;nbsp;Total compilation time   :   9,049 s&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
        <key id="5100944">JDK-8308103</key>
            <summary>Massive (up to ~30x) increase in C2 compilation time since JDK 17</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://bugs.openjdk.org/images/jbsImages/p3.png">P3</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="roland">Roland Westrelin</assignee>
                                    <reporter username="thartmann">Tobias Hartmann</reporter>
                        <labels>
                            <label>amazon-interest</label>
                            <label>c2</label>
                            <label>javafuzzer</label>
                            <label>jdk17u-fix-request</label>
                            <label>jdk17u-fix-yes</label>
                            <label>jdk21-defer-request</label>
                            <label>jdk21-defer-yes</label>
                            <label>jdk21u-fix-SQE-ok-next</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>oracle-triage-21</label>
                            <label>performance</label>
                    </labels>
                <created>Mon, 15 May 2023 07:38:19 -0700</created>
                <updated>Thu, 21 Aug 2025 01:05:55 -0700</updated>
                            <resolved>Wed, 19 Jul 2023 04:34:18 -0700</resolved>
                                    <version>17</version>
                    <version>21</version>
                                    <fixVersion>22</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="14615733" author="roboduke" created="Wed, 4 Oct 2023 01:03:03 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u-dev/pull/1827&quot;&gt;https://git.openjdk.org/jdk17u-dev/pull/1827&lt;/a&gt;&lt;br/&gt;
Date: 2023-10-04 07:55:53 +0000</comment>
                            <comment id="14615730" author="goetz" created="Wed, 4 Oct 2023 00:56:58 -0700"  >Fix request [17u]&lt;br/&gt;
&lt;br/&gt;
I backport this for parity with 17.0.10-oracle.&lt;br/&gt;
Acceptable, typical C2 risk. &lt;br/&gt;
Clean backport.&lt;br/&gt;
Test passes (including 8312440)SAP nightly testing passed.</comment>
                            <comment id="14613484" author="goetz" created="Mon, 25 Sep 2023 00:43:01 -0700"  >Fix request [21u]&lt;br/&gt;
&lt;br/&gt;
I backport this for parity with 17.0.10-oracle. 21u should not fall back.&lt;br/&gt;
The backport deferral was meant for 21, not 21u. After it being backported to 17.0.10-oracle,&lt;br/&gt;
the risk of bringing it to 21u should be acceptable as this will have much less exposure.&lt;br/&gt;
Clean backport.&lt;br/&gt;
Test passes (including 8312440).  SAP nightly testing passed.</comment>
                            <comment id="14613478" author="roboduke" created="Mon, 25 Sep 2023 00:29:40 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u/pull/199&quot;&gt;https://git.openjdk.org/jdk21u/pull/199&lt;/a&gt;&lt;br/&gt;
Date: 2023-09-25 07:23:44 +0000</comment>
                            <comment id="14598126" author="thartmann" created="Mon, 24 Jul 2023 00:57:57 -0700"  >Deferral Request (JDK 21):&lt;br/&gt;
Only P1-P2 fixes are allowed at this point and the fix has a bug tail (see &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8312440&quot; title=&quot;assert(cast != nullptr) failed: must have added a cast to pin the node&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8312440&quot;&gt;&lt;strike&gt;JDK-8312440&lt;/strike&gt;&lt;/a&gt;).</comment>
                            <comment id="14597502" author="roboduke" created="Wed, 19 Jul 2023 23:32:37 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21/pull/141&quot;&gt;https://git.openjdk.org/jdk21/pull/141&lt;/a&gt;&lt;br/&gt;
Date: 2023-07-20 06:26:59 +0000</comment>
                            <comment id="14597236" author="dukebot" created="Wed, 19 Jul 2023 04:34:17 -0700"  >Changeset: c6ab9c29&lt;br/&gt;
Author:    Roland Westrelin &amp;lt;&lt;a href=&apos;mailto:roland@openjdk.org&apos;&gt;roland@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-07-19 11:31:49 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/c6ab9c2905203e1ec897b3404f9179ff975d0054&quot;&gt;https://git.openjdk.org/jdk/commit/c6ab9c2905203e1ec897b3404f9179ff975d0054&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14593059" author="roboduke" created="Fri, 30 Jun 2023 06:32:42 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/14732&quot;&gt;https://git.openjdk.org/jdk/pull/14732&lt;/a&gt;&lt;br/&gt;
Date: 2023-06-30 13:23:38 +0000</comment>
                            <comment id="14581589" author="thartmann" created="Mon, 15 May 2023 08:06:48 -0700"  >Targeting this for JDK 22 for now. Please update the fix version if the fix is ready in time for JDK 21.</comment>
                            <comment id="14581581" author="thartmann" created="Mon, 15 May 2023 07:43:13 -0700"  >Roland, could you please have a look?</comment>
                            <comment id="14581580" author="thartmann" created="Mon, 15 May 2023 07:41:33 -0700"  >ILW = Increase in C2 compilation time (up to ~30x), with -Xcomp and JavaFuzzer generated test, -XX:-SplitIfBlocks or disable affected method from compilation = HLM = P3</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5110467">JDK-8316406</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5111682">JDK-8317477</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5111873">JDK-8317651</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10002">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="5103800">JDK-8310566</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5050784">JDK-8267988</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5105906">JDK-8312440</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5028509">JDK-8252372</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5168791">JDK-8365909</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5100934">JDK-8308094</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="103829" name="FuzzerUtils.java" size="13240" author="thartmann" created="Mon, 15 May 2023 07:35:38 -0700"/>
                            <attachment id="103830" name="Test.java" size="2843" author="thartmann" created="Mon, 15 May 2023 07:35:16 -0700"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i31ixv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17335"><![CDATA[b07]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="208"><![CDATA[compiler]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>