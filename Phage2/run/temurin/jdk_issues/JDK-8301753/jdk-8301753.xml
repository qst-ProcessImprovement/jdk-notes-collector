<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 16:31:12 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8301753] AppendFile/WriteFile has differences between make 3.81 and 4+</title>
                <link>https://bugs.openjdk.org/browse/JDK-8301753</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>When the AppendFile function in make/common/MakeIO.gmk [1] uses the printf shell function, it needs to append a new line (see attached 8301753.patch). That is what the GNU make file function[2] does:&lt;br/&gt;
&lt;br/&gt;
&amp;quot;When writing files, text will be written to the file. If text does not already end in a newline a final newline will be written (even if text is the empty string). If the text argument is not given at all, nothing will be written.&amp;quot;&lt;br/&gt;
&lt;br/&gt;
Without this, the use of AppendFile in CreateNewSpec [3] results in a badly formatted spec file (i.e., everything on one line).&lt;br/&gt;
&lt;br/&gt;
[1] &lt;a href=&quot;https://github.com/openjdk/jdk/blob/cf68d9fb8e55e461fa717f1443094300de8feacb/make/common/MakeIO.gmk#L270&quot;&gt;https://github.com/openjdk/jdk/blob/cf68d9fb8e55e461fa717f1443094300de8feacb/make/common/MakeIO.gmk#L270&lt;/a&gt;&lt;br/&gt;
[2] &lt;a href=&quot;https://www.gnu.org/software/make/manual/html_node/File-Function.html&quot;&gt;https://www.gnu.org/software/make/manual/html_node/File-Function.html&lt;/a&gt;&lt;br/&gt;
[3] &lt;a href=&quot;https://github.com/openjdk/jdk/blob/cf68d9fb8e55e461fa717f1443094300de8feacb/make/RunTestsPrebuilt.gmk#L105&quot;&gt;https://github.com/openjdk/jdk/blob/cf68d9fb8e55e461fa717f1443094300de8feacb/make/RunTestsPrebuilt.gmk#L105&lt;/a&gt;</description>
                <environment></environment>
        <key id="5093313">JDK-8301753</key>
            <summary>AppendFile/WriteFile has differences between make 3.81 and 4+</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ihse">Magnus Ihse Bursie</assignee>
                                    <reporter username="dnsimon">Douglas Simon</reporter>
                        <labels>
                            <label>jdk11u-fix-request</label>
                            <label>jdk11u-fix-yes</label>
                            <label>jdk17u-fix-request</label>
                            <label>jdk17u-fix-yes</label>
                    </labels>
                <created>Fri, 3 Feb 2023 03:01:04 -0800</created>
                <updated>Thu, 8 May 2025 14:54:05 -0700</updated>
                            <resolved>Thu, 16 Feb 2023 11:34:38 -0800</resolved>
                                    <version>21</version>
                                    <fixVersion>21</fixVersion>
                                    <component>infrastructure</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="14767605" author="sgehwolf" created="Mon, 7 Apr 2025 08:58:05 -0700"  >OK. Allowing it in for 11u. Since this is a run-test-prebuilt specific problem on old make versions it&amp;#39;s still a fairly rare use-case and the patch changes global build logic this. Question remains if this ever worked.</comment>
                            <comment id="14767407" author="JIRAUSER20522" created="Sun, 6 Apr 2025 23:34:14 -0700"  >Testing on CentOS 7.9.2009 with make 3.82:&lt;br/&gt;
```&lt;br/&gt;
+ make --version&lt;br/&gt;
GNU Make 3.82&lt;br/&gt;
Built for x86_64-redhat-linux-gnu&lt;br/&gt;
Copyright (C) 2010  Free Software Foundation, Inc.&lt;br/&gt;
License GPLv3+: GNU GPL version 3 or later &amp;lt;&lt;a href=&quot;http://gnu.org/licenses/gpl.html&quot;&gt;http://gnu.org/licenses/gpl.html&lt;/a&gt;&amp;gt;&lt;br/&gt;
This is free software: you are free to change and redistribute it.&lt;br/&gt;
There is NO WARRANTY, to the extent permitted by law.&lt;br/&gt;
&lt;br/&gt;
TEST=test/jdk/java/lang/ref/Basic.java&lt;br/&gt;
+ make run-test-prebuilt&lt;br/&gt;
Detected target OS, type and env: [linux] [unix] [linux]&lt;br/&gt;
MakeBase.gmk:82: /make/common/Utils.gmk: No such file or directory&lt;br/&gt;
MakeBase.gmk:83: /make/common/MakeIO.gmk: No such file or directory&lt;br/&gt;
MakeBase.gmk:84: /make/common/CopyFiles.gmk: No such file or directory&lt;br/&gt;
Unknown test selection: &amp;#39;test/jdk/java/lang/ref/Basic.java&amp;#39;&lt;br/&gt;
See doc/testing.[md|html] for help&lt;br/&gt;
make/RunTests.gmk:452: *** Cannot continue.  Stop.&lt;br/&gt;
make[1]: *** [run-test-prebuilt] Error 2&lt;br/&gt;
make: *** [run-test-prebuilt] Error 2&lt;br/&gt;
```&lt;br/&gt;
&lt;br/&gt;
With the backport it works OK:&lt;br/&gt;
```&lt;br/&gt;
+ make --version&lt;br/&gt;
GNU Make 3.82&lt;br/&gt;
Built for x86_64-redhat-linux-gnu&lt;br/&gt;
Copyright (C) 2010  Free Software Foundation, Inc.&lt;br/&gt;
License GPLv3+: GNU GPL version 3 or later &amp;lt;&lt;a href=&quot;http://gnu.org/licenses/gpl.html&quot;&gt;http://gnu.org/licenses/gpl.html&lt;/a&gt;&amp;gt;&lt;br/&gt;
This is free software: you are free to change and redistribute it.&lt;br/&gt;
There is NO WARRANTY, to the extent permitted by law.&lt;br/&gt;
&lt;br/&gt;
TEST=test/jdk/java/lang/ref/Basic.java&lt;br/&gt;
+ make run-test-prebuilt&lt;br/&gt;
Detected target OS, type and env: [linux] [unix] [linux]&lt;br/&gt;
Test selection &amp;#39;test/jdk/java/lang/ref/Basic.java&amp;#39;, will run:&lt;br/&gt;
* jtreg:test/jdk/java/lang/ref/Basic.java&lt;br/&gt;
&lt;br/&gt;
Running test &amp;#39;jtreg:test/jdk/java/lang/ref/Basic.java&amp;#39;&lt;br/&gt;
Passed: java/lang/ref/Basic.java&lt;br/&gt;
Test results: passed: 1&lt;br/&gt;
```&lt;br/&gt;
&lt;br/&gt;
I guess what is broken is described in the description of this bug in details - &amp;quot;run-test-spec.gmk&amp;quot; is badly formatted because of containing all the text in a one line, the same it was for 17 and 21.&lt;br/&gt;
&lt;br/&gt;
</comment>
                            <comment id="14767196" author="sgehwolf" created="Fri, 4 Apr 2025 09:33:41 -0700"  >It&amp;#39;s still not clear *what* exactly is broken. Can you enlighten us so we don&amp;#39;t have to do this back-and-forth when somebody comes back to this? It doesn&amp;#39;t seem like any problem that we (Red Hat) is seeing - on make 3.x systems - so I&amp;#39;d like to know what exactly it is that needs this.</comment>
                            <comment id="14767072" author="JIRAUSER20522" created="Fri, 4 Apr 2025 02:40:08 -0700"  >I agree and fully support the desire to keep jdk11u stable. As far as I remember, build system changes are in general considered for backporting, that&amp;#39;s why our confusion about the support status appeared.&lt;br/&gt;
&lt;br/&gt;
As for the build system, apparently at some point it was broken. We did not investigate it and backported the change downstream instead. We are still building jdk11 in various configurations, including legacy ones with make 3.8x. It&amp;#39;s still reasonable, that&amp;#39;s why we&amp;#39;d want to upstream it, to keep 11u maintainable and buildable for everybody.&lt;br/&gt;
&lt;br/&gt;
As for the risks, it affects the build system only, it doesn&amp;#39;t affect neither compiler calls nor functionality. The change is quite simple, it changes how the make constructs intermediate text files. So it either works, or build fails. Any problem with the backport will be easy to catch. So the fix brings little to no risk.&lt;br/&gt;
&lt;br/&gt;
Sorry for not communicating this from the start.</comment>
                            <comment id="14767015" author="JIRAUSER20522" created="Thu, 3 Apr 2025 23:57:03 -0700"  >[~sgehwolf] Sorry, I&amp;#39;ve lost a part of my thoughts when writing my latest comment. I meant we are still building jdk11 in various configurations, including legacy ones with make 3.8x, and it would be nice to add this fix to version 11 to make it working for all &amp;quot;make&amp;quot;s.</comment>
                            <comment id="14766808" author="sgehwolf" created="Thu, 3 Apr 2025 07:28:58 -0700"  >&amp;quot;11u is done&amp;quot;, means it should receive only the minimal fixes that are absolutely necessary. It has to be made a case this is absolutely needed and why.&lt;br/&gt;
&lt;br/&gt;
This is hardly a general JDK 11 build problem as it seems to build fine on make 4 here and also on GHA (e.g. here: &lt;a href=&quot;https://github.com/satyenme/jdk11u-dev/actions/runs/14139402399/job/39713220985#step:7:87)&quot;&gt;https://github.com/satyenme/jdk11u-dev/actions/runs/14139402399/job/39713220985#step:7:87)&lt;/a&gt;. So it seems to be a specific scenario that breaks. Which (exactly) is it and why is it needed now?&lt;br/&gt;
&lt;br/&gt;
One comment says: &amp;quot;This fixes &amp;quot;make run-test-prebuilt&amp;quot; build problem occured with make version &amp;lt;4.0 in JDK11&amp;quot; another says: &amp;quot;as modern systems install make v4+ by default.&amp;quot;, seemingly add odds?</comment>
                            <comment id="14766779" author="akozlov" created="Thu, 3 Apr 2025 06:08:22 -0700"  >[~sgehwolf] Could you elaborate on the &amp;quot;11u is done&amp;quot;. The change fixes build system behavior on newer build environments. We (Azul) would like to keep 11u code alive and implement reasonable changes to keep it buildable.</comment>
                            <comment id="14757187" author="JIRAUSER20522" created="Fri, 28 Feb 2025 07:12:02 -0800"  >[~sgehwolf] Because we still build jdk11, and it&amp;#39;d be nice to have this fix in 11, as modern systems install make v4+ by default. This fix was created in Feb 2023, so it couldn&amp;#39;t be backported before 2023.</comment>
                            <comment id="14755288" author="sgehwolf" created="Thu, 20 Feb 2025 07:58:22 -0800"  >This doesn&amp;#39;t seem an important backport to have for 11u. Question is why now? OpenJDK 11u is done.</comment>
                            <comment id="14725162" author="roboduke" created="Fri, 22 Nov 2024 00:03:45 -0800"  >[jdk11u-fix-request] Approval Request from Roman Marchenko&lt;br/&gt;
Clean backport to 11u. This fixes &amp;quot;make run-test-prebuilt&amp;quot; build problem occured with make version &amp;lt;4.0 in JDK11.</comment>
                            <comment id="14725155" author="roboduke" created="Thu, 21 Nov 2024 23:48:02 -0800"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk11u-dev/pull/2969&quot;&gt;https://git.openjdk.org/jdk11u-dev/pull/2969&lt;/a&gt;&lt;br/&gt;
Date: 2024-11-22 07:43:03 +0000</comment>
                            <comment id="14664102" author="roboduke" created="Tue, 9 Apr 2024 09:04:34 -0700"  >[jdk17u-fix-request] Approval Request from Roman Marchenko&lt;br/&gt;
Clean backport to 17u. This fixes &amp;quot;make test&amp;quot; build problem occured with make version &amp;lt;4.0 in jdk17. The new test is passed locally with a manual run.</comment>
                            <comment id="14664096" author="roboduke" created="Tue, 9 Apr 2024 08:48:37 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u-dev/pull/2382&quot;&gt;https://git.openjdk.org/jdk17u-dev/pull/2382&lt;/a&gt;&lt;br/&gt;
Date: 2024-04-09 15:44:26 +0000</comment>
                            <comment id="14560818" author="dukebot" created="Thu, 16 Feb 2023 11:34:37 -0800"  >Changeset: a39cf2e3&lt;br/&gt;
Author:    Magnus Ihse Bursie &amp;lt;&lt;a href=&apos;mailto:ihse@openjdk.org&apos;&gt;ihse@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-02-16 19:32:38 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/a39cf2e3b242298fbf5fafdb8aa9b5d4562061ef&quot;&gt;https://git.openjdk.org/jdk/commit/a39cf2e3b242298fbf5fafdb8aa9b5d4562061ef&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14560813" author="roboduke" created="Thu, 16 Feb 2023 11:15:45 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/12605&quot;&gt;https://git.openjdk.org/jdk/pull/12605&lt;/a&gt;&lt;br/&gt;
Date: 2023-02-16 19:08:53 +0000</comment>
                            <comment id="14558056" author="roboduke" created="Tue, 7 Feb 2023 13:02:17 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/12461&quot;&gt;https://git.openjdk.org/jdk/pull/12461&lt;/a&gt;&lt;br/&gt;
Date: 2023-02-07 20:56:01 +0000</comment>
                            <comment id="14558048" author="erikj" created="Tue, 7 Feb 2023 12:06:36 -0800"  >Right, macos still ships with 3.81.</comment>
                            <comment id="14558047" author="dnsimon" created="Tue, 7 Feb 2023 11:55:34 -0800"  >[~lmesnik] said he&amp;#39;d take care of fixing this.&lt;br/&gt;
&lt;br/&gt;
I was using GNU Make 3.81 on macOS when I hit this.</comment>
                            <comment id="14558036" author="erikj" created="Tue, 7 Feb 2023 11:19:33 -0800"  >Did you intend to submit this as a PR yourself?&lt;br/&gt;
&lt;br/&gt;
I agree that the fallback implementation of AppendFile should mimic the gnu make implementation, and it&amp;#39;s a bug if they behave differently. Are you running with a gnu make version &amp;lt;4.0 as you are running into this?</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5128016">JDK-8331173</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5158212">JDK-8356590</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="102535" name="8301753.patch" size="425" author="dnsimon" created="Fri, 3 Feb 2023 03:03:07 -0800"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i308kj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17311"><![CDATA[b11]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="199"><![CDATA[build]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>