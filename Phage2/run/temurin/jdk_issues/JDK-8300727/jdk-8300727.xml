<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 15:56:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8300727] java/awt/List/ListGarbageCollectionTest/AwtListGarbageCollectionTest.java failed with &quot;List wasn&apos;t garbage collected&quot;</title>
                <link>https://bugs.openjdk.org/browse/JDK-8300727</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>----------System.err:(12/749)----------&lt;br/&gt;
java.lang.RuntimeException: List wasn&amp;#39;t garbage collected&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at AwtListGarbageCollectionTest.test(AwtListGarbageCollectionTest.java:69)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at AwtListGarbageCollectionTest.main(AwtListGarbageCollectionTest.java:41)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.base/java.lang.reflect.Method.invoke(Method.java:578)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at com.sun.javatest.regtest.agent.MainWrapper$MainThread.run(MainWrapper.java:125)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.base/java.lang.Thread.run(Thread.java:1623)</description>
                <environment></environment>
        <key id="5092033">JDK-8300727</key>
            <summary>java/awt/List/ListGarbageCollectionTest/AwtListGarbageCollectionTest.java failed with &quot;List wasn&apos;t garbage collected&quot;</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="aivanov">Alexey Ivanov</assignee>
                                    <reporter username="dholmes">David Holmes</reporter>
                        <labels>
                            <label>cssn23_02_02</label>
                            <label>cssn23_03_01</label>
                            <label>intermittent</label>
                            <label>jdk11u-fix-request</label>
                            <label>jdk11u-fix-yes</label>
                            <label>jdk17u-fix-request</label>
                            <label>jdk17u-fix-yes</label>
                            <label>noreg-self</label>
                            <label>sustaining</label>
                            <label>tier4</label>
                    </labels>
                <created>Thu, 19 Jan 2023 22:48:08 -0800</created>
                <updated>Sat, 23 Dec 2023 03:15:00 -0800</updated>
                            <resolved>Mon, 13 Mar 2023 08:07:34 -0700</resolved>
                                    <version>21</version>
                                    <fixVersion>21</fixVersion>
                                    <component>client-libs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>10</watches>
                                                                                                                <comments>
                            <comment id="14636126" author="roboduke" created="Thu, 21 Dec 2023 19:07:16 -0800"  >[jdk11u-fix-request] Approval Request from Amos&lt;br/&gt;
&#8220;Backporting for parity with jdk 11.0.22-oracle. No risk, test fix. Clean backport. SAP nightlies passed on 2023-12-21&#8221;</comment>
                            <comment id="14633802" author="roboduke" created="Tue, 12 Dec 2023 20:40:38 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk11u-dev/pull/2364&quot;&gt;https://git.openjdk.org/jdk11u-dev/pull/2364&lt;/a&gt;&lt;br/&gt;
Date: 2023-12-13 04:35:00 +0000</comment>
                            <comment id="14616796" author="roboduke" created="Mon, 9 Oct 2023 11:36:11 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u-dev/pull/1863&quot;&gt;https://git.openjdk.org/jdk17u-dev/pull/1863&lt;/a&gt;&lt;br/&gt;
Date: 2023-10-09 18:25:26 +0000</comment>
                            <comment id="14616791" author="goetz" created="Mon, 9 Oct 2023 11:24:55 -0700"  >Fix request [17u]&lt;br/&gt;
&lt;br/&gt;
I backport this for parity with 17.0.10-oracle.&lt;br/&gt;
No risk, only a test change.&lt;br/&gt;
Clean backport.&lt;br/&gt;
Test passes. SAP nightly testing passed.</comment>
                            <comment id="14566314" author="dukebot" created="Mon, 13 Mar 2023 08:07:33 -0700"  >Changeset: f835aaaf&lt;br/&gt;
Author:    Alexey Ivanov &amp;lt;&lt;a href=&apos;mailto:aivanov@openjdk.org&apos;&gt;aivanov@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-03-13 15:05:15 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/f835aaafc7332d324ca9b08b2a34539fc1c573aa&quot;&gt;https://git.openjdk.org/jdk/commit/f835aaafc7332d324ca9b08b2a34539fc1c573aa&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14560734" author="roboduke" created="Thu, 16 Feb 2023 06:47:06 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/12594&quot;&gt;https://git.openjdk.org/jdk/pull/12594&lt;/a&gt;&lt;br/&gt;
Date: 2023-02-16 14:38:21 +0000</comment>
                            <comment id="14560719" author="aivanov" created="Thu, 16 Feb 2023 06:22:19 -0800"  >Root cause:&lt;br/&gt;
&lt;br/&gt;
The garbage collection gets invoked even with the original code which generated OOME. Yet the WeakReference wasn&amp;#39;t cleared as expected. The test didn&amp;#39;t provide any opportunity to re-try.&lt;br/&gt;
&lt;br/&gt;
I replaced the code to call System.gc() directly instead of relying on OOME. I used PhantomReference instead of WeakReference. It didn&amp;#39;t work from the first attempt. In majority of cases, it required another call to System.gc() to make the reference enqueued.&lt;br/&gt;
&lt;br/&gt;
The fix:&lt;br/&gt;
&lt;br/&gt;
Call System.gc() in a loop and wait for the reference to be enqueued. The test allows 5 attempts before it fails.</comment>
                            <comment id="14560365" author="aivanov" created="Wed, 15 Feb 2023 05:41:21 -0800"  >I enabled GC logs with -Xlog:gc=debug and also added System.gc() &#8212; the test still fails intermittently. In addition to it, I used PhantomReference instead of WeakReference, the test still fails.&lt;br/&gt;
&lt;br/&gt;
Also, I tried Serial GC by using -XX:+UseSerialGC. It didn&amp;#39;t make any difference.&lt;br/&gt;
&lt;br/&gt;
The test has been in the repo since 2014 and it has never failed&#8230; often. There were only 20 failures in mach5: a couple of failures in 2020 and in 2022. Then since January 2023, the test has been failing much more often.</comment>
                            <comment id="14560139" author="dholmes" created="Tue, 14 Feb 2023 17:04:17 -0800"  >This is not the way to provoke a full GC in a test reliably:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;//make out of memory to force gc&lt;br/&gt;
&amp;nbsp;String veryLongString = new String(new char[100]);&lt;br/&gt;
&amp;nbsp;while (true) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;veryLongString += veryLongString;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&lt;br/&gt;
just use System.gc(). See e.g. test/jdk/java/lang/ref/PhantomReferentClearing.java</comment>
                            <comment id="14560017" author="aivanov" created="Tue, 14 Feb 2023 07:26:04 -0800"  >Should a garbage collector be set explicitly in the test? It may help to make the test more predictable. A small delay may be required before it verifies whether the weak reference is cleared or not.</comment>
                            <comment id="14553187" author="prr" created="Fri, 20 Jan 2023 11:30:34 -0800"  >Very strange .. intermittent now but never seen before. I don&amp;#39;t know what could have changed&lt;br/&gt;
but tests that rely on gc() can be flaky </comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5109175">JDK-8315287</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5109203">JDK-8315314</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5112122">JDK-8317876</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5117773">JDK-8322720</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i300ob:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17407"><![CDATA[b14]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="196"><![CDATA[java.awt]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>