<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 18:10:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8305227] [s390x] build broken after JDK-8231349</title>
                <link>https://bugs.openjdk.org/browse/JDK-8305227</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>after &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8231349&quot; title=&quot;Move intrinsic stubs generation to compiler runtime initialization code&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8231349&quot;&gt;&lt;strike&gt;JDK-8231349&lt;/strike&gt;&lt;/a&gt; release, slow debug, fast debug and optimised builds are broken. &lt;br/&gt;
&lt;br/&gt;
Stack trace:&lt;br/&gt;
&lt;br/&gt;
Native frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native code)&lt;br/&gt;
C  0x000003ff86c7de70&lt;br/&gt;
j  java.lang.String.lastIndexOf(II)I+1 java.base&lt;br/&gt;
j  java.lang.String.lastIndexOf(I)I+8 java.base&lt;br/&gt;
j  java.lang.Class.getPackageName()Ljava/lang/String;+47 java.base&lt;br/&gt;
j  sun.invoke.util.VerifyAccess.isSamePackage(Ljava/lang/Class;Ljava/lang/Class;)Z+21 java.base&lt;br/&gt;
j  sun.invoke.util.VerifyAccess.isClassAccessible(Ljava/lang/Class;Ljava/lang/Class;Ljava/lang/Class;I)Z+36 java.base&lt;br/&gt;
j  java.lang.invoke.MethodHandles$Lookup.ensureInitialized(Ljava/lang/Class;)Ljava/lang/Class;+81 java.base&lt;br/&gt;
j  jdk.internal.access.SharedSecrets.ensureClassInitialized(Ljava/lang/Class;)V+4 java.base&lt;br/&gt;
j  jdk.internal.access.SharedSecrets.getJavaLangModuleAccess()Ljdk/internal/access/JavaLangModuleAccess;+10 java.base&lt;br/&gt;
j  jdk.internal.module.ModuleBootstrap.&amp;lt;clinit&amp;gt;()V+22 java.base&lt;br/&gt;
v  ~StubRoutines::call_stub 0x000003ff7d000b32&lt;br/&gt;
V  [libjvm.so+0xbd4ce4]  JavaCalls::call_helper(JavaValue*, methodHandle const&amp;amp;, JavaCallArguments*, JavaThread*)+0x51c  (javaCalls.cpp:415)&lt;br/&gt;
V  [libjvm.so+0xbd38f2]  JavaCalls::call(JavaValue*, methodHandle const&amp;amp;, JavaCallArguments*, JavaThread*)+0x42  (javaCalls.cpp:329)&lt;br/&gt;
V  [libjvm.so+0xb7b908]  InstanceKlass::call_class_initializer(JavaThread*)+0x1f0  (instanceKlass.cpp:1553)&lt;br/&gt;
V  [libjvm.so+0xb870c2]  InstanceKlass::initialize_impl(JavaThread*)+0x60a  (instanceKlass.cpp:1139)&lt;br/&gt;
V  [libjvm.so+0xf05642]  LinkResolver::resolve_static_call(CallInfo&amp;amp;, LinkInfo const&amp;amp;, bool, JavaThread*)+0x162  (linkResolver.cpp:1078)&lt;br/&gt;
V  [libjvm.so+0xf0ab7a]  LinkResolver::resolve_invoke(CallInfo&amp;amp;, Handle, constantPoolHandle const&amp;amp;, int, Bytecodes::Code, JavaThread*)+0x1d2  (linkResolver.cpp:1672)&lt;br/&gt;
V  [libjvm.so+0xbba0ee]  InterpreterRuntime::resolve_invoke(JavaThread*, Bytecodes::Code)+0x1b6  (interpreterRuntime.cpp:834)&lt;br/&gt;
V  [libjvm.so+0xbbacf6]  InterpreterRuntime::resolve_from_cache(JavaThread*, Bytecodes::Code)+0x106  (interpreterRuntime.cpp:968)&lt;br/&gt;
j  java.lang.System.initPhase2(ZZ)I+0 java.base&lt;br/&gt;
v  ~StubRoutines::call_stub 0x000003ff7d000b32&lt;br/&gt;
V  [libjvm.so+0xbd4ce4]  JavaCalls::call_helper(JavaValue*, methodHandle const&amp;amp;, JavaCallArguments*, JavaThread*)+0x51c  (javaCalls.cpp:415)&lt;br/&gt;
V  [libjvm.so+0xbd5c36]  JavaCalls::call_static(JavaValue*, Klass*, Symbol*, Symbol*, JavaCallArguments*, JavaThread*)+0x296  (javaCalls.cpp:329)&lt;br/&gt;
V  [libjvm.so+0x148fb14]  Threads::create_vm(JavaVMInitArgs*, bool*)+0x7cc  (threads.cpp:311)&lt;br/&gt;
V  [libjvm.so+0xd236e8]  JNI_CreateJavaVM+0xc0  (jni.cpp:3588)&lt;br/&gt;
C  [libjli.so+0x4794]  JavaMain+0xa4  (java.c:1459)&lt;br/&gt;
C  [libjli.so+0x7e40]  ThreadJavaMain+0x20  (java_md.c:650)&lt;br/&gt;
</description>
                <environment></environment>
        <key id="5097457">JDK-8305227</key>
            <summary>[s390x] build broken after JDK-8231349</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://bugs.openjdk.org/images/jbsImages/p2.png">P2</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="amitkumar">Amit Kumar</assignee>
                                    <reporter username="amitkumar">Amit Kumar</reporter>
                        <labels>
                            <label>oracle-triage-21</label>
                            <label>oraclejdk-na</label>
                    </labels>
                <created>Thu, 30 Mar 2023 01:55:35 -0700</created>
                <updated>Wed, 5 Apr 2023 23:17:39 -0700</updated>
                            <resolved>Fri, 31 Mar 2023 10:00:47 -0700</resolved>
                                    <version>21</version>
                                    <fixVersion>21</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14571045" author="dukebot" created="Fri, 31 Mar 2023 10:00:44 -0700"  >Changeset: 4a5d7ca7&lt;br/&gt;
Author:    Amit Kumar &amp;lt;&lt;a href=&apos;mailto:amitkumar@openjdk.org&apos;&gt;amitkumar@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Committer: Aleksey Shipilev &amp;lt;&lt;a href=&apos;mailto:shade@openjdk.org&apos;&gt;shade@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-03-31 16:57:46 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/4a5d7ca7d9cf90f8c61d890419c8557b61f78f7e&quot;&gt;https://git.openjdk.org/jdk/commit/4a5d7ca7d9cf90f8c61d890419c8557b61f78f7e&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14570880" author="roboduke" created="Fri, 31 Mar 2023 00:10:47 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/13259&quot;&gt;https://git.openjdk.org/jdk/pull/13259&lt;/a&gt;&lt;br/&gt;
Date: 2023-03-31 07:06:25 +0000</comment>
                            <comment id="14570752" author="kvn" created="Thu, 30 Mar 2023 10:34:18 -0700"  >[~amitkumar] I suggest for you to test this fix and publish PR. I will review it.</comment>
                            <comment id="14570751" author="kvn" created="Thu, 30 Mar 2023 10:32:53 -0700"  >I think I found the issue. In my changes I missed to move StubRoutines::zarch::_nmethod_entry_barrier  &lt;br/&gt;
to generate_final_stubs().  So the fix is:&lt;br/&gt;
&lt;br/&gt;
diff --git a/src/hotspot/cpu/s390/stubGenerator_s390.cpp b/src/hotspot/cpu/s390/stubGenerator_s390.cpp&lt;br/&gt;
index f11521efee5..5ed30b8b460 100644&lt;br/&gt;
--- a/src/hotspot/cpu/s390/stubGenerator_s390.cpp&lt;br/&gt;
+++ b/src/hotspot/cpu/s390/stubGenerator_s390.cpp&lt;br/&gt;
@@ -3152,6 +3152,12 @@ class StubGenerator: public StubCodeGenerator {&lt;br/&gt;
&amp;nbsp;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// Arraycopy stubs used by compilers.&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;generate_arraycopy_stubs();&lt;br/&gt;
+&lt;br/&gt;
+    // nmethod entry barriers for concurrent class unloading&lt;br/&gt;
+    BarrierSetNMethod* bs_nm = BarrierSet::barrier_set()-&amp;gt;barrier_set_nmethod();&lt;br/&gt;
+    if (bs_nm != NULL) {&lt;br/&gt;
+      StubRoutines::zarch::_nmethod_entry_barrier = generate_nmethod_entry_barrier();&lt;br/&gt;
+    }&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;void generate_compiler_stubs() {&lt;br/&gt;
@@ -3199,12 +3205,6 @@ class StubGenerator: public StubCodeGenerator {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;StubRoutines::_sha512_implCompressMB = generate_SHA512_stub(true,  &amp;quot;SHA512_multiBlock&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&lt;br/&gt;
-    // nmethod entry barriers for concurrent class unloading&lt;br/&gt;
-    BarrierSetNMethod* bs_nm = BarrierSet::barrier_set()-&amp;gt;barrier_set_nmethod();&lt;br/&gt;
-    if (bs_nm != NULL) {&lt;br/&gt;
-      StubRoutines::zarch::_nmethod_entry_barrier = generate_nmethod_entry_barrier();&lt;br/&gt;
-    }&lt;br/&gt;
-&lt;br/&gt;
&amp;nbsp;#ifdef COMPILER2&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (UseMultiplyToLenIntrinsic) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;StubRoutines::_multiplyToLen = generate_multiplyToLen();&lt;br/&gt;
</comment>
                            <comment id="14570749" author="kvn" created="Thu, 30 Mar 2023 10:22:59 -0700"  >I see in hs_err file that it failed when JVM run in Client mode:&lt;br/&gt;
&amp;quot;emulated-client, tiered, compressed oops, compressed class ptrs, serial gc,&amp;quot;&lt;br/&gt;
&lt;br/&gt;
I tried the same flags on linux-x64 and I did not hit any issues.&lt;br/&gt;
&lt;br/&gt;
The hs_err file shows that Interpreter is trying to call compiled by C1 isLatin1() method from &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;public int lastIndexOf(int ch, int fromIndex) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return isLatin1() ? StringLatin1.lastIndexOf(value, ch, fromIndex)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;: StringUTF16.lastIndexOf(value, ch, fromIndex);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
</comment>
                            <comment id="14570745" author="JIRAUSER20704" created="Thu, 30 Mar 2023 10:00:12 -0700"  >@kvn Thanks, that worked. But if possible, may I know why this is not working on s390x ?&lt;br/&gt;
&lt;br/&gt;
Thank you again, for helping me out.</comment>
                            <comment id="14570741" author="kvn" created="Thu, 30 Mar 2023 09:41:04 -0700"  >[~amitkumar] please, try to run with -XX:-DelayCompilerStubsGeneration off.&lt;br/&gt;
If it works you can disable it by default for s390:&lt;br/&gt;
src/hotspot/cpu/s390/globals_s390.hpp&lt;br/&gt;
@@ -36,5 +36,5 @@ define_pd_global(bool,  ImplicitNullChecks,          true);  // Generate code fo&lt;br/&gt;
&amp;nbsp;define_pd_global(bool,  TrapBasedNullChecks,         true);&lt;br/&gt;
&amp;nbsp;define_pd_global(bool,  UncommonNullCast,            true);  // Uncommon-trap NULLs passed to check cast.&lt;br/&gt;
&amp;nbsp;&lt;br/&gt;
-define_pd_global(bool,  DelayCompilerStubsGeneration, COMPILER2_OR_JVMCI);&lt;br/&gt;
+define_pd_global(bool,  DelayCompilerStubsGeneration, false);&lt;br/&gt;
&amp;nbsp;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5000720">JDK-8231349</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="103173" name="hs_err_pid4171675.log" size="44459" author="amitkumar" created="Thu, 30 Mar 2023 01:55:20 -0700"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="19600"><![CDATA[s390x]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17023"><![CDATA[linux]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i30y57:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17417"><![CDATA[b17]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="208"><![CDATA[compiler]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>