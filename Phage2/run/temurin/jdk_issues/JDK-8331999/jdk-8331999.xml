<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 13:02:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8331999] BasicDirectoryModel/LoaderThreadCount.java frequently fails on Windows in CI</title>
                <link>https://bugs.openjdk.org/browse/JDK-8331999</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>After &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8331142&quot; title=&quot;Add test for number of loader threads in BasicDirectoryModel&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8331142&quot;&gt;&lt;strike&gt;JDK-8331142&lt;/strike&gt;&lt;/a&gt; was integrated, the test/jdk/javax/swing/plaf/basic/BasicDirectoryModel/LoaderThreadCount.java test frequently fails on Windows in CI.&lt;br/&gt;
&lt;br/&gt;
All the failures found on Windows look the same:&lt;br/&gt;
&lt;br/&gt;
Number of snapshots: 20&lt;br/&gt;
Number of snapshots where number of loader threads:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;= 1: 19&lt;br/&gt;
&amp;nbsp;&amp;nbsp;= 2: 0&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;gt; 2: 1&lt;br/&gt;
Exception in Test Runner: class java.lang.RuntimeException: Detected 1 snapshots with several loading threads&lt;br/&gt;
java.lang.RuntimeException: Detected 1 snapshots with several loading threads&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at LoaderThreadCount.runTest(LoaderThreadCount.java:168)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at LoaderThreadCount.wrapper(LoaderThreadCount.java:108)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.base/java.lang.Thread.run(Thread.java:1575)&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
A kind of tolerance is needed. For example, fail the test if the number of snapshots with more than 2 loading threads is above 2 or 3. Without the fix, the number of such snapshots is much higher, usually at 20 out of 20, the lowest I&amp;#39;ve seen over the recent days is 16.&lt;br/&gt;
&lt;br/&gt;
A fraction of the number of (valid) snapshots could be used, for instance SNAPSHOTS / 2 or loaderCount.size() / 2, both usually give 10 on Windows.</description>
                <environment></environment>
        <key id="5129135">JDK-8331999</key>
            <summary>BasicDirectoryModel/LoaderThreadCount.java frequently fails on Windows in CI</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://bugs.openjdk.org/images/jbsImages/p2.png">P2</priority>
                        <status id="6" iconUrl="https://bugs.openjdk.org/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="aivanov">Alexey Ivanov</assignee>
                                    <reporter username="aivanov">Alexey Ivanov</reporter>
                        <labels>
                            <label>cssn24_05_01</label>
                            <label>jdk17u-fix-request</label>
                            <label>jdk17u-fix-yes</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>noreg-self</label>
                            <label>regression</label>
                            <label>regression_8331142</label>
                            <label>sustaining</label>
                            <label>testbug</label>
                    </labels>
                <created>Thu, 9 May 2024 05:16:47 -0700</created>
                <updated>Tue, 12 Nov 2024 07:16:15 -0800</updated>
                            <resolved>Thu, 9 May 2024 11:04:29 -0700</resolved>
                                    <version>23</version>
                                    <fixVersion>23</fixVersion>
                                    <component>client-libs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14719693" author="goetz" created="Wed, 6 Nov 2024 04:19:33 -0800"  >[17u]&lt;br/&gt;
I&amp;#39;ll backport problem listing the test: &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8337810&quot; title=&quot;ProblemList BasicDirectoryModel/LoaderThreadCount.java on Windows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8337810&quot;&gt;&lt;strike&gt;JDK-8337810&lt;/strike&gt;&lt;/a&gt;. Then we have the test coverage on other platforms, and no failures on win.</comment>
                            <comment id="14719406" author="JIRAUSER20917" created="Tue, 5 Nov 2024 19:14:56 -0800"  >Fix request [17u]&lt;br/&gt;
&lt;br/&gt;
I backport this for parity with 17.0.13-oracle.&lt;br/&gt;
No risk, only tests change.&lt;br/&gt;
Backport with &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8331495&quot; title=&quot;Limit BasicDirectoryModel/LoaderThreadCount.java to Windows only&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8331495&quot;&gt;&lt;strike&gt;JDK-8331495&lt;/strike&gt;&lt;/a&gt;, &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8331142&quot; title=&quot;Add test for number of loader threads in BasicDirectoryModel&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8331142&quot;&gt;&lt;strike&gt;JDK-8331142&lt;/strike&gt;&lt;/a&gt; together&lt;br/&gt;
As &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8333880&quot;&gt;https://bugs.openjdk.org/browse/JDK-8333880&lt;/a&gt; not fixed, so this test may still fail.&lt;br/&gt;
SAP nightly testing passed.</comment>
                            <comment id="14682772" author="JIRAUSER20917" created="Tue, 18 Jun 2024 19:14:55 -0700"  >Fix request [21u]&lt;br/&gt;
&lt;br/&gt;
I backport this for parity with 21.0.5-oracle.&lt;br/&gt;
No risk, only a test change.&lt;br/&gt;
Clean backport.&lt;br/&gt;
Test pass.  SAP nightly testing passed.</comment>
                            <comment id="14682506" author="roboduke" created="Tue, 18 Jun 2024 01:23:38 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u-dev/pull/2605&quot;&gt;https://git.openjdk.org/jdk17u-dev/pull/2605&lt;/a&gt;&lt;br/&gt;
Date: 2024-06-18 08:02:55 +0000</comment>
                            <comment id="14682505" author="roboduke" created="Tue, 18 Jun 2024 01:22:00 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/741&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/741&lt;/a&gt;&lt;br/&gt;
Date: 2024-06-18 08:16:17 +0000</comment>
                            <comment id="14680137" author="azeller" created="Mon, 10 Jun 2024 04:00:03 -0700"  >I created &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8333880&quot;&gt;https://bugs.openjdk.org/browse/JDK-8333880&lt;/a&gt;. Thanks for your help!</comment>
                            <comment id="14680135" author="aivanov" created="Mon, 10 Jun 2024 03:47:11 -0700"  >[~azeller] It&amp;#39;ll take some time&#8230; The patch may also resolve the problem on Linux and macOS.&lt;br/&gt;
Along the lines, I&amp;#39;ve been thinking about using a custom FileSystemView, it may simplify the test and make it more stable. Now the test relies on enumerating live threads, a custom FileSystemView could track the threads directly: on which thread its listFiles method is called.&lt;br/&gt;
&lt;br/&gt;
Could you create a new bug for the Windows failure that you see? Assign it to me directly, please.</comment>
                            <comment id="14680125" author="azeller" created="Mon, 10 Jun 2024 03:13:16 -0700"  >[~aivanov] That sound like a good idea. Do you think you could provide a patch that I can put in our CI? &lt;br/&gt;
&lt;br/&gt;
</comment>
                            <comment id="14679505" author="aivanov" created="Thu, 6 Jun 2024 06:59:07 -0700"  >[~azeller] Thank you for the details. It&amp;#39;s a high failure rate.&lt;br/&gt;
&lt;br/&gt;
The problem is that I cannot reproduce the failure myself. What I can think of is that I also need to verify the interrupted status of the thread. If the background thread is already interrupted but is still running, it&amp;#39;s not a failure condition&#8230; exiting from an interrupted thread could take quite a while, especially on a system under heavy load. Unless something odd is happening, such that the fix for &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8325179&quot; title=&quot;Race in BasicDirectoryModel.validateFileCache&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8325179&quot;&gt;&lt;strike&gt;JDK-8325179&lt;/strike&gt;&lt;/a&gt; isn&amp;#39;t working.</comment>
                            <comment id="14679393" author="azeller" created="Thu, 6 Jun 2024 00:53:10 -0700"  >I have seen it 30 times now since 29. May. I only see it in head - not in any older codeline.</comment>
                            <comment id="14679139" author="aivanov" created="Wed, 5 Jun 2024 05:10:32 -0700"  >[~azeller] Is it in mainline?&lt;br/&gt;
&lt;br/&gt;
We have only 20 failures of this test in our CI. There have been no failures since 9 May when I resolved this bug.&lt;br/&gt;
&lt;br/&gt;
In Oracle CI, this test is also run headless, headless tests are run concurrently but I&amp;#39;m not sure about the number of concurrent tests.&lt;br/&gt;
&lt;br/&gt;
This test creates 6 threads. Seeing such a large number of threads is still weird.&lt;br/&gt;
&lt;br/&gt;
If the background thread reaches listing files, this operation is performed on the COM thread and the background thread is blocked, thus interrupting the background thread will throw InterruptedException and the thread will exit. It will take some time, yet it shouldn&amp;#39;t take too long&#8230; perhaps, the heavy load affects this small part&#8230;</comment>
                            <comment id="14679116" author="azeller" created="Wed, 5 Jun 2024 03:45:26 -0700"  >I can still see the failure on windows in our nightly CI tests. It occurs in about 60% of our test runs. A typical output would be:&lt;br/&gt;
&lt;br/&gt;
Number of snapshots: 20&lt;br/&gt;
Number of snapshots where number of loader threads:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;= 1: 4&lt;br/&gt;
&amp;nbsp;&amp;nbsp;= 2: 4&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;gt; 2: 12&lt;br/&gt;
Duration: 17,467&lt;br/&gt;
&lt;br/&gt;
The highest failure value I have seen was 13, but I only looked at 10 of our failed runs of the last weeks. Our tests run headless and with concurrency equal to the number of CPUs.</comment>
                            <comment id="14672347" author="dukebot" created="Thu, 9 May 2024 11:04:28 -0700"  >Changeset: ffbdfffb&lt;br/&gt;
Author:    Alexey Ivanov &amp;lt;&lt;a href=&apos;mailto:aivanov@openjdk.org&apos;&gt;aivanov@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2024-05-09 18:01:27 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/ffbdfffbc702253f32fa45dc1855b663c72074a6&quot;&gt;https://git.openjdk.org/jdk/commit/ffbdfffbc702253f32fa45dc1855b663c72074a6&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14672288" author="roboduke" created="Thu, 9 May 2024 06:06:23 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/19156&quot;&gt;https://git.openjdk.org/jdk/pull/19156&lt;/a&gt;&lt;br/&gt;
Date: 2024-05-09 13:01:57 +0000</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5132256">JDK-8334609</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5143586">JDK-8343961</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5130633">JDK-8333218</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5130674">JDK-8333257</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5130707">JDK-8333289</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5131008">JDK-8333538</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10001">
                    <name>Cloners</name>
                                            <outwardlinks description="clones">
                                        <issuelink>
            <issuekey id="5128439">JDK-8331494</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5131425">JDK-8333880</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5127951">JDK-8331142</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="19000"><![CDATA[x86_64]]></customfieldvalue>
    <customfieldvalue key="19300"><![CDATA[aarch64]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_10004" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Introduced In Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="23032">23</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17005"><![CDATA[windows]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i36ahn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17433"><![CDATA[b23]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="206"><![CDATA[javax.swing]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10100" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Verification</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17000"><![CDATA[Verified]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>