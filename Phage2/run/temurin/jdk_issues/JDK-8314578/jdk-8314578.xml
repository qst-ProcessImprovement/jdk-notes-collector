<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 10:51:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8314578] Non-verifiable code is emitted when two guards declare pattern variables in colon-switch</title>
                <link>https://bugs.openjdk.org/browse/JDK-8314578</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>Code:&lt;br/&gt;
&lt;br/&gt;
class Test {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;public static void main(String[] args) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;test(1);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;test(&amp;quot;hello&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;record R1() {}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;record R2() {}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;static void test(Object o) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;switch (o) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;case R1() when o instanceof String s:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;case R2() when o instanceof Integer i:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;System.out.println(&amp;quot;hello: &amp;quot; + i);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;break;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;default:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;break;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
Expected: should not be compilable: pattern variables declared in guard should not be visible in the switch label body.&lt;br/&gt;
&lt;br/&gt;
Actual: Compilable (even without preview) and produces VerifyError at runtime:&lt;br/&gt;
&lt;br/&gt;
Exception in thread &amp;quot;main&amp;quot; java.lang.VerifyError: Bad local variable type&lt;br/&gt;
Exception Details:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;Location:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Test.test(Ljava/lang/Object;)V @73: aload_2&lt;br/&gt;
&amp;nbsp;&amp;nbsp;Reason:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Type integer (current frame, locals[2]) is not assignable to reference type&lt;br/&gt;
&amp;nbsp;&amp;nbsp;Current Frame:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;bci: @73&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;flags: { }&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;locals: { &amp;#39;java/lang/Object&amp;#39;, &amp;#39;java/lang/Object&amp;#39;, integer }&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;stack: { &amp;#39;java/io/PrintStream&amp;#39; }&lt;br/&gt;
&amp;nbsp;&amp;nbsp;Bytecode:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0000000: 2a59 b800 1557 4c03 3d2b 1cba 001b 0000&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0000010: ab00 0000 0000 0045 0000 0002 0000 0000&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0000020: 0000 001c 0000 0001 0000 0036 2bc0 001f&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0000030: 4e2a c100 2199 000c 2ac0 0021 3a04 a700&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0000040: 0804 3da7 ffc6 b200 232c ba00 2900 00b6&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0000050: 002d a700 06a7 0003 b1                 &lt;br/&gt;
&amp;nbsp;&amp;nbsp;Stackmap Table:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;append_frame(@9,Object[#2],Integer)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;same_frame(@44)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;append_frame(@65,Object[#31])&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;chop_frame(@70,1)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;same_frame(@85)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;chop_frame(@88,2)&lt;br/&gt;
&lt;br/&gt;
	at java.base/java.lang.Class.forName0(Native Method)&lt;br/&gt;
	at java.base/java.lang.Class.forName(Class.java:537)&lt;br/&gt;
	at java.base/java.lang.Class.forName(Class.java:516)&lt;br/&gt;
	at jdk.compiler/com.sun.tools.javac.launcher.Main.execute(Main.java:432)&lt;br/&gt;
	at jdk.compiler/com.sun.tools.javac.launcher.Main.run(Main.java:208)&lt;br/&gt;
	at jdk.compiler/com.sun.tools.javac.launcher.Main.main(Main.java:135)&lt;br/&gt;
</description>
                <environment></environment>
        <key id="5108380">JDK-8314578</key>
            <summary>Non-verifiable code is emitted when two guards declare pattern variables in colon-switch</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="abimpoudis">Angelos Bimpoudis</assignee>
                                    <reporter username="tvaleev">Tagir Valeev</reporter>
                        <labels>
                            <label>amazon-interest</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                    </labels>
                <created>Fri, 18 Aug 2023 05:00:20 -0700</created>
                <updated>Tue, 9 Jan 2024 09:17:59 -0800</updated>
                            <resolved>Tue, 17 Oct 2023 05:55:13 -0700</resolved>
                                    <version>21</version>
                    <version>22</version>
                                    <fixVersion>22</fixVersion>
                                    <component>tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14634072" author="roboduke" created="Wed, 13 Dec 2023 11:04:32 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/26&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/26&lt;/a&gt;&lt;br/&gt;
Date: 2023-12-13 18:57:05 +0000</comment>
                            <comment id="14634071" author="roboduke" created="Wed, 13 Dec 2023 11:00:22 -0800"  >[jdk21u-fix-request] Approval Request from Aleksey Shipil&amp;#xEB;v&lt;br/&gt;
Clean backport to resolve javac compilation bug. Applies cleanly. Testing passes.</comment>
                            <comment id="14618871" author="dukebot" created="Tue, 17 Oct 2023 05:55:12 -0700"  >Changeset: 15588e08&lt;br/&gt;
Author:    Aggelos Biboudis &amp;lt;&lt;a href=&apos;mailto:abimpoudis@openjdk.org&apos;&gt;abimpoudis@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Committer: Jan Lahoda &amp;lt;&lt;a href=&apos;mailto:jlahoda@openjdk.org&apos;&gt;jlahoda@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-10-17 12:51:57 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/15588e08ed455eac356aa923c35503beaecd5b6d&quot;&gt;https://git.openjdk.org/jdk/commit/15588e08ed455eac356aa923c35503beaecd5b6d&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14615169" author="roboduke" created="Mon, 2 Oct 2023 03:18:38 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/15630&quot;&gt;https://git.openjdk.org/jdk/pull/15630&lt;/a&gt;&lt;br/&gt;
Date: 2023-09-08 09:32:50 +0000</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5117436">JDK-8322396</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5118324">JDK-8323207</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5107967">JDK-8314226</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_10004" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Introduced In Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="22711">21</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i32sj7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17351"><![CDATA[b20]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="212"><![CDATA[javac]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>