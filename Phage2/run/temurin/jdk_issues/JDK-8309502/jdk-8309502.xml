<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 09:15:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8309502] RISC-V: String.indexOf intrinsic may produce misaligned memory loads</title>
                <link>https://bugs.openjdk.org/browse/JDK-8309502</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>I was profiling renaissance&amp;#39;s finagle-http for misaligned memory reads and found few cases in String.indexOf intrinsic.&lt;br/&gt;
&lt;br/&gt;
For example ( trp_lam is a perf event for misaligned read faults):&lt;br/&gt;
&lt;br/&gt;
#&lt;br/&gt;
# Samples: 20K of event &amp;#39;trp_lam&amp;#39;&lt;br/&gt;
# Event count (approx.): 63238&lt;br/&gt;
#&lt;br/&gt;
# Overhead  Command          Shared Object      Symbol                                            &lt;br/&gt;
# ........  ...............  .................  ..................................................&lt;br/&gt;
#&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;84.40%  finagle/netty4-  [JIT] tid 21164    [.] int java.lang.String.indexOf(java.lang.String)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;14.75%  java             [JIT] tid 21164    [.] int java.lang.String.indexOf(java.lang.String)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;0.77%  finagle-http-wo  [JIT] tid 21164    [.] int java.lang.String.indexOf(java.lang.String)&lt;br/&gt;
&lt;br/&gt;
Later I found this also can be partialy reproduced with StringIndexOf.advancedWithMediumSub jmh test&lt;br/&gt;
&lt;br/&gt;
In some cases, String.IndexOf intrinsic performance could be up to 50x times worse than expected. ( on h/w without misaligned access support)</description>
                <environment></environment>
        <key id="5102554">JDK-8309502</key>
            <summary>RISC-V: String.indexOf intrinsic may produce misaligned memory loads</summary>
                <type id="7" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14707&amp;avatarType=issuetype">Enhancement</type>
                                            <priority id="3" iconUrl="https://bugs.openjdk.org/images/jbsImages/p3.png">P3</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="vkempik">Vladimir Kempik</assignee>
                                    <reporter username="vkempik">Vladimir Kempik</reporter>
                        <labels>
                            <label>jdk17u-fix-request</label>
                            <label>jdk17u-fix-yes</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>oraclejdk-na</label>
                            <label>performance</label>
                    </labels>
                <created>Mon, 5 Jun 2023 13:25:16 -0700</created>
                <updated>Tue, 10 Oct 2023 13:48:40 -0700</updated>
                            <resolved>Wed, 14 Jun 2023 23:23:48 -0700</resolved>
                                    <version>21</version>
                    <version>22</version>
                                    <fixVersion>22</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14616675" author="roboduke" created="Mon, 9 Oct 2023 03:07:57 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u-dev/pull/1857&quot;&gt;https://git.openjdk.org/jdk17u-dev/pull/1857&lt;/a&gt;&lt;br/&gt;
Date: 2023-10-08 15:36:53 +0000</comment>
                            <comment id="14616671" author="omikhaltcova" created="Mon, 9 Oct 2023 02:37:07 -0700"  >Fix request (17u)&lt;br/&gt;
&lt;br/&gt;
As it&amp;#39;s mentioned above this fix improves intrinsic performance. The patch applies almost cleanly. This change is related only to RISC-V, no risk for other platforms.</comment>
                            <comment id="14590617" author="vkempik" created="Tue, 20 Jun 2023 07:30:23 -0700"  >Fix Request (21u): This improves intrinsic performance on risc-v platforms without hardware misaligned memory access support. Testing: tier1/tier2. Risc-v only change, no risk for other platforms. Applies clean</comment>
                            <comment id="14590613" author="roboduke" created="Tue, 20 Jun 2023 07:22:13 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u/pull/2&quot;&gt;https://git.openjdk.org/jdk21u/pull/2&lt;/a&gt;&lt;br/&gt;
Date: 2023-06-20 14:15:31 +0000</comment>
                            <comment id="14589496" author="roboduke" created="Wed, 14 Jun 2023 23:39:47 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21/pull/20&quot;&gt;https://git.openjdk.org/jdk21/pull/20&lt;/a&gt;&lt;br/&gt;
Date: 2023-06-15 06:32:21 +0000</comment>
                            <comment id="14589491" author="dukebot" created="Wed, 14 Jun 2023 23:23:47 -0700"  >Changeset: 6b942893&lt;br/&gt;
Author:    Vladimir Kempik &amp;lt;&lt;a href=&apos;mailto:vkempik@openjdk.org&apos;&gt;vkempik@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-06-15 06:22:21 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/6b942893868fa1a64977288bdbdb1bbff8bd9d9c&quot;&gt;https://git.openjdk.org/jdk/commit/6b942893868fa1a64977288bdbdb1bbff8bd9d9c&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14587184" author="roboduke" created="Mon, 5 Jun 2023 13:58:09 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/14320&quot;&gt;https://git.openjdk.org/jdk/pull/14320&lt;/a&gt;&lt;br/&gt;
Date: 2023-06-05 20:52:01 +0000</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5103774">JDK-8310539</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5112080">JDK-8317833</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="20300"><![CDATA[riscv]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17023"><![CDATA[linux]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i31spn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17305"><![CDATA[b03]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="208"><![CDATA[compiler]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>