<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 13:28:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-6914801] IPv6 unavailable if stdin is a socket</title>
                <link>https://bugs.openjdk.org/browse/JDK-6914801</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>FULL PRODUCT VERSION :&lt;br/&gt;
java version &amp;quot;1.6.0_17&amp;quot;&lt;br/&gt;
Java(TM) SE Runtime Environment (build 1.6.0_17-b04)&lt;br/&gt;
Java HotSpot(TM) Server VM (build 14.3-b01, mixed mode)&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
ADDITIONAL OS VERSION INFORMATION :&lt;br/&gt;
Linux xxxxxx.yyyy.com 2.6.18-128.1.14.el5 #1 SMP Mon Jun 1 15:52:58 EDT 2009 x86_64 x86_64 x86_64 GNU/Linux&lt;br/&gt;
Red Hat Enterprise Linux Client release 5.3 (Tikanga)&lt;br/&gt;
(seems to affect all redhat-based linuxes, 32- and 64-bit.  debian-based linuxes seem immune)&lt;br/&gt;
&lt;br/&gt;
EXTRA RELEVANT SYSTEM CONFIGURATION :&lt;br/&gt;
/etc/hosts:&lt;br/&gt;
127.0.0.1	localhost.localdomain	localhost	xxxxxx&lt;br/&gt;
::1	localhost.localdomain	localhost	xxxxxx&lt;br/&gt;
&lt;br/&gt;
/sbin/ifconfig summary:&lt;br/&gt;
eth0      Link encap:Ethernet  HWaddr 00:10:18:34:xx:xx&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;inet addr:10.0.x.x  Bcast:10.0.255.255  Mask:255.255.0.0&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;inet6 addr: fe80::210:18ff:fe34:xxxx/64 Scope:Link&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1&lt;br/&gt;
lo        Link encap:Local Loopback&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;inet addr:127.0.0.1  Mask:255.0.0.0&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;inet6 addr: ::1/128 Scope:Host&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;UP LOOPBACK RUNNING  MTU:16436  Metric:1&lt;br/&gt;
vmnet1    Link encap:Ethernet  HWaddr 00:50:56:C0:00:01&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;inet addr:192.168.223.1  Bcast:192.168.223.255  Mask:255.255.255.0&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;inet6 addr: fe80::250:56ff:fec0:1/64 Scope:Link&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1&lt;br/&gt;
vmnet8    Link encap:Ethernet  HWaddr 00:50:56:C0:00:08&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;inet addr:172.16.244.1  Bcast:172.16.244.255  Mask:255.255.255.0&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;inet6 addr: fe80::250:56ff:fec0:8/64 Scope:Link&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1&lt;br/&gt;
&lt;br/&gt;
A DESCRIPTION OF THE PROBLEM :&lt;br/&gt;
When stdin is connected to a socket (in particular, a FILE socket), IPv6 is completely unavailable in Java.&lt;br/&gt;
&lt;br/&gt;
We noticed that when we invoked java as an immediate command from ssh, as in&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;ssh host &amp;#39;java ClassName&amp;#39;&lt;br/&gt;
it would not talk to certain server software that, due to an obscure DNS configuration, was only listening on the IPv6 loopback (rather than both the IPv4 and IPv6 loopbacks).&lt;br/&gt;
&lt;br/&gt;
For some reason, this seems to affect all the Redhat-based linuxes I have tested (64-bit, 32-bit, and 32-bit vm on 64-bit kernel) and does not seem to affect the Debian-based linuxes I have tested.&lt;br/&gt;
&lt;br/&gt;
STEPS TO FOLLOW TO REPRODUCE THE PROBLEM :&lt;br/&gt;
The easiest way to reproduce the condition of stdin being connected to a FILE socket is to run Java as an immediate command through ssh, like&lt;br/&gt;
$ ssh localhost &amp;#39;java IPv6Test&amp;#39;&lt;br/&gt;
java.net.preferIPv4Stack=null&lt;br/&gt;
IPv6 is not working! Protocol family unavailable&lt;br/&gt;
&lt;br/&gt;
If I use my bash shell to redirect stdin from a file or pipe on the other end, there is no problem:&lt;br/&gt;
$ ssh localhost &amp;#39;java IPv6Test &amp;lt; /dev/null&amp;#39;&lt;br/&gt;
java.net.preferIPv4Stack=null&lt;br/&gt;
IPv6 seems to be working&lt;br/&gt;
$ ssh localhost &amp;#39;echo | java IPv6Test&amp;#39;&lt;br/&gt;
java.net.preferIPv4Stack=null&lt;br/&gt;
IPv6 seems to be working&lt;br/&gt;
&lt;br/&gt;
Or I can use ssh to connect stdin to a pseudo-tty, (mimicking what happens if you log in with ssh):&lt;br/&gt;
$ ssh -t localhost &amp;#39;java IPv6Test&amp;#39;&lt;br/&gt;
java.net.preferIPv4Stack=null&lt;br/&gt;
IPv6 seems to be working&lt;br/&gt;
Connection to localhost closed.&lt;br/&gt;
&lt;br/&gt;
The test class is simple in that it uses a failed connection to determine whether IPv6 is available, but this problem certainly prevents making connections.&lt;br/&gt;
&lt;br/&gt;
EXPECTED VERSUS ACTUAL BEHAVIOR :&lt;br/&gt;
EXPECTED -&lt;br/&gt;
Availability of IPv6 should not depend on what kind of io/file stdin is connected to.&lt;br/&gt;
ACTUAL -&lt;br/&gt;
Availability of IPv6 depends on what kind of io/file stdin is connected to, even when stdin is never read.&lt;br/&gt;
&lt;br/&gt;
ERROR MESSAGES/STACK TRACES THAT OCCUR :&lt;br/&gt;
You can actually see in the strace where it is detecting whether stdin (fd=0) is connected to a socket (or not):&lt;br/&gt;
getsockname(0, {sa_family=AF_FILE, path=&amp;quot;&amp;quot;}, [17150529334688088066]) = 0&lt;br/&gt;
vs.&lt;br/&gt;
getsockname(0, 0xf7f28240, [17148559009851113500]) = -1 ENOTSOCK (Socket operation on non-socket)&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
REPRODUCIBILITY :&lt;br/&gt;
This bug can be reproduced always.&lt;br/&gt;
&lt;br/&gt;
---------- BEGIN SOURCE ----------&lt;br/&gt;
import java.net.*;&lt;br/&gt;
&lt;br/&gt;
public class IPv6Test {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;public static void main(String[] args) throws Exception {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;System.out.println(&amp;quot;java.net.preferIPv4Stack=&amp;quot; + System.getProperty(&amp;quot;java.net.preferIPv4Stack&amp;quot;));&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;try {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;new Socket(&amp;quot;::1&amp;quot;, 29876).close();  // IPv6 loopback, on port unlikely to be listening&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// someone was listening and we connected and closed&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;System.out.println(&amp;quot;IPv6 seems to be working&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;} catch (ConnectException e) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// tried to connect, but no one was listening--what we expect&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;System.out.println(&amp;quot;IPv6 seems to be working&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;} catch (SocketException e) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// some other problem connecting&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;System.out.println(&amp;quot;IPv6 is not working! &amp;quot; + e.getMessage());&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;} catch (UnknownHostException e) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// doesn&amp;#39;t understand IPv6 loopback &amp;quot;::1&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;System.out.println(&amp;quot;IPv6 is not available&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
}&lt;br/&gt;
---------- END SOURCE ----------&lt;br/&gt;
&lt;br/&gt;
CUSTOMER SUBMITTED WORKAROUND :&lt;br/&gt;
With an ssh immediate command, using the -t parameter is a suitable work-around, because it will connect stdin to a pseudo-tty rather than a socket.&lt;br/&gt;
</description>
                <environment></environment>
        <key id="4221527">JDK-6914801</key>
            <summary>IPv6 unavailable if stdin is a socket</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="6" iconUrl="https://bugs.openjdk.org/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="djelinski">Daniel Jelinski</assignee>
                                    <reporter username="ndcosta">Nelson Dcosta</reporter>
                        <labels>
                            <label>webbug</label>
                    </labels>
                <created>Wed, 6 Jan 2010 22:30:06 -0800</created>
                <updated>Fri, 21 Jul 2023 07:34:39 -0700</updated>
                            <resolved>Sun, 8 Jan 2023 23:43:09 -0800</resolved>
                                    <version>6u17</version>
                                    <fixVersion>21</fixVersion>
                                    <component>core-libs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14549500" author="dukebot" created="Sun, 8 Jan 2023 23:43:08 -0800"  >Changeset: 8d17d1ee&lt;br/&gt;
Author:    Daniel Jeli&#324;ski &amp;lt;&lt;a href=&apos;mailto:djelinski@openjdk.org&apos;&gt;djelinski@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-01-09 07:39:12 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/8d17d1ee6f08ee90771d469182aaaaa7c23971fd&quot;&gt;https://git.openjdk.org/jdk/commit/8d17d1ee6f08ee90771d469182aaaaa7c23971fd&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14544732" author="roboduke" created="Mon, 12 Dec 2022 12:51:58 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/11638&quot;&gt;https://git.openjdk.org/jdk/pull/11638&lt;/a&gt;&lt;br/&gt;
Date: 2022-12-12 20:30:05 +0000</comment>
                            <comment id="12163364" author="alanb" created="Thu, 7 Jan 2010 01:15:20 -0800"  >BT2:EVALUATION&lt;br/&gt;
&lt;br/&gt;
The JDK requires all sockets be IPv4 or all sockets be IPv6. It doesn&amp;#39;t support the scenario where some Sockets are IPv4 and others are IPv6 (the only exception is java.nio.channels.DatagramChannel for the purposes of IPv4 multicasting when IPv6 is enabled). The issue we have is that the VM can be launched by inet/xinetd and the peer socket made available to the application via the System.inheritedChannel method. In the ssh case, as stdin is connected to an IPv4 socket, it forces all sockets to be IPv4 (as we can&amp;#39;t support a SocketChannel connected to an IPv4 socket and all other Socket/SocketChannels be connected to an IPv6 socket). One idea is to remove the check during start and allow IPv6 is used. The only implication is likely to be that rmid and others launching java via inetd/xinetd will need to set the preferIPv4Stack property to true as otherwise System.inheritedChannel will return null (due to the protocol family mismatch).</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="4972938">JDK-8211842</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17004"><![CDATA[x86]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10001" key="com.atlassian.jira.plugin.system.customfieldtypes:datetime">
                        <customfieldname>Imported</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 16 Sep 2012 00:54:45 -0700</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10002" key="com.atlassian.jira.plugin.system.customfieldtypes:datetime">
                        <customfieldname>Indexed</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 17 Jul 2012 21:00:24 -0700</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17058"><![CDATA[linux_redhat_5.0]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lfsf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>125031</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17315"><![CDATA[b05]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="193"><![CDATA[java.net]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10100" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Verification</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17000"><![CDATA[Verified]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>