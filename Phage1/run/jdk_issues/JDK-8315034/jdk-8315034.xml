<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 10:53:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8315034] File.mkdirs() occasionally fails to create folders on Windows shared folder</title>
                <link>https://bugs.openjdk.org/browse/JDK-8315034</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>The code below will fail to create the desired folders in the Windows shared folder. It needs to run three processes simultaneously to reproduce the failure scenario quickly.&lt;br/&gt;
The Windows API FindFirestFileW generates the error code ERROR_NO_MORE_FILES for a valid path (possibly due to the compatibility issue with SMB protocol) when JDK is canonicalizing this path. One of the solutions might be to add this error code to &lt;a href=&quot;https://github.com/openjdk/jdk/blob/master/src/java.base/windows/native/libjava/canonicalize_md.c#L131,&quot;&gt;https://github.com/openjdk/jdk/blob/master/src/java.base/windows/native/libjava/canonicalize_md.c#L131,&lt;/a&gt; which will be treated as a handleable error.&lt;br/&gt;
&lt;br/&gt;
public static void main(String[] args) {&lt;br/&gt;
String parentFolder = &amp;quot;\\\\192.168.1.96\\temp&amp;quot;;&lt;br/&gt;
String folderName=&amp;quot;temp&amp;quot;;&lt;br/&gt;
int i =0;&lt;br/&gt;
try{&lt;br/&gt;
while(i&amp;lt;10000) {&lt;br/&gt;
File f = new File(parentFolder+&amp;quot;\\&amp;quot;+folderName+args[0]+i+&amp;quot;\\test&amp;quot;);&lt;br/&gt;
if(!f.mkdirs()) {&lt;br/&gt;
System.out.println(&amp;quot;New folder created===&amp;quot;+i);&lt;br/&gt;
throw new Exception(&amp;quot;folder not created&amp;quot;);&lt;br/&gt;
}&lt;br/&gt;
i++;&lt;br/&gt;
}&lt;br/&gt;
}catch (Exception e){&lt;br/&gt;
System.out.println(args[0]+&amp;quot; failed at &amp;quot;+i);&lt;br/&gt;
e.printStackTrace();&lt;br/&gt;
}&lt;br/&gt;
}&lt;br/&gt;
</description>
                <environment></environment>
        <key id="5108884">JDK-8315034</key>
            <summary>File.mkdirs() occasionally fails to create folders on Windows shared folder</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="wxiao">Weibing Xiao</assignee>
                                    <reporter username="shadowbug">Shadow Bug</reporter>
                        <labels>
                            <label>bugdb_35746005</label>
                            <label>jdk11u-fix-request</label>
                            <label>jdk11u-fix-yes</label>
                            <label>jdk17u-fix-request</label>
                            <label>jdk17u-fix-yes</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>noreg-hard</label>
                    </labels>
                <created>Fri, 25 Aug 2023 07:48:25 -0700</created>
                <updated>Thu, 11 Jul 2024 06:12:15 -0700</updated>
                            <resolved>Thu, 30 Nov 2023 09:36:49 -0800</resolved>
                                    <version>8-pool</version>
                    <version>11</version>
                    <version>17-pool-oracle</version>
                    <version>21.0.3-oracle</version>
                                    <fixVersion>22</fixVersion>
                                    <component>core-libs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="14643973" author="roboduke" created="Fri, 26 Jan 2024 01:32:34 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk11u-dev/pull/2489&quot;&gt;https://git.openjdk.org/jdk11u-dev/pull/2489&lt;/a&gt;&lt;br/&gt;
Date: 2024-01-26 09:26:16 +0000</comment>
                            <comment id="14643972" author="goetz" created="Fri, 26 Jan 2024 01:26:05 -0800"  >Fix request [11u]&lt;br/&gt;
&lt;br/&gt;
I backport this for parity with 11.0.23-oracle.&lt;br/&gt;
Low risk, small fix, windows only.&lt;br/&gt;
Clean backport. &lt;br/&gt;
SAP nightly testing passed.</comment>
                            <comment id="14636165" author="roboduke" created="Fri, 22 Dec 2023 00:22:55 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u-dev/pull/2079&quot;&gt;https://git.openjdk.org/jdk17u-dev/pull/2079&lt;/a&gt;&lt;br/&gt;
Date: 2023-12-22 08:17:31 +0000</comment>
                            <comment id="14636164" author="roboduke" created="Fri, 22 Dec 2023 00:22:27 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/92&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/92&lt;/a&gt;&lt;br/&gt;
Date: 2023-12-22 08:17:45 +0000</comment>
                            <comment id="14636162" author="goetz" created="Fri, 22 Dec 2023 00:16:42 -0800"  >Fix request [17u,21u]&lt;br/&gt;
&lt;br/&gt;
I backport this for parity with 17.0.11-oracle/21.0.3-oracle.&lt;br/&gt;
Low risk, small fix, windows only.&lt;br/&gt;
Clean backport.&lt;br/&gt;
SAP nightly tessting passed.</comment>
                            <comment id="14630398" author="dukebot" created="Thu, 30 Nov 2023 09:36:48 -0800"  >Changeset: 7ad70059&lt;br/&gt;
Author:    Weibing Xiao &amp;lt;&lt;a href=&apos;mailto:weibing.xiao@oracle.com&apos;&gt;weibing.xiao@oracle.com&lt;/a&gt;&amp;gt;&lt;br/&gt;
Committer: Brian Burkhalter &amp;lt;&lt;a href=&apos;mailto:bpb@openjdk.org&apos;&gt;bpb@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-11-30 17:34:49 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/7ad700596fbc58c27fedfa46755e80ea57712fac&quot;&gt;https://git.openjdk.org/jdk/commit/7ad700596fbc58c27fedfa46755e80ea57712fac&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14630318" author="roboduke" created="Thu, 30 Nov 2023 06:22:07 -0800"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/16502&quot;&gt;https://git.openjdk.org/jdk/pull/16502&lt;/a&gt;&lt;br/&gt;
Date: 2023-11-03 18:11:10 +0000</comment>
                            <comment id="14627651" author="JIRAUSER20102" created="Mon, 20 Nov 2023 08:01:16 -0800"  >This issue can be reproduced with 2 Windows 2019 servers - one used to run the code, and another one to host the shared folder. Start at least 3 command prompts to run the attached Java sample code.&lt;br/&gt;
Note: If only one Java process executes the code, the problem does not occur.</comment>
                            <comment id="14611309" author="JIRAUSER20102" created="Thu, 14 Sep 2023 12:57:18 -0700"  >In summary, using the following code, run this code simultaneously in three separate command lines in Windows. The bug can be recreated easily. Please it will only fail when a shared folder in a remote machine.&lt;br/&gt;
&lt;br/&gt;
It is the failure of Windows API FindFirstFileW. It would not be able to handle the path properly and return INVALID_HANDLE_VALUE. Files::createDirectoires can be used to replace File::mkdirs. &lt;br/&gt;
&lt;br/&gt;
public static void main(String[] args) {&lt;br/&gt;
&lt;br/&gt;
		String parentFolder = &amp;quot;\\\\192.168.1.96\\javabugs&amp;quot;;&lt;br/&gt;
&lt;br/&gt;
		String folderName=&amp;quot;temp&amp;quot;;&lt;br/&gt;
&lt;br/&gt;
		int i =0;&lt;br/&gt;
&lt;br/&gt;
		try{&lt;br/&gt;
			while(i&amp;lt;10000) {&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
			File f = new File(parentFolder+&amp;quot;\\&amp;quot;+folderName+args[0]+i+&amp;quot;\\test&amp;quot;);&lt;br/&gt;
&lt;br/&gt;
			if(!f.mkdirs()) {&lt;br/&gt;
&lt;br/&gt;
				System.out.println(&amp;quot;New folder created===&amp;quot;+i);&lt;br/&gt;
&lt;br/&gt;
				throw new Exception(&amp;quot;folder not created&amp;quot;);&lt;br/&gt;
&lt;br/&gt;
			} &lt;br/&gt;
&lt;br/&gt;
				i++;&lt;br/&gt;
&lt;br/&gt;
			}&lt;br/&gt;
&lt;br/&gt;
		}catch (Exception e){&lt;br/&gt;
&lt;br/&gt;
			System.out.println(args[0]+&amp;quot; failed at &amp;quot;+i);&lt;br/&gt;
&lt;br/&gt;
			e.printStackTrace();&lt;br/&gt;
&lt;br/&gt;
		}&lt;br/&gt;
&lt;br/&gt;
	}</comment>
                            <comment id="14610423" author="JIRAUSER20102" created="Tue, 12 Sep 2023 07:46:25 -0700"  >It is the failure of FindFirstFileW. See the spec from MS at &lt;a href=&quot;https://learn.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-findfirstfilew&quot;&gt;https://learn.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-findfirstfilew&lt;/a&gt;.&lt;br/&gt;
&lt;br/&gt;
Files::createDirectories is using CreateDirectoryW (&lt;a href=&quot;https://learn.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-createdirectoryw&quot;&gt;https://learn.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-createdirectoryw&lt;/a&gt;). Using this API, runing the code several times, it created parent folder and sub folder, never failed.&lt;br/&gt;
&lt;br/&gt;
</comment>
                            <comment id="14609400" author="alanb" created="Wed, 6 Sep 2023 23:24:03 -0700"  >Which win32 call is failing with &amp;quot;There are no more files&amp;quot;?</comment>
                            <comment id="14609190" author="alanb" created="Wed, 6 Sep 2023 06:13:41 -0700"  >File.mkdir and Files.createDirectory both use the win32 CreateDirectory call but the former does not report exceptions. Files::createDiretories (to create a tree) is more tolerant of another program (or thread in the same VM) doing the same thing - this might be why mkdirs is failing.</comment>
                            <comment id="14609186" author="JIRAUSER20102" created="Wed, 6 Sep 2023 06:00:34 -0700"  >Run Java code in Windows 11 home and the shared folder was located in Windows 10 Pro. The bug was duplicated by running this code simultaneously in three different command line windows.&lt;br/&gt;
&lt;br/&gt;
Using Files::createDiretories instead and run the code in the same situation. Run twice, never failed. </comment>
                            <comment id="14606640" author="alanb" created="Fri, 25 Aug 2023 07:59:23 -0700"  >It would be useful if the test could be changed to use Files.createDirectory as that will throw an IOException if it fails, thus revealing the underlying error.</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5115944">JDK-8321188</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5116069">JDK-8321295</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5116070">JDK-8321296</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5117784">JDK-8322730</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5117785">JDK-8322731</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5120331">JDK-8324947</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5004710">JDK-8234363</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17005"><![CDATA[windows]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i32vn7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17419"><![CDATA[b27]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="244"><![CDATA[java.io]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>