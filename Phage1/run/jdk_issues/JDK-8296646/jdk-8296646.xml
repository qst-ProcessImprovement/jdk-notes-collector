<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 14:21:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8296646] com/sun/jdi/JdbLastErrorTest.java  test failure</title>
                <link>https://bugs.openjdk.org/browse/JDK-8296646</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>Occasional failures since this test for &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8292302&quot; title=&quot;Windows GetLastError value overwritten by ThreadLocalStorage::thread&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8292302&quot;&gt;&lt;strike&gt;JDK-8292302&lt;/strike&gt;&lt;/a&gt; was added (ignoring the failures when -Xcomp was in use).&lt;br/&gt;
The failure seen was not with -Xint or -Xcomp.&lt;br/&gt;
</description>
                <environment></environment>
        <key id="5087127">JDK-8296646</key>
            <summary>com/sun/jdi/JdbLastErrorTest.java  test failure</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kevinw">Kevin Walls</assignee>
                                    <reporter username="kevinw">Kevin Walls</reporter>
                        <labels>
                            <label>intermittent</label>
                            <label>tier3</label>
                            <label>tier6</label>
                    </labels>
                <created>Wed, 9 Nov 2022 01:24:54 -0800</created>
                <updated>Wed, 12 Apr 2023 07:27:41 -0700</updated>
                            <resolved>Tue, 7 Feb 2023 02:15:58 -0800</resolved>
                                    <version>20</version>
                    <version>21</version>
                                    <fixVersion>21</fixVersion>
                                    <component>core-svc</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14557977" author="dcubed" created="Tue, 7 Feb 2023 07:10:04 -0800"  >The fix for this bug is integrated in jdk-21+9-659.</comment>
                            <comment id="14557918" author="dukebot" created="Tue, 7 Feb 2023 02:15:56 -0800"  >Changeset: c61a3821&lt;br/&gt;
Author:    Kevin Walls &amp;lt;&lt;a href=&apos;mailto:kevinw@openjdk.org&apos;&gt;kevinw@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-02-07 10:14:37 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/c61a38212e8d7ab8d9ece4c414dddd5032bfd6aa&quot;&gt;https://git.openjdk.org/jdk/commit/c61a38212e8d7ab8d9ece4c414dddd5032bfd6aa&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14557526" author="roboduke" created="Mon, 6 Feb 2023 06:55:59 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/12441&quot;&gt;https://git.openjdk.org/jdk/pull/12441&lt;/a&gt;&lt;br/&gt;
Date: 2023-02-06 14:24:51 +0000</comment>
                            <comment id="14557291" author="kevinw" created="Fri, 3 Feb 2023 14:49:46 -0800"  >The failure with -XX:+UseSerialGC:&lt;br/&gt;
&lt;br/&gt;
In the test test/jdk/com/sun/jdi/JdbLastErrorTest.java it checks for:&lt;br/&gt;
&lt;br/&gt;
new OutputAnalyzer(jdb.getJdbOutput()).shouldMatch(&amp;quot;The application exited&amp;quot;);&lt;br/&gt;
new OutputAnalyzer(jdb.getJdbOutput()).shouldNotMatch(&amp;quot;failed, lastError = &amp;quot;);&lt;br/&gt;
&lt;br/&gt;
However in some logs we are seeing:&lt;br/&gt;
[jdb] The application has been disconnected&lt;br/&gt;
&lt;br/&gt;
..so we fail!&lt;br/&gt;
&lt;br/&gt;
This depends whether a vmDeathEvent or a vmDisconnectEvent happens, and is not key to the test, as long as we don&amp;#39;t see the &amp;quot;failed, lastError = &amp;quot; and we do see the saved VALUE printed.&lt;br/&gt;
&lt;br/&gt;
Other failures with -XX:+UseZGC:&lt;br/&gt;
&lt;br/&gt;
These fail on the first iteration, so don&amp;#39;t print any retrieved last error values.&lt;br/&gt;
I can reproduce occasional such failures with ZGC, a batch of tests may take 60 iterations to fail, or only one.&lt;br/&gt;
Not managed to get a native stacktrace, but as they always fail on the first iteration (and then work), it seems most likely that as we saw before, some VM work or resolution is needed, and makes a Windows system or library call that happens in the context of the app thread, resettting our last error value.  Once &amp;quot;warmed up&amp;quot;, I never see the issue.&lt;br/&gt;
&lt;br/&gt;
What this test does is on the edge of what is expected to work.  The Panama access to Windows&amp;#39; last error can of course be interrupted by VM work that changes the last error value, but it does generally work.  Not having the test at all is one option, but skipping with ZGC is also reasonable as you don&amp;#39;t really _have_ to step through panama code with ZGC.</comment>
                            <comment id="14547638" author="dcubed" created="Fri, 23 Dec 2022 06:36:50 -0800"  >Here&amp;#39;s a log file snippet from the jdk-21+4-138-tier3 sighting:&lt;br/&gt;
&lt;br/&gt;
com/sun/jdi/JdbLastErrorTest.java&lt;br/&gt;
&lt;br/&gt;
----------System.out:(22/2958)*----------&lt;br/&gt;
Command line: [c:\\ade\\mesos\\work_dir\\jib-master\\install\\jdk-21+4-138\\windows-x64-debug.jdk\\jdk-21\\fastdebug\\bin\\java.exe -cp C:\\sb\\prod\\1671804745\\testoutput\\test-support\\jtreg_open_test_jdk_jdk_jdi\\classes\\1\\com\\sun\\jdi\\JdbLastErrorTest.d;C:\\ade\\mesos\\work_dir\\jib-master\\install\\jdk-21+4-138\\src.full\\open\\test\\jdk\\com\\sun\\jdi;C:\\sb\\prod\\1671804745\\testoutput\\test-support\\jtreg_open_test_jdk_jdk_jdi\\classes\\1\\test\\lib;C:\\ade\\mesos\\work_dir\\jib-master\\install\\jdk-21+4-138\\src.full\\open\\test\\lib;C:\\ade\\mesos\\work_dir\\jib-master\\install\\jtreg\\7.1.1\\1\\bundles\\jtreg-7.1.1+1.zip\\jtreg\\lib\\jtreg.jar -Xmx768m -XX:MaxRAMPercentage=4.16667 -Dtest.boot.jdk=c:\\ade\\mesos\\work_dir\\jib-master\\install\\jdk\\19\\36\\bundles\\windows-x64\\jdk-19_windows-x64_bin.zip\\jdk-19 -Djava.io.tmpdir=c:\\sb\\prod\\1671804745\\testoutput\\test-support\\jtreg_open_test_jdk_jdk_jdi\\tmp -ea -esa -XX:+CreateCoredumpOnCrash -XX:+UseZGC --enable-preview -agentlib:jdwp=transport=dt_socket,server=y,suspend=y TestNativeLastError ]&lt;br/&gt;
[debuggee]:c:\\ade\\mesos\\work_dir\\jib-master\\install\\jdk-21+4-138\\windows-x64-debug.jdk\\jdk-21\\fastdebug\\bin\\java.exe -cp C:\\sb\\prod\\1671804745\\testoutput\\test-support\\jtreg_open_test_jdk_jdk_jdi\\classes\\1\\com\\sun\\jdi\\JdbLastErrorTest.d;C:\\ade\\mesos\\work_dir\\jib-master\\install\\jdk-21+4-138\\src.full\\open\\test\\jdk\\com\\sun\\jdi;C:\\sb\\prod\\1671804745\\testoutput\\test-support\\jtreg_open_test_jdk_jdk_jdi\\classes\\1\\test\\lib;C:\\ade\\mesos\\work_dir\\jib-master\\install\\jdk-21+4-138\\src.full\\open\\test\\lib;C:\\ade\\mesos\\work_dir\\jib-master\\install\\jtreg\\7.1.1\\1\\bundles\\jtreg-7.1.1+1.zip\\jtreg\\lib\\jtreg.jar -Xmx768m -XX:MaxRAMPercentage=4.16667 -Dtest.boot.jdk=c:\\ade\\mesos\\work_dir\\jib-master\\install\\jdk\\19\\36\\bundles\\windows-x64\\jdk-19_windows-x64_bin.zip\\jdk-19 -Djava.io.tmpdir=c:\\sb\\prod\\1671804745\\testoutput\\test-support\\jtreg_open_test_jdk_jdk_jdi\\tmp -ea -esa -XX:+CreateCoredumpOnCrash -XX:+UseZGC --enable-preview -agentlib:jdwp=transport=dt_socket,server=y,suspend=y TestNativeLastError&lt;br/&gt;
[debuggee] Listening for transport dt_socket at address: 50503&lt;br/&gt;
[jdb] Set uncaught java.lang.Throwable&lt;br/&gt;
[jdb] Set deferred uncaught java.lang.Throwable&lt;br/&gt;
[jdb] Initializing jdb ...&lt;br/&gt;
[jdb] &lt;br/&gt;
[jdb] VM Started: &amp;gt; No frames on the current call stack&lt;br/&gt;
[jdb] &lt;br/&gt;
[jdb] main[1] &lt;br/&gt;
&amp;gt; run &lt;br/&gt;
[debuggee] 0&lt;br/&gt;
[jdb] &amp;gt; &lt;br/&gt;
[jdb] Exception occurred: java.lang.RuntimeException (uncaught)&amp;quot;thread=main&amp;quot;, TestNativeLastError.testWindows(), line=68 bci=137&lt;br/&gt;
[jdb] 68                    throw new RuntimeException(&amp;quot;failed, lastError = &amp;quot; + lastError);&lt;br/&gt;
[jdb] &lt;br/&gt;
[jdb] main[1] &lt;br/&gt;
=======================================&lt;br/&gt;
Exception thrown during test execution: &amp;#39;The application exited&amp;#39; missing from stdout/stderr&lt;br/&gt;
=======================================&lt;br/&gt;
&amp;gt; quit&lt;br/&gt;
[debuggee] Listening for transport dt_socket at address: 50509&lt;br/&gt;
----------System.err:(46/2235)----------&lt;br/&gt;
[debuggee] WARNING: A restricted method in java.lang.foreign.Linker has been called&lt;br/&gt;
[debuggee] WARNING: java.lang.foreign.Linker::nativeLinker has been called by the unnamed module&lt;br/&gt;
[debuggee] WARNING: Use --enable-native-access=ALL-UNNAMED to avoid a warning for this module&lt;br/&gt;
&amp;nbsp;stdout: [Set uncaught java.lang.Throwable&lt;br/&gt;
Set deferred uncaught java.lang.Throwable&lt;br/&gt;
Initializing jdb ...&lt;br/&gt;
&lt;br/&gt;
VM Started: &amp;gt; No frames on the current call stack&lt;br/&gt;
&lt;br/&gt;
main[1] &lt;br/&gt;
&amp;gt; &lt;br/&gt;
Exception occurred: java.lang.RuntimeException (uncaught)&amp;quot;thread=main&amp;quot;, TestNativeLastError.testWindows(), line=68 bci=137&lt;br/&gt;
68                    throw new RuntimeException(&amp;quot;failed, lastError = &amp;quot; + lastError);&lt;br/&gt;
&lt;br/&gt;
main[1] ];&lt;br/&gt;
&amp;nbsp;stderr: [Set uncaught java.lang.Throwable&lt;br/&gt;
Set deferred uncaught java.lang.Throwable&lt;br/&gt;
Initializing jdb ...&lt;br/&gt;
&lt;br/&gt;
VM Started: &amp;gt; No frames on the current call stack&lt;br/&gt;
&lt;br/&gt;
main[1] &lt;br/&gt;
&amp;gt; &lt;br/&gt;
Exception occurred: java.lang.RuntimeException (uncaught)&amp;quot;thread=main&amp;quot;, TestNativeLastError.testWindows(), line=68 bci=137&lt;br/&gt;
68                    throw new RuntimeException(&amp;quot;failed, lastError = &amp;quot; + lastError);&lt;br/&gt;
&lt;br/&gt;
main[1] ]&lt;br/&gt;
&amp;nbsp;exitValue = -1&lt;br/&gt;
&lt;br/&gt;
[debuggee] Exception in thread &amp;quot;main&amp;quot; java.lang.RuntimeException: failed, lastError = 0&lt;br/&gt;
[debuggee] 	at TestNativeLastError.testWindows(JdbLastErrorTest.java:68)&lt;br/&gt;
[debuggee] 	at TestNativeLastError.main(JdbLastErrorTest.java:49)&lt;br/&gt;
java.lang.RuntimeException: &amp;#39;The application exited&amp;#39; missing from stdout/stderr&lt;br/&gt;
	at jdk.test.lib.process.OutputAnalyzer.shouldMatch(OutputAnalyzer.java:340)&lt;br/&gt;
	at JdbLastErrorTest.runCases(JdbLastErrorTest.java:95)&lt;br/&gt;
	at lib.jdb.JdbTest.run(JdbTest.java:96)&lt;br/&gt;
	at JdbLastErrorTest.main(JdbLastErrorTest.java:79)&lt;br/&gt;
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)&lt;br/&gt;
	at java.base/java.lang.reflect.Method.invoke(Method.java:578)&lt;br/&gt;
	at com.sun.javatest.regtest.agent.MainWrapper$MainThread.run(MainWrapper.java:125)&lt;br/&gt;
	at java.base/java.lang.Thread.run(Thread.java:1623)&lt;br/&gt;
&lt;br/&gt;
JavaTest Message: Test threw exception: java.lang.RuntimeException: &amp;#39;The application exited&amp;#39; missing from stdout/stderr&lt;br/&gt;
JavaTest Message: shutting down test&lt;br/&gt;
&lt;br/&gt;
STATUS:Failed.`main&amp;#39; threw exception: java.lang.RuntimeException: &amp;#39;The application exited&amp;#39; missing from stdout/stderr&lt;br/&gt;
----------rerun:(47/5793)*----------</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5098300">JDK-8305913</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2z6p7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17336"><![CDATA[b09]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="370"><![CDATA[debugger]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>