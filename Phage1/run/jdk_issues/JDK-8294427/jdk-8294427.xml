<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 09:56:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8294427] Check boxes and radio buttons have rendering issues on Windows in High DPI env</title>
                <link>https://bugs.openjdk.org/browse/JDK-8294427</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>Check boxes and radio buttons in Windows Look-and-Feel have rendering issues when window is moved from display with one scale to display with a different scale on a multi-monitor setup:&lt;br/&gt;
&lt;br/&gt;
- Scrawly ticks in checkboxes;&lt;br/&gt;
- Wrong circle relations in selected radio buttons.</description>
                <environment></environment>
        <key id="5084200">JDK-8294427</key>
            <summary>Check boxes and radio buttons have rendering issues on Windows in High DPI env</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://bugs.openjdk.org/images/jbsImages/p3.png">P3</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rmahajan">Rajat Mahajan</assignee>
                                    <reporter username="shadowbug">Shadow Bug</reporter>
                        <labels>
                            <label>11bpr-critical-approved</label>
                            <label>bugdb_34641530</label>
                            <label>cssn22_12_01</label>
                            <label>cssn22_12_02</label>
                            <label>cssn23_01_01</label>
                            <label>cssn23_01_02</label>
                            <label>cssn23_02_01</label>
                            <label>cssn23_02_02</label>
                            <label>cssn23_03_01</label>
                            <label>cssn23_03_02</label>
                            <label>cssn23_04_01</label>
                            <label>cssn23_04_02</label>
                            <label>hidpi</label>
                            <label>jdk11u-fix-request</label>
                            <label>jdk11u-fix-yes</label>
                            <label>jdk17u-fix-request</label>
                            <label>jdk17u-fix-yes</label>
                            <label>jdk21u-fix-SQE-ok-next</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>sustaining</label>
                    </labels>
                <created>Mon, 26 Sep 2022 23:38:11 -0700</created>
                <updated>Tue, 2 Sep 2025 05:54:42 -0700</updated>
                            <resolved>Wed, 26 Jul 2023 16:36:51 -0700</resolved>
                                    <version>11</version>
                    <version>17</version>
                    <version>19</version>
                    <version>20</version>
                                    <fixVersion>17.0.10-oracle</fixVersion>
                                    <component>client-libs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>11</watches>
                                                                                                                <comments>
                            <comment id="14633180" author="serb" created="Mon, 11 Dec 2023 09:20:52 -0800"  >The patch caused a regression: &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8321151&quot;&gt;https://bugs.openjdk.org/browse/JDK-8321151&lt;/a&gt;</comment>
                            <comment id="14627098" author="JIRAUSER20917" created="Thu, 16 Nov 2023 21:46:04 -0800"  >Fix request [11u]&lt;br/&gt;
&lt;br/&gt;
I backport this for parity with 11.0.22-oracle.&lt;br/&gt;
Medium risk, small code change.&lt;br/&gt;
SAP nightly testing passed.</comment>
                            <comment id="14624741" author="roboduke" created="Tue, 7 Nov 2023 22:23:29 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk11u-dev/pull/2273&quot;&gt;https://git.openjdk.org/jdk11u-dev/pull/2273&lt;/a&gt;&lt;br/&gt;
Date: 2023-11-08 06:17:31 +0000</comment>
                            <comment id="14612446" author="goetz" created="Wed, 20 Sep 2023 00:09:33 -0700"  >Yes, Rajat has already addressed this.</comment>
                            <comment id="14612412" author="clanger" created="Tue, 19 Sep 2023 22:10:56 -0700"  >This should be backported to jdk21u as well.</comment>
                            <comment id="14611423" author="roboduke" created="Fri, 15 Sep 2023 00:59:12 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u-dev/pull/1744&quot;&gt;https://git.openjdk.org/jdk17u-dev/pull/1744&lt;/a&gt;&lt;br/&gt;
Date: 2023-09-15 07:50:48 +0000</comment>
                            <comment id="14611420" author="goetz" created="Fri, 15 Sep 2023 00:51:19 -0700"  >Fix request [17u]&lt;br/&gt;
&lt;br/&gt;
I backport this for parity with 17.0.10-oracle.&lt;br/&gt;
Medium risk, bigger change in awt coding.&lt;br/&gt;
Trivial resolves needed.&lt;br/&gt;
SAP nightly testing passed.&lt;br/&gt;
</comment>
                            <comment id="14610183" author="roboduke" created="Mon, 11 Sep 2023 11:44:21 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u/pull/152&quot;&gt;https://git.openjdk.org/jdk21u/pull/152&lt;/a&gt;&lt;br/&gt;
Date: 2023-09-11 18:36:21 +0000</comment>
                            <comment id="14610182" author="rmahajan" created="Mon, 11 Sep 2023 11:43:37 -0700"  >Fix request (21u)&lt;br/&gt;
Clean backport. This change ensures checkboxes and radio buttons are rendered crisply when window is moved from a High DPI display with one scale to a display with a different scale on a multi-monitor setup.&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;https://github.com/openjdk/jdk21u/pull/152&quot;&gt;https://github.com/openjdk/jdk21u/pull/152&lt;/a&gt;</comment>
                            <comment id="14594217" author="aivanov" created="Thu, 6 Jul 2023 03:41:50 -0700"  >[~rmahajan] You forgot to change the fix version of the mainline. Because of it, the mainline fix is in a backport record.</comment>
                            <comment id="14577498" author="roboduke" created="Thu, 27 Apr 2023 12:31:24 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/13701&quot;&gt;https://git.openjdk.org/jdk/pull/13701&lt;/a&gt;&lt;br/&gt;
Date: 2023-04-27 19:25:55 +0000</comment>
                            <comment id="14574783" author="rmahajan" created="Tue, 18 Apr 2023 11:13:14 -0700"  >I have cleaned up the code changes and testing locally, as well on mach5.&lt;br/&gt;
Will send it for code review as a next step.&lt;br/&gt;
&lt;br/&gt;
Summarizing the changes for the Fix:&lt;br/&gt;
Open a new Theme Handle per the DPI of the Screen where the App window is.&lt;br/&gt;
This helps make sure we get correct size for UI buttons based on the DPI from windows.&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&lt;br/&gt;
2. GetPartSize() of icons returns size based on standard size = 96 DPI&lt;br/&gt;
This change makes sure that the default size of UI buttons is 96 since we use this on Java side to do our Scaling calculations.&lt;br/&gt;
&lt;br/&gt;
3. Rect size for icons in native paintBackground() function is in accordance with what windows returns for that specific DPI. 	&lt;br/&gt;
This helps make sure that the UI buttons are scaled correctly once we get their size back from Windows.&lt;br/&gt;
&lt;br/&gt;
4. Adjust width and the height of the resolution variant image so that for scaling values   of  1.25 , 2.25 , and such we  always  floor ,while for 1.5, 1.75, 2.5, 2.75 , and such we always ceil.  	 &lt;br/&gt;
This helps make sure that for .25s scaling we get crisp rendering. This is because when we go from Double to Int for pixel rendering we sometimes need to floor or ceil to get crisp rendering.&lt;br/&gt;
</comment>
                            <comment id="14559375" author="rmahajan" created="Sun, 12 Feb 2023 20:35:54 -0800"  >As of now I have added code to open themes for radio button and check boxes&lt;br/&gt;
based on DPI&lt;br/&gt;
of the monitor where the window is.&lt;br/&gt;
Also, added code changes so getPartSize() and other related functions always&lt;br/&gt;
use 96 DPI.&lt;br/&gt;
This is done so we don&amp;#39;t have to rescale the parts underneath in getPartSize&lt;br/&gt;
in Native code.&lt;br/&gt;
After this I see crisp rendering of radio buttons and checkboxes with 100%,&lt;br/&gt;
150%, 200% scaling but not&lt;br/&gt;
with 125%, 175%, 225%, etc.&lt;br/&gt;
This is true for both Primary and Secondary monitor.&lt;br/&gt;
There is code in CachedPainter which seems to be double scaling causing the&lt;br/&gt;
above issue.</comment>
                            <comment id="14546214" author="rmahajan" created="Fri, 16 Dec 2022 17:56:28 -0800"  >Debug update:&lt;br/&gt;
&lt;br/&gt;
We always call OpenThemeData() on a AwtToolKit window since it is hardcoded in there. This specific window is always created on Primary monitor and stays there. So, even when the app window is moved to Secondary monitor with different DPI and we send WM_THEME changed message in response to the DPI change , it still keeps the same theme due to the them being opened for the same AwtToolKit window. This is the reason why getPartSize() calculates the incorrect size (according to primary monitor DPI) of checkboxs/radio buttons etc., and hence they are not scaled correctly on secondary monitor. &lt;br/&gt;
&lt;br/&gt;
So, currently I am looking into how to get the handle for the app window and open theme on it to make sure that everything is correctly scaled.&lt;br/&gt;
&lt;br/&gt;
Also, I have added code in awt_Component to check for WM_GETDPISCALEDSIZE message and send WM_THEMECHANGED message in response to that. &lt;br/&gt;
Currently I am broadcasting this message to all windows for testing my logic,  but will narrow it down to app window only as a next step.&lt;br/&gt;
</comment>
                            <comment id="14544293" author="rmahajan" created="Fri, 9 Dec 2022 10:30:56 -0800"  >In Java_sun_awt_windows_ThemeReader_getPartSize() in ThemeReader.cpp, &lt;br/&gt;
rescale() function is called on checkbox&amp;#39;s/radio button&amp;#39;s size to calculate&lt;br/&gt;
correctly scaled size of these, and that is where the issue seems to arise from.&lt;br/&gt;
&lt;br/&gt;
In rescale(), we calculate the DPI based on the screen where the window is. &lt;br/&gt;
For example when the application sets scaling to 1.75, we still calculate the DPI as 144(since my&lt;br/&gt;
monitor has 150% scaling) instead of 168 and scale incorrectly thus. &lt;br/&gt;
If I change it to 168(hard-code) in this function I see checkbox and radio-button rendered correctly&lt;br/&gt;
with 1.75 scaling.&lt;br/&gt;
&lt;br/&gt;
Trying to figure out what API can we use to correctly set the DPI/Scaling in rescale() function so as to match what the application is setting.&lt;br/&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5104355">JDK-8311070</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5106815">JDK-8313266</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5110655">JDK-8316575</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5110867">JDK-8316759</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5111494">JDK-8317319</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5112036">JDK-8317794</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5115053">JDK-8320388</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5107985">JDK-8314238</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10600">
                    <name>Causes</name>
                                            <outwardlinks description="causes">
                                        <issuelink>
            <issuekey id="5117067">JDK-8322135</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5115903">JDK-8321151</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="4972040">JDK-8211715</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5104918">JDK-8311585</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17005"><![CDATA[windows]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2yp7v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17304"><![CDATA[b01]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="206"><![CDATA[javax.swing]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>