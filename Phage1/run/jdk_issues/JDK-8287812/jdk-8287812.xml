<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 13:58:09 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8287812] Cleanup JDWP agent GetEnv initialization</title>
                <link>https://bugs.openjdk.org/browse/JDK-8287812</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>3 things to cleanup in this area:&lt;br/&gt;
&lt;br/&gt;
(1)  The JDWP agent uses JNI GetEnv(JVMTI_VERSION_1) to get a JVMTI environment. If GetEnv fails the JDWP agent prints this:&lt;br/&gt;
&lt;br/&gt;
ERROR: JDWP unable to access JVMTI Version 1 (0x30010000), is your J2SE a 1.5 or newer version? JNIEnv&amp;#39;s GetEnv() returned -3&lt;br/&gt;
&lt;br/&gt;
The text &amp;quot;is your J2SE a 1.5 or newer version?&amp;quot; dates from JDK 5 when JVMTI was introduced and doesn&amp;#39;t make sense now.&lt;br/&gt;
&lt;br/&gt;
(2) JVMTI_VERSION_1 suggests that the JDWP agent is looking for a JVMTI v1 environment when it really wants the latest. GetEnv should request JVMTI_VERSION so that it always requests the current version.&lt;br/&gt;
&lt;br/&gt;
(3) There is some outdated compatibility checking between runtime and compile time versions of JVMTI that date back to the 1.0, 1.1, and 1.2 era, and are no longer needed.</description>
                <environment></environment>
        <key id="5076200">JDK-8287812</key>
            <summary>Cleanup JDWP agent GetEnv initialization</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cjplummer">Chris Plummer</assignee>
                                    <reporter username="alanb">Alan Bateman</reporter>
                        <labels>
                    </labels>
                <created>Fri, 3 Jun 2022 08:26:44 -0700</created>
                <updated>Wed, 21 Dec 2022 17:16:24 -0800</updated>
                            <resolved>Wed, 14 Dec 2022 11:39:32 -0800</resolved>
                                    <version>19</version>
                                    <fixVersion>21</fixVersion>
                                    <component>core-svc</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14545498" author="dukebot" created="Wed, 14 Dec 2022 11:39:31 -0800"  >Changeset: ccb94acc&lt;br/&gt;
Author:    Chris Plummer &amp;lt;&lt;a href=&apos;mailto:cjplummer@openjdk.org&apos;&gt;cjplummer@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2022-12-14 19:37:20 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/ccb94acc442767a7047756806c8dc7ecacd8bae9&quot;&gt;https://git.openjdk.org/jdk/commit/ccb94acc442767a7047756806c8dc7ecacd8bae9&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14544051" author="roboduke" created="Thu, 8 Dec 2022 15:20:43 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/11602&quot;&gt;https://git.openjdk.org/jdk/pull/11602&lt;/a&gt;&lt;br/&gt;
Date: 2022-12-08 22:40:57 +0000</comment>
                            <comment id="14542119" author="alanb" created="Thu, 1 Dec 2022 23:49:59 -0800"  >The JDWP agent used JVMDI to JDK 1.4 and was re-implemented to use JVMTI in JDK 1.5. It might be that some of this dates from there too but I haven&amp;#39;t checked the history to be sure. Also theory is that it dates back to the JDK vs. JRE where someone might want to debug with a JRE. In any case, I think it&amp;#39;s all history and we just have two scenarios right now: One is the minimal VM which does not have JVMTI. The other is  -XX:-VMContinuations --enable-preview, which on JDK 19/20 at least. In both cases we get the confusing error if there is an attempt to start the debugger agent.</comment>
                            <comment id="14542079" author="cjplummer" created="Thu, 1 Dec 2022 20:52:04 -0800"  >There what I believe is very bit rotted code in this area. See compatible_versions(). It seems to do a lot of special compatibility checks related to 1.1 (maybe earlier) and 1.2. If those don&amp;#39;t apply then it just makes sure that the runtime major version is the same as the compile time major version, and that that runtime minor version is &amp;gt;=  the compile time minor version.&lt;br/&gt;
&lt;br/&gt;
I get the feeling this might be there to support dropping the debug agent into other JDK distros that maybe don&amp;#39;t build the debug agent. I don&amp;#39;t think we support this any more. Possibly we can get rid of most of this version checking. It seems that if we always pass JVMTI_VERSION into GetEnv(), then we can just assert that JVMTI GetVersionNumber() returns JVMTI_VERSION.</comment>
                            <comment id="14541318" author="alanb" created="Tue, 29 Nov 2022 10:50:16 -0800"  >Indeed, this issue is about remove the confusing &amp;quot;&amp;quot;is your J2SE a 1.5 or newer version&amp;quot; text. </comment>
                            <comment id="14541316" author="cjplummer" created="Tue, 29 Nov 2022 10:39:31 -0800"  >In that case I don&amp;#39;t think simply replacing JVMTI_VERSION_1 with JVMTI_VERSION is going to help with the confusing message or make it go away. What is needed is to get rid of &amp;quot;is your J2SE a 1.5 or newer version?&amp;quot; part of the message. We can switch to using JVMTI_VERSION also, but that really isn&amp;#39;t the issue here.&lt;br/&gt;
</comment>
                            <comment id="14541312" author="alanb" created="Tue, 29 Nov 2022 10:30:43 -0800"  >I suspect it may be x86_32 where a jshell test is running with --enable-preview. There is no JVMTI support in that configuration as the VM continuations port is done yet. At least, I think this is what is going on and the error message is confusing.</comment>
                            <comment id="14541297" author="cjplummer" created="Tue, 29 Nov 2022 09:50:00 -0800"  >The debug agent is tied to the release it ships with, so always using the latest JVMTI (JVMTI_VERSION) should be reasonable.&lt;br/&gt;
&lt;br/&gt;
However, what&amp;#39;s not clear to me is why -3 (JNI_EVERSION) is being returned in the first place. Do we have an explanation for this?</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2xcab:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17305"><![CDATA[b03]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="370"><![CDATA[debugger]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>