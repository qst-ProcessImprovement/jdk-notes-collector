<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 09:02:16 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8308609] java/lang/ScopedValue/StressStackOverflow.java fails with &quot;-XX:-VMContinuations&quot;</title>
                <link>https://bugs.openjdk.org/browse/JDK-8308609</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>This test case (jdk/incubator/concurrent/ScopedValue/StressStackOverflow.java) fails with &amp;quot;-XX:-VMContinuations&amp;quot;, but passes with &amp;quot;-XX:+VMContinuations&amp;quot;.&lt;br/&gt;
&lt;br/&gt;
In my local test, it fails on Linux  platforms with both aarch64 and x86_64.&lt;br/&gt;
&lt;br/&gt;
Here shows the error log:&lt;br/&gt;
&lt;br/&gt;
```&lt;br/&gt;
&amp;nbsp;STDERR:&lt;br/&gt;
&amp;nbsp;WARNING: Using incubator modules: jdk.incubator.concurrent&lt;br/&gt;
&amp;nbsp;java.lang.RuntimeException: java.lang.RuntimeException: java.util.concurrent.ExecutionException: java.util.NoSuchElementException&lt;br/&gt;
&amp;nbsp;&amp;nbsp;at StressStackOverflow.lambda$run$1(StressStackOverflow.java:196)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;at java.base/jdk.internal.vm.ScopedValueContainer.runWithoutScope(ScopedValueContainer.java:114)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;at java.base/jdk.internal.vm.ScopedValueContainer.run(ScopedValueContainer.java:100)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;at jdk.incubator.concurrent/jdk.incubator.concurrent.ScopedValue$Carrier.run(ScopedValue.java:417)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;at StressStackOverflow.run(StressStackOverflow.java:158)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;at StressStackOverflow.main(StressStackOverflow.java:209)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;at java.base/java.lang.reflect.Method.invoke(Method.java:578)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;at com.sun.javatest.regtest.agent.MainWrapper$MainTask.run(MainWrapper.java:138)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;at java.base/java.lang.Thread.run(Thread.java:1583)&lt;br/&gt;
&amp;nbsp;Caused by: java.lang.RuntimeException: java.util.concurrent.ExecutionException: java.util.NoSuchElementException&lt;br/&gt;
&amp;nbsp;&amp;nbsp;at StressStackOverflow.runInNewThread(StressStackOverflow.java:152)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;at StressStackOverflow.lambda$run$1(StressStackOverflow.java:189)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;... 9 more&lt;br/&gt;
&amp;nbsp;Caused by: java.util.concurrent.ExecutionException: java.util.NoSuchElementException&lt;br/&gt;
&amp;nbsp;&amp;nbsp;at java.base/java.util.concurrent.FutureTask.report(FutureTask.java:122)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;at java.base/java.util.concurrent.FutureTask.get(FutureTask.java:191)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;at jdk.incubator.concurrent/jdk.incubator.concurrent.StructuredTaskScope$FutureImpl.get(StructuredTaskScope.java:779)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;at StressStackOverflow.runInNewThread(StressStackOverflow.java:149)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;... 10 more&lt;br/&gt;
&amp;nbsp;&amp;nbsp;Suppressed: java.lang.IllegalStateException: Owner did not invoke join or joinUntil after fork&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at jdk.incubator.concurrent/jdk.incubator.concurrent.StructuredTaskScope.close(StructuredTaskScope.java:704)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at StressStackOverflow.runInNewThread(StressStackOverflow.java:144)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;... 10 more&lt;br/&gt;
&amp;nbsp;Caused by: java.util.NoSuchElementException&lt;br/&gt;
&amp;nbsp;&amp;nbsp;at jdk.incubator.concurrent/jdk.incubator.concurrent.ScopedValue.slowGet(ScopedValue.java:570)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;at jdk.incubator.concurrent/jdk.incubator.concurrent.ScopedValue.get(ScopedValue.java:563)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;at StressStackOverflow$2.run(StressStackOverflow.java:183)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;at StressStackOverflow.lambda$runInNewThread$0(StressStackOverflow.java:146)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;at java.base/java.lang.ThreadBuilders$BoundVirtualThread.run(ThreadBuilders.java:436)&lt;br/&gt;
&amp;nbsp;&lt;br/&gt;
&amp;nbsp;JavaTest Message: Test threw exception: java.lang.RuntimeException: java.lang.RuntimeException: java.util.concurrent.ExecutionException: java.util.NoSuchElementException&lt;br/&gt;
&amp;nbsp;JavaTest Message: shutting down test&lt;br/&gt;
&amp;nbsp;&lt;br/&gt;
&amp;nbsp;STATUS:Failed.`main&amp;#39; threw exception: java.lang.RuntimeException: java.lang.RuntimeException: java.util.concurrent.ExecutionException: java.util.NoSuchElementException&lt;br/&gt;
```</description>
                <environment></environment>
        <key id="5101530">JDK-8308609</key>
            <summary>java/lang/ScopedValue/StressStackOverflow.java fails with &quot;-XX:-VMContinuations&quot;</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://bugs.openjdk.org/images/jbsImages/p3.png">P3</priority>
                        <status id="6" iconUrl="https://bugs.openjdk.org/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="aph">Andrew Haley</assignee>
                                    <reporter username="haosun">Hao Sun</reporter>
                        <labels>
                            <label>jdk21u-fix-SQE-ok</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>loom</label>
                    </labels>
                <created>Mon, 22 May 2023 22:30:31 -0700</created>
                <updated>Tue, 27 Feb 2024 08:59:12 -0800</updated>
                            <resolved>Fri, 16 Jun 2023 05:22:25 -0700</resolved>
                                    <version>21</version>
                                    <fixVersion>22</fixVersion>
                                    <component>core-libs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                                                                                                            <comments>
                            <comment id="14652816" author="JIRAUSER20205" created="Tue, 27 Feb 2024 08:59:12 -0800"  >Verified in JDK22 b27&lt;br/&gt;
&lt;a href=&quot;https://mach5.us.oracle.com/mdash/jobs/root-jdk-22-27-2262-20231208-1723-3257153/results?search=name%3A*java%2Flang%2FScopedValue%2FStressStackOverflow.java*&quot;&gt;https://mach5.us.oracle.com/mdash/jobs/root-jdk-22-27-2262-20231208-1723-3257153/results?search=name%3A*java%2Flang%2FScopedValue%2FStressStackOverflow.java*&lt;/a&gt;</comment>
                            <comment id="14600682" author="clanger" created="Tue, 1 Aug 2023 08:39:00 -0700"  >Fix request (21u)&lt;br/&gt;
&lt;br/&gt;
Request backporting this to 21u to fix the problematic test and remove the test exclusions. I&amp;#39;ll also backport &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8311926&quot; title=&quot;java/lang/ScopedValue/StressStackOverflow.java takes 9mins in tier1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8311926&quot;&gt;&lt;strike&gt;JDK-8311926&lt;/strike&gt;&lt;/a&gt; as a follow up. Testing: GHA and SAP test system.&lt;br/&gt;
</comment>
                            <comment id="14599925" author="roboduke" created="Fri, 28 Jul 2023 04:40:24 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u/pull/22&quot;&gt;https://git.openjdk.org/jdk21u/pull/22&lt;/a&gt;&lt;br/&gt;
Date: 2023-07-28 11:32:32 +0000</comment>
                            <comment id="14591494" author="dcubed" created="Thu, 22 Jun 2023 12:34:26 -0700"  >If this fix is backported to JDK21, the following ProblemListing must also be backported:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8310586&quot; title=&quot;ProblemList java/lang/ScopedValue/StressStackOverflow.java#default with virtual threads on linux-all&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8310586&quot;&gt;&lt;strike&gt;JDK-8310586&lt;/strike&gt;&lt;/a&gt; ProblemList java/lang/ScopedValue/StressStackOverflow.java#default with virtual threads on linux-all&lt;br/&gt;
&lt;br/&gt;
Otherwise java/lang/ScopedValue/StressStackOverflow.java#default will timeout in Tier5 on linux-all.&lt;br/&gt;
&lt;br/&gt;
Of course, if the following bug is fixed in JDK22:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8309646&quot; title=&quot;java/lang/ScopedValue/StressStackOverflow.java failures with JTREG_TEST_THREAD_FACTORY=Virtual runs &quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8309646&quot;&gt;JDK-8309646&lt;/a&gt;  java/lang/ScopedValue/StressStackOverflow.java failures with JTREG_TEST_THREAD_FACTORY=Virtual runs&lt;br/&gt;
&lt;br/&gt;
then it should be backported along with this bug fix (&lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8308609&quot; title=&quot;java/lang/ScopedValue/StressStackOverflow.java fails with &amp;quot;-XX:-VMContinuations&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8308609&quot;&gt;&lt;strike&gt;JDK-8308609&lt;/strike&gt;&lt;/a&gt;) and &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8310586&quot; title=&quot;ProblemList java/lang/ScopedValue/StressStackOverflow.java#default with virtual threads on linux-all&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8310586&quot;&gt;&lt;strike&gt;JDK-8310586&lt;/strike&gt;&lt;/a&gt; won&amp;#39;t be necessary.</comment>
                            <comment id="14591157" author="dcubed" created="Wed, 21 Jun 2023 13:36:50 -0700"  >This fix is integrated in jdk-22+3-121.</comment>
                            <comment id="14589902" author="dukebot" created="Fri, 16 Jun 2023 05:22:24 -0700"  >Changeset: 44a8aa06&lt;br/&gt;
Author:    Andrew Haley &amp;lt;&lt;a href=&apos;mailto:aph@openjdk.org&apos;&gt;aph@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-06-16 12:21:11 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/44a8aa0691f046d720a789a89c9039a010658f0c&quot;&gt;https://git.openjdk.org/jdk/commit/44a8aa0691f046d720a789a89c9039a010658f0c&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14588302" author="aph" created="Sat, 10 Jun 2023 03:52:14 -0700"  >&amp;gt; This is a brutal and extreme stress test for ScopedValue in stack overflow conditions, very hard to test recovery reliably. &lt;br/&gt;
&lt;br/&gt;
It is extreme, but the property we&amp;#39;re trying to test should be a hard guarantee. Any failure &#8212; even under heavy stress &#8212; is arguably non-conformant.</comment>
                            <comment id="14588220" author="roboduke" created="Fri, 9 Jun 2023 09:59:09 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/14399&quot;&gt;https://git.openjdk.org/jdk/pull/14399&lt;/a&gt;&lt;br/&gt;
Date: 2023-06-09 16:53:15 +0000</comment>
                            <comment id="14587844" author="alanb" created="Wed, 7 Jun 2023 23:30:42 -0700"  >I&amp;#39;ve changed the title on this JBS issue as the test has moved to test/jdk/java/lang/ScopedValue as part of promoting ScopedValue from an incubating to a preview API (JEP 446).</comment>
                            <comment id="14587545" author="alanb" created="Tue, 6 Jun 2023 23:38:29 -0700"  >This is a brutal and extreme stress test for ScopedValue in stack overflow conditions, very hard to test recovery reliably.  It is currently failing on linux-x86 (32-bit) and other ports that don&amp;#39;t have VM continuations support. It might need to be updated to `@requires vm.continuations` until it can run in that mode. [~aph] Is this on your radar? </comment>
                            <comment id="14583563" author="dholmes" created="Tue, 23 May 2023 01:03:06 -0700"  >I don&amp;#39;t see anything to suggest a hotspot issue here. This seems a Loom issue so moving to core-libs.</comment>
                            <comment id="14583522" author="chagedorn" created="Mon, 22 May 2023 23:11:00 -0700"  >Does not look like a compiler issue. Moving to runtime for initial triaging.</comment>
                            <comment id="14583516" author="haosun" created="Mon, 22 May 2023 22:32:56 -0700"  >It seems that s390 platform has the same issue. See &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8303498&quot;&gt;https://bugs.openjdk.org/browse/JDK-8303498&lt;/a&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5107413">JDK-8313753</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10002">
                    <name>Duplicate</name>
                                                                <inwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="5095363">JDK-8303498</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5102725">JDK-8309646</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5103395">JDK-8310211</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                                              <subtask id="5104067">JDK-8310822</subtask>
                                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17008"><![CDATA[generic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i31me3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17305"><![CDATA[b03]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="190"><![CDATA[java.lang]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10100" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Verification</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17000"><![CDATA[Verified]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>