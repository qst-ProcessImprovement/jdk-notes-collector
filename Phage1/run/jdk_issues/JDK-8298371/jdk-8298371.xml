<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 14:40:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8298371] monitors_on_stack extracts unprocessed oops</title>
                <link>https://bugs.openjdk.org/browse/JDK-8298371</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>While investigating &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8298058&quot; title=&quot;jdk/internal/vm/Continuation/Fuzz.java#default fails &amp;quot;assert(oopDesc::is_oop_or_null(val)) failed: bad oop found at 0xNNNN in_cont: 0 compressed: 0&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8298058&quot;&gt;&lt;strike&gt;JDK-8298058&lt;/strike&gt;&lt;/a&gt; we&amp;#39;ve found that monitors_on_stack extracts oops without setting up the RegisterMap to process oops. This then leaks out stale oops.&lt;br/&gt;
&lt;br/&gt;
A simple fix is to change the RegisterMap to perform oops processing. However, monitors_on_stack is only used in an assert, so this means that we&amp;#39;ll get a difference in behavior between release builds and debug builds. This has the potential to hide bugs in debug builds. It has been suggested to me that it might be better to simply remove the assert:&lt;br/&gt;
```&lt;br/&gt;
&amp;nbsp;&amp;nbsp;assert(monitors_on_stack(current) == ((current-&amp;gt;held_monitor_count() - current-&amp;gt;jni_monitor_count()) &amp;gt; 0),&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;Held monitor count and locks on stack invariant: &amp;quot; INT64_FORMAT &amp;quot; JNI: &amp;quot; INT64_FORMAT, (int64_t)current-&amp;gt;held_monitor_count(), (int64_t)current-&amp;gt;jni_monitor_count());&lt;br/&gt;
```</description>
                <environment></environment>
        <key id="5089205">JDK-8298371</key>
            <summary>monitors_on_stack extracts unprocessed oops</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://bugs.openjdk.org/images/jbsImages/p2.png">P2</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stefank">Stefan Karlsson</assignee>
                                    <reporter username="stefank">Stefan Karlsson</reporter>
                        <labels>
                            <label>hgupdate-sync</label>
                            <label>loom</label>
                            <label>noreg-hard</label>
                    </labels>
                <created>Thu, 8 Dec 2022 02:20:07 -0800</created>
                <updated>Thu, 29 Jun 2023 13:48:31 -0700</updated>
                            <resolved>Wed, 14 Dec 2022 05:24:46 -0800</resolved>
                                    <version>20</version>
                                    <fixVersion>21</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14546123" author="dukebot" created="Fri, 16 Dec 2022 07:51:20 -0800"  >Changeset: 323e574a&lt;br/&gt;
Author:    Stefan Karlsson &amp;lt;&lt;a href=&apos;mailto:stefank@openjdk.org&apos;&gt;stefank@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2022-12-15 11:28:06 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/323e574a50520735f41549f36907563e1b4a1040&quot;&gt;https://git.openjdk.org/jdk/commit/323e574a50520735f41549f36907563e1b4a1040&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14545382" author="roboduke" created="Wed, 14 Dec 2022 06:07:02 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk20/pull/32&quot;&gt;https://git.openjdk.org/jdk20/pull/32&lt;/a&gt;&lt;br/&gt;
Date: 2022-12-14 13:42:15 +0000</comment>
                            <comment id="14545376" author="stefank" created="Wed, 14 Dec 2022 05:44:30 -0800"  >Updated to P2, since we can&amp;#39;t run ZGC + Loom testing without this fix.</comment>
                            <comment id="14545371" author="stefank" created="Wed, 14 Dec 2022 05:23:57 -0800"  >The bug had wrong fix version. Copying the duke bot message:&lt;br/&gt;
Changeset: b754aa5e&lt;br/&gt;
Author: Stefan Karlsson &amp;lt;&lt;a href=&apos;mailto:stefank@openjdk.org&apos;&gt;stefank@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date: 2022-12-14 11:04:49 +0000&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/commit/b754aa5e3f231aea8da5274c330dc55dd78b0f67&quot;&gt;https://git.openjdk.org/jdk/commit/b754aa5e3f231aea8da5274c330dc55dd78b0f67&lt;/a&gt;</comment>
                            <comment id="14545288" author="stefank" created="Wed, 14 Dec 2022 00:28:32 -0800"  >We need to be able to test ZGC + Loom in JDK 20, can&amp;#39;t defer this to JDK 21 IMHO.</comment>
                            <comment id="14545179" author="mseledtsov" created="Tue, 13 Dec 2022 11:24:51 -0800"  >ILW = MLM = P4</comment>
                            <comment id="14543848" author="roboduke" created="Thu, 8 Dec 2022 02:40:31 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/11582&quot;&gt;https://git.openjdk.org/jdk/pull/11582&lt;/a&gt;&lt;br/&gt;
Date: 2022-12-08 10:27:31 +0000</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5089642">JDK-8298734</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10002">
                    <name>Duplicate</name>
                                                                <inwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="5088843">JDK-8298058</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5088843">JDK-8298058</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2zjir:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17317"><![CDATA[b02]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="192"><![CDATA[runtime]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>