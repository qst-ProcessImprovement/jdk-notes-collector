<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 08:45:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8293114] JVM should trim the native heap</title>
                <link>https://bugs.openjdk.org/browse/JDK-8293114</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>In 2021 we discussed the possibility of letting the JVM auto-trim the native heap to combat Glibc memory retention.&lt;br/&gt;
&lt;br/&gt;
The Glibc allocator is reluctant to return memory to the OS, much more so than other allocators. Temporary malloc spikes often carry over as permanent RSS increase.&lt;br/&gt;
&lt;br/&gt;
Note that C-heap retention is difficult to observe. Since it is freed memory, it won&amp;#39;t show up in NMT, it is just a part of private RSS.&lt;br/&gt;
&lt;br/&gt;
Theoretically, retained memory is not lost since it will be reused by future mallocs. Retaining memory is therefore a bet on the future behavior of the app. The allocator bets on the application needing memory in the near future, and to satisfy that need via malloc.&lt;br/&gt;
&lt;br/&gt;
But an app&amp;#39;s malloc load can fluctuate wildly, with temporary spikes and long idle periods. And if the app rolls its own custom allocators atop of mmap, as hotspot does, a lot of that memory cannot be reused even though it counts toward its memory footprint.&lt;br/&gt;
&lt;br/&gt;
To help, Glibc exports an API to trim the C-heap: malloc_trim(3). It would be good if we were to integrate it into the JVM as an optional GC step.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
[1] &lt;a href=&quot;https://mail.openjdk.org/pipermail/hotspot-dev/2021-August/054323.html&quot;&gt;https://mail.openjdk.org/pipermail/hotspot-dev/2021-August/054323.html&lt;/a&gt;</description>
                <environment></environment>
        <key id="5082526">JDK-8293114</key>
            <summary>JVM should trim the native heap</summary>
                <type id="7" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14707&amp;avatarType=issuetype">Enhancement</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stuefe">Thomas Stuefe</assignee>
                                    <reporter username="stuefe">Thomas Stuefe</reporter>
                        <labels>
                            <label>amazon-interest</label>
                            <label>jdk17u-fix-request</label>
                            <label>jdk17u-fix-yes</label>
                            <label>jdk21u-fix-SQE-ok</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                    </labels>
                <created>Tue, 30 Aug 2022 07:20:38 -0700</created>
                <updated>Fri, 28 Feb 2025 04:48:46 -0800</updated>
                            <resolved>Fri, 21 Jul 2023 05:25:09 -0700</resolved>
                                    <version>17</version>
                    <version>21</version>
                    <version>22</version>
                                    <fixVersion>22</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="14604267" author="shade" created="Wed, 16 Aug 2023 00:12:07 -0700"  >Fix Request (17u)&lt;br/&gt;
&lt;br/&gt;
Same reason as for 21u. 17u PR requires adaptations, acked by Thomas. The adaptations do not affect the exposure surface: the feature is still well isolated. </comment>
                            <comment id="14603014" author="shade" created="Wed, 9 Aug 2023 09:18:13 -0700"  >Fix Request (21u)&lt;br/&gt;
&lt;br/&gt;
Enables the experimental feature to avoid apparent memory leaks due to native allocator overprovision. Applies cleanly. The feature is well-isolated from the rest of the code, and disabled by default. Tests pass. Needs &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8312525&quot; title=&quot;New test runtime/os/TestTrimNative.java#trimNative is failing: did not see the expected RSS reduction&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8312525&quot;&gt;&lt;strike&gt;JDK-8312525&lt;/strike&gt;&lt;/a&gt; testbug fix as the follow-up.</comment>
                            <comment id="14597956" author="roboduke" created="Fri, 21 Jul 2023 11:03:29 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u-dev/pull/1616&quot;&gt;https://git.openjdk.org/jdk17u-dev/pull/1616&lt;/a&gt;&lt;br/&gt;
Date: 2023-07-21 17:55:38 +0000</comment>
                            <comment id="14597933" author="roboduke" created="Fri, 21 Jul 2023 09:21:34 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u/pull/13&quot;&gt;https://git.openjdk.org/jdk21u/pull/13&lt;/a&gt;&lt;br/&gt;
Date: 2023-07-21 16:15:18 +0000</comment>
                            <comment id="14597932" author="shade" created="Fri, 21 Jul 2023 09:13:07 -0700"  >I am going to line up some backports to 17u and 21u, so we can review and tests them while this feature is being soaked in mainline. Don&amp;#39;t be spooked :)</comment>
                            <comment id="14597835" author="dukebot" created="Fri, 21 Jul 2023 05:25:08 -0700"  >Changeset: 9e4fc568&lt;br/&gt;
Author:    Thomas Stuefe &amp;lt;&lt;a href=&apos;mailto:stuefe@openjdk.org&apos;&gt;stuefe@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-07-21 12:22:03 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/9e4fc568a6f1a93c84a84d6cc5220c6eb4e546a5&quot;&gt;https://git.openjdk.org/jdk/commit/9e4fc568a6f1a93c84a84d6cc5220c6eb4e546a5&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14594211" author="roboduke" created="Thu, 6 Jul 2023 03:07:14 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/14781&quot;&gt;https://git.openjdk.org/jdk/pull/14781&lt;/a&gt;&lt;br/&gt;
Date: 2023-07-06 06:54:22 +0000</comment>
                            <comment id="14521002" author="roboduke" created="Wed, 31 Aug 2022 01:58:25 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/10085&quot;&gt;https://git.openjdk.org/jdk/pull/10085&lt;/a&gt;&lt;br/&gt;
Date: 2022-08-30 14:35:26 +0000</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5107812">JDK-8314107</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5108877">JDK-8315028</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5106006">JDK-8312525</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5108203">JDK-8314426</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5087285">JDK-8296784</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5087295">JDK-8296796</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5121035">JDK-8325496</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5095704">JDK-8303767</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5052029">JDK-8268893</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17023"><![CDATA[linux]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2yew3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17337"><![CDATA[b08]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="209"><![CDATA[gc]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>