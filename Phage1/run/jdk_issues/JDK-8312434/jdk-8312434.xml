<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 10:03:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8312434] SPECjvm2008/xml.transform with CDS fails with &quot;can&apos;t seal package nu.xom&quot;</title>
                <link>https://bugs.openjdk.org/browse/JDK-8312434</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>Run SPECjvm2008 with the following parameters&lt;br/&gt;
&lt;br/&gt;
java  \&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;--add-exports=java.xml/com.sun.org.apache.xerces.internal.parsers=ALL-UNNAMED \&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;--add-exports=java.xml/com.sun.org.apache.xerces.internal.util=ALL-UNNAMED \&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-Xms3g -Xmx3g -Xlog:gc \&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-jar SPECjvm2008/SPECjvm2008.jar xml.transform \&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;-ikv -fit 1 -wt 0 -i 1 -bt 1&lt;br/&gt;
&lt;br/&gt;
If we change the above command to dump the classlist, create a CDS archive, and run with the CDS archive, the following exception is displayed:&lt;br/&gt;
=====&lt;br/&gt;
&amp;nbsp;&amp;nbsp;Benchmark:   xml.transform&lt;br/&gt;
&amp;nbsp;&amp;nbsp;Run mode:    timed run&lt;br/&gt;
&amp;nbsp;&amp;nbsp;Test type:   multi&lt;br/&gt;
&amp;nbsp;&amp;nbsp;Threads:     1&lt;br/&gt;
&amp;nbsp;&amp;nbsp;Iterations:  40&lt;br/&gt;
&amp;nbsp;&amp;nbsp;Run length:  1s&lt;br/&gt;
xom canonicalization of chess-fo/Kasparov-Karpov.xml.SAX crashed.&lt;br/&gt;
===&lt;br/&gt;
&lt;br/&gt;
If we change the classlist to have only a single line with the class &amp;quot;nu.xom.Node&amp;quot;, dump the archive and run the app again, the following exception stack is printed:&lt;br/&gt;
&lt;br/&gt;
=====&lt;br/&gt;
Error in setup of Benchmark.&lt;br/&gt;
spec.harness.StopBenchmarkException: Error invoking bmSetupBenchmarkMethod&lt;br/&gt;
	at spec.harness.ProgramRunner.invokeBmSetupBenchmark(ProgramRunner.java:185)&lt;br/&gt;
	at spec.harness.ProgramRunner.runBenchmark(ProgramRunner.java:301)&lt;br/&gt;
	at spec.harness.ProgramRunner.run(ProgramRunner.java:98)&lt;br/&gt;
Caused by: java.lang.reflect.InvocationTargetException&lt;br/&gt;
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:118)&lt;br/&gt;
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)&lt;br/&gt;
	at spec.harness.ProgramRunner.invokeBmSetupBenchmark(ProgramRunner.java:183)&lt;br/&gt;
	... 2 more&lt;br/&gt;
Caused by: java.lang.SecurityException: sealing violation: can&amp;#39;t seal package nu.xom: already defined&lt;br/&gt;
	at java.base/jdk.internal.loader.BuiltinClassLoader.getAndVerifyPackage(BuiltinClassLoader.java:912)&lt;br/&gt;
	at java.base/jdk.internal.loader.BuiltinClassLoader.defineOrCheckPackage(BuiltinClassLoader.java:877)&lt;br/&gt;
	at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.defineOrCheckPackage(ClassLoaders.java:211)&lt;br/&gt;
	at java.base/jdk.internal.loader.BuiltinClassLoader.defineClass(BuiltinClassLoader.java:849)&lt;br/&gt;
	at java.base/jdk.internal.loader.BuiltinClassLoader.findClassOnClassPathOrNull(BuiltinClassLoader.java:760)&lt;br/&gt;
	at java.base/jdk.internal.loader.BuiltinClassLoader.loadClassOrNull(BuiltinClassLoader.java:681)&lt;br/&gt;
	at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:639)&lt;br/&gt;
	at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:188)&lt;br/&gt;
	at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:526)&lt;br/&gt;
	at spec.benchmarks.xml.transform.Main.&amp;lt;init&amp;gt;(Main.java:197)&lt;br/&gt;
	at spec.benchmarks.xml.transform.Main.setupBenchmark(Main.java:152)&lt;br/&gt;
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)&lt;br/&gt;
	... 4 more&lt;br/&gt;
==========&lt;br/&gt;
</description>
                <environment></environment>
        <key id="5105902">JDK-8312434</key>
            <summary>SPECjvm2008/xml.transform with CDS fails with &quot;can&apos;t seal package nu.xom&quot;</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ccheung">Calvin Cheung</assignee>
                                    <reporter username="iklam">Ioi Lam</reporter>
                        <labels>
                            <label>cds</label>
                            <label>jdk17u-fix-request</label>
                            <label>jdk17u-fix-yes</label>
                            <label>jdk21u-fix-SQE-ok</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                    </labels>
                <created>Wed, 19 Jul 2023 23:05:44 -0700</created>
                <updated>Wed, 6 Dec 2023 03:59:16 -0800</updated>
                            <resolved>Tue, 22 Aug 2023 15:38:39 -0700</resolved>
                                    <version>17</version>
                    <version>21</version>
                    <version>22</version>
                                    <fixVersion>22</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="14627949" author="goetz" created="Tue, 21 Nov 2023 00:56:08 -0800"  >Fix request [17u]&lt;br/&gt;
&lt;br/&gt;
I backport this for parity with 17.0.11-oracle.&lt;br/&gt;
Risk limited to cds.&lt;br/&gt;
I had to adapt the tests.&lt;br/&gt;
Tests pass. SAP nightly testing passed.</comment>
                            <comment id="14627619" author="roboduke" created="Mon, 20 Nov 2023 06:57:03 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u-dev/pull/1972&quot;&gt;https://git.openjdk.org/jdk17u-dev/pull/1972&lt;/a&gt;&lt;br/&gt;
Date: 2023-11-20 14:04:10 +0000</comment>
                            <comment id="14623677" author="roboduke" created="Fri, 3 Nov 2023 09:11:43 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u/pull/322&quot;&gt;https://git.openjdk.org/jdk21u/pull/322&lt;/a&gt;&lt;br/&gt;
Date: 2023-11-03 16:02:31 +0000</comment>
                            <comment id="14623087" author="ccheung" created="Wed, 1 Nov 2023 12:49:02 -0700"  >Fix request:&lt;br/&gt;
&lt;br/&gt;
Fix is specific to CDS only.&lt;br/&gt;
The fix could be applied cleanly in my local jdk21u repo.&lt;br/&gt;
It has been in the mainline since late August.&lt;br/&gt;
There is a jtreg test with the fix.</comment>
                            <comment id="14605909" author="dukebot" created="Tue, 22 Aug 2023 15:38:38 -0700"  >Changeset: 9f4a9fe4&lt;br/&gt;
Author:    Calvin Cheung &amp;lt;&lt;a href=&apos;mailto:ccheung@openjdk.org&apos;&gt;ccheung@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-08-22 22:37:16 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/9f4a9fe488be7ce43f6719c54df25a1fabd8696a&quot;&gt;https://git.openjdk.org/jdk/commit/9f4a9fe488be7ce43f6719c54df25a1fabd8696a&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14604869" author="roboduke" created="Thu, 17 Aug 2023 22:11:01 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/15339&quot;&gt;https://git.openjdk.org/jdk/pull/15339&lt;/a&gt;&lt;br/&gt;
Date: 2023-08-18 04:57:52 +0000</comment>
                            <comment id="14604514" author="ccheung" created="Wed, 16 Aug 2023 12:51:51 -0700"  >After closer look at the MANIFEST.MF, the nu.xom package is sealed.&lt;br/&gt;
&lt;br/&gt;
Name: nu/xom/&lt;br/&gt;
Implementation-Vendor: Elliotte Rusty Harold&lt;br/&gt;
Sealed: true&lt;br/&gt;
Specification-Title: XOM core classes&lt;br/&gt;
Implementation-Title: nu.xom&lt;br/&gt;
Implementation-Version: 1.1&lt;br/&gt;
SHA1-Digest: 2jmj7l5rSw0yVb/vlWAYkK/YBwk=&lt;br/&gt;
&lt;br/&gt;
After further debugging, this seems to be a dump time issue.&lt;br/&gt;
In FileMapInfo::update_jar_manifest, there is a check for a signed jar. If the jar is signed, we don&amp;#39;t store the manifest data into the ClassPathEntry.&lt;br/&gt;
However, the check for signed jar is not precise enough. We only look for the &amp;quot;-Digest&amp;quot; substring in the manifest and consider the jar is signed if the substring exists.&lt;br/&gt;
At the java level, if a jar file is signed with an algorithm in the jdk.jar.disabledAlgorithms list, the jar is considered unsigned.&lt;br/&gt;
So during runtime, the nu.xom.Node is loaded from the archive and the package entry is defined without the manifest info, i.e. without package sealing.&lt;br/&gt;
Later when another class from the same package is loaded from the jar, while creating the package entry for the class, it sees that the package has been defined unsealed and resulting in the sealing violation error.</comment>
                            <comment id="14603519" author="ccheung" created="Fri, 11 Aug 2023 16:28:29 -0700"  >Using jarsigner to check the xom-1.1.jar, the jar is considered unsigned.&lt;br/&gt;
&lt;br/&gt;
jarsigner -verify -verbose lib/xom-1.1.jar&lt;br/&gt;
&lt;br/&gt;
shows the following at the end of output:&lt;br/&gt;
&lt;br/&gt;
- Signed by &amp;quot;CN=SPECjvm2008 Development Committee, OU=OSG Java, O=SPEC, L=Warrenton, ST=VA, C=US&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Digest algorithm: SHA1 (disabled)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Signature algorithm: SHA1withDSA (disabled), 1024-bit key (weak)&lt;br/&gt;
&lt;br/&gt;
WARNING: The jar will be treated as unsigned, because it is signed with a weak algorithm that is now disabled by the security property:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;jdk.jar.disabledAlgorithms=MD2, MD5, RSA keySize &amp;lt; 1024, DSA keySize &amp;lt; 1024, SHA1 denyAfter 2019-01-01</comment>
                            <comment id="14599044" author="mseledtsov" created="Tue, 25 Jul 2023 11:19:47 -0700"  >ILW = MML = P4</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5113970">JDK-8319410</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5114448">JDK-8319839</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5116322">JDK-8321463</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10002">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                                        </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5114862">JDK-8320217</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="104681" name="SPECjvm2008.sh" size="1752" author="iklam" created="Thu, 20 Jul 2023 17:04:50 -0700"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i32dcr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17349"><![CDATA[b12]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="192"><![CDATA[runtime]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>