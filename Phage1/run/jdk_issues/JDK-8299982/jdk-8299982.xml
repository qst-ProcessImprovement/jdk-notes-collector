<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 15:33:52 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8299982] (bf) Buffer.checkIndex(int, int) should use Preconditions.checkIndex(int, int, BiFunction)</title>
                <link>https://bugs.openjdk.org/browse/JDK-8299982</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>This came up in the benchmarks for this PR: &lt;br/&gt;
&lt;a href=&quot;https://github.com/openjdk/panama-foreign/pull/762&quot;&gt;https://github.com/openjdk/panama-foreign/pull/762&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
I changed Buffer.checkIndex(int i, int nb)  to rely on Objects.checkIndex() (which has a c2 intrinsic):&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;https://github.com/rwestrel/panama-foreign/blob/268a254e2be477fca82cb14ebcecd9ffb699ca19/src/java.base/share/classes/java/nio/Buffer.java#L749&quot;&gt;https://github.com/rwestrel/panama-foreign/blob/268a254e2be477fca82cb14ebcecd9ffb699ca19/src/java.base/share/classes/java/nio/Buffer.java#L749&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
and, I&amp;#39;m seeing a ~20% performance improvement for the MemorySegmentVsBits.byteBuffer benchmark (this also needs some unrelated c2 tweaks).&lt;br/&gt;
&lt;br/&gt;
Note the Buffer.checkIndex() implementation above is an experiment, I don&amp;#39;t claim it&amp;#39;s correct in all cases.&lt;br/&gt;
&lt;br/&gt;
I discussed this with Maurizio and he mentioned the MemorySegment has a similar range check method that&amp;#39;s implemented with Objects.checkIndex().&lt;br/&gt;
&lt;br/&gt;
One thing to consider is that Objects.checkFromIndexSize() is functionally close to what&amp;#39;s needed for Buffer.checkIndex() (and the MemorySegment range checking method) but has no c2 intrinsic. One possible path is to implement Buffer.checkIndex(int i, int nb) with Objects.checkFromIndexSize() and then rework Objects.checkFromIndexSize()  so it calls Objects.checkIndex().</description>
                <environment></environment>
        <key id="5091192">JDK-8299982</key>
            <summary>(bf) Buffer.checkIndex(int, int) should use Preconditions.checkIndex(int, int, BiFunction)</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bpb">Brian Burkhalter</assignee>
                                    <reporter username="roland">Roland Westrelin</reporter>
                        <labels>
                    </labels>
                <created>Wed, 11 Jan 2023 09:04:49 -0800</created>
                <updated>Wed, 1 Feb 2023 22:47:22 -0800</updated>
                            <resolved>Thu, 26 Jan 2023 12:10:44 -0800</resolved>
                                    <version>21</version>
                                    <fixVersion>21</fixVersion>
                                    <component>core-libs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14554801" author="dukebot" created="Thu, 26 Jan 2023 12:10:42 -0800"  >Changeset: c4278144&lt;br/&gt;
Author:    Brian Burkhalter &amp;lt;&lt;a href=&apos;mailto:bpb@openjdk.org&apos;&gt;bpb@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-01-26 20:09:01 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/c4278144bee667e2565a40f12a2a2c251d6cf3aa&quot;&gt;https://git.openjdk.org/jdk/commit/c4278144bee667e2565a40f12a2a2c251d6cf3aa&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14554175" author="roboduke" created="Tue, 24 Jan 2023 14:15:12 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/12174&quot;&gt;https://git.openjdk.org/jdk/pull/12174&lt;/a&gt;&lt;br/&gt;
Date: 2023-01-24 22:07:51 +0000</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2zvhf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17337"><![CDATA[b08]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="228"><![CDATA[java.nio]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>