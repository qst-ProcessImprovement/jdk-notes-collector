<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 12:55:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8329667] [macos] Issue with JTree related fix for JDK-8317771</title>
                <link>https://bugs.openjdk.org/browse/JDK-8329667</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>OS: 	macOS&lt;br/&gt;
JDK-Version: 17.0.7-ea, 21.0.3-snapshot-2024-03-12, ...&lt;br/&gt;
&lt;br/&gt;
When having an own implementation for JTree$AccessibleJTree, the current fix for &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8317771&quot; title=&quot;[macos14] Expand/collapse a JTree using keyboard freezes the application in macOS 14 Sonoma&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8317771&quot;&gt;&lt;strike&gt;JDK-8317771&lt;/strike&gt;&lt;/a&gt; results in a NoSuchMethodException.&lt;br/&gt;
Reason: In CAccessibility the call to t.getAccessibleContext().getClass() returns the inner class of its own implementation.&lt;br/&gt;
&lt;br/&gt;
(Own implementation is needed because of a more complex Renderer that DefaultTreeCellRenderer and the accessibility needs correct data.)&lt;br/&gt;
</description>
                <environment></environment>
        <key id="5126183">JDK-8329667</key>
            <summary>[macos] Issue with JTree related fix for JDK-8317771</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://bugs.openjdk.org/images/jbsImages/p3.png">P3</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kizune">Alexander Zuev</assignee>
                                    <reporter username="mbaesken">Matthias Baesken</reporter>
                        <labels>
                            <label>a11y</label>
                            <label>accessibility</label>
                            <label>jdk17u-critical-request</label>
                            <label>jdk17u-critical-yes</label>
                            <label>jdk21u-critical-request</label>
                            <label>jdk21u-critical-yes</label>
                            <label>macos</label>
                            <label>regression</label>
                            <label>regression_8317771</label>
                            <label>sn_168</label>
                            <label>sn_169</label>
                            <label>sn_170</label>
                    </labels>
                <created>Thu, 4 Apr 2024 07:09:50 -0700</created>
                <updated>Tue, 17 Sep 2024 23:24:48 -0700</updated>
                            <resolved>Fri, 24 May 2024 17:37:41 -0700</resolved>
                                    <version>8u421</version>
                    <version>11.0.24-oracle</version>
                    <version>17.0.12-oracle</version>
                    <version>21.0.4-oracle</version>
                    <version>23</version>
                                    <fixVersion>23</fixVersion>
                                    <component>client-libs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="14703925" author="goetz" created="Tue, 10 Sep 2024 06:24:12 -0700"  >Critical request [17u] &lt;br/&gt;
&lt;br/&gt;
For reason and testing see the 21u request. &lt;br/&gt;
In 17, I had to resolve a Copyright, but it&amp;#39;s recognized clean anyways.</comment>
                            <comment id="14703924" author="roboduke" created="Tue, 10 Sep 2024 06:23:09 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u/pull/397&quot;&gt;https://git.openjdk.org/jdk17u/pull/397&lt;/a&gt;&lt;br/&gt;
Date: 2024-09-10 13:17:45 +0000</comment>
                            <comment id="14703923" author="roboduke" created="Tue, 10 Sep 2024 06:16:39 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u/pull/452&quot;&gt;https://git.openjdk.org/jdk21u/pull/452&lt;/a&gt;&lt;br/&gt;
Date: 2024-09-10 13:10:24 +0000</comment>
                            <comment id="14703920" author="goetz" created="Tue, 10 Sep 2024 06:09:58 -0700"  >Critical request [21u]&lt;br/&gt;
&lt;br/&gt;
This fixes a recent regression in 21.0.3 and 17.0.11. This risk of this change  is very limited: accessability coding on mac. But it is a helpful fix of accessability. I ran this through SAPs testing for a while now, and it was tested by our a11y team.&lt;br/&gt;
So I would like to still include this in the October update.&lt;br/&gt;
Clean backport.</comment>
                            <comment id="14676131" author="dukebot" created="Fri, 24 May 2024 17:37:40 -0700"  >Changeset: 05f13e75&lt;br/&gt;
Author:    Alexander Zuev &amp;lt;&lt;a href=&apos;mailto:kizune@openjdk.org&apos;&gt;kizune@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2024-05-25 00:35:56 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/05f13e75ee4407ba9213c69b33c6032aa87c9e95&quot;&gt;https://git.openjdk.org/jdk/commit/05f13e75ee4407ba9213c69b33c6032aa87c9e95&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14673774" author="roboduke" created="Wed, 15 May 2024 18:34:06 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/19255&quot;&gt;https://git.openjdk.org/jdk/pull/19255&lt;/a&gt;&lt;br/&gt;
Date: 2024-05-16 01:28:37 +0000</comment>
                            <comment id="14670765" author="vdyakov" created="Fri, 3 May 2024 09:29:49 -0700"  >Alex is working on proposed solution to review</comment>
                            <comment id="14668819" author="kizune" created="Mon, 29 Apr 2024 04:49:15 -0700"  >Just to add a bit of background here:&lt;br/&gt;
The way native accessibility subsystem on Mac retrieves information about the JTree structure and the current selection is by calling method CAccessibility.getChildrenAndRolesRecursive() providing filtering parameters such as only retrieve selection or should be items with accessibilityIgnored=TRUE be included in the output. As the method name states what it does is going trough the Tree hierarchy recursively and retrieve all the children, then filters out the children that do not satisfy filter conditions. This is quite a slow process because going trough the accessible hierarchy requires doing a lot of getAccessibleContext.getAccessibleChild/.getAccessibleSelection chain calls and and on trees with large numbers of nodes it causes a significant delays in processing these requests. It was not a dealbreaker because usually the methods are being called by the VoiceOver and the time it takes to audition result compensated slowness of the data retrieval. But in macOS 14 Apple decided to use native accessibility calls to gather information about the components even when VoiceOver is not active and that meant that these cals can arrive from the native side much more frequently which in turn caused application with large number of nodes in Tree to freeze for a significant time processing all these events.&lt;br/&gt;
&lt;br/&gt;
That was covered in bug &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8317771&quot; title=&quot;[macos14] Expand/collapse a JTree using keyboard freezes the application in macOS 14 Sonoma&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8317771&quot;&gt;&lt;strike&gt;JDK-8317771&lt;/strike&gt;&lt;/a&gt; and the solution was to use existing functionality of JTree that allows to retrieve all the paths to its leaf nodes/selected leaf nodes by calling getPathForRow/getSelectionPaths accordingly. This way we have all the information needed to create an Accessible object representing the state of the said leaf. Problem is that the method that creates this object is not public and to circumvent this the reflection API was used to directly instantiate the representing object by calling its constructor. And here comes the current bug - client created its own custom tree by extending the JTree class and because client cares about the accessibility to properly reflect the custom properties of the class client also implemented the AccessibilityContext by overriding the getAccessibleContext method. The structure and naming of the inner classes was not the same as the original Accessible interface of JTree and because of that reflection API failed to find the required inner class constructor causing exception to be printed out and the accessibility functionality not working at all. The currently proposed solution is to use existing SwingAccessor proxy class to give CAccessibility class access to the protected method that instantiates TreeNode accessible representation but that will not work with this custom accessibility implementation either because by calling this method from the base class we will go straight to the default implementation bypassing any customizations - unless they in turn expose their custom accessibility code trough the SwingAccessor. This is not the ideal situation because that will make this change backward incompatible - without this modification the custom accessibility code will not be executed while it was executed prior to the &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8317771&quot; title=&quot;[macos14] Expand/collapse a JTree using keyboard freezes the application in macOS 14 Sonoma&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8317771&quot;&gt;&lt;strike&gt;JDK-8317771&lt;/strike&gt;&lt;/a&gt; fix. Right now I am trying to figure out if there is a possibility of the fix that does not involve public API change but will be backwards compatible.</comment>
                            <comment id="14666596" author="roboduke" created="Fri, 19 Apr 2024 08:37:50 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/18867&quot;&gt;https://git.openjdk.org/jdk/pull/18867&lt;/a&gt;&lt;br/&gt;
Date: 2024-04-19 15:16:41 +0000</comment>
                            <comment id="14666512" author="JIRAUSER19712" created="Fri, 19 Apr 2024 04:04:34 -0700"  >It looks like the only way we can solve this is to add API to create an accessibility child object.</comment>
                            <comment id="14663102" author="mbaesken" created="Fri, 5 Apr 2024 00:49:57 -0700"  >Our user provided the example attached for reproducing the issue :&lt;br/&gt;
JTreeBug (main)&lt;br/&gt;
MyJTree: modified Tree&lt;br/&gt;
&amp;nbsp;&lt;br/&gt;
</comment>
                            <comment id="14663015" author="JIRAUSER19712" created="Thu, 4 Apr 2024 14:39:48 -0700"  >Could you please provide an example that reproduces this problem, or log?&lt;br/&gt;
I have now retested at ```test/jdk/java/awt/a11y/AccessibleJTreeTest.java```&lt;br/&gt;
There are no errors, although there are custom renderers.</comment>
                            <comment id="14662922" author="vdyakov" created="Thu, 4 Apr 2024 08:55:54 -0700"  >[~asemenov] [~kizune] please take a look at this issue</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5136796">JDK-8338388</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5137456">JDK-8338948</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5137543">JDK-8339033</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5137544">JDK-8339034</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5139078">JDK-8340134</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5139079">JDK-8340135</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5139330">JDK-8340349</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5139333">JDK-8340352</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10002">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                                        </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5119171">JDK-8323965</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5111903">JDK-8317771</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="108855" name="JTreeBug.java" size="1663" author="mbaesken" created="Fri, 5 Apr 2024 00:48:59 -0700"/>
                            <attachment id="108854" name="MyJTree.java" size="61124" author="mbaesken" created="Fri, 5 Apr 2024 00:48:39 -0700"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17008"><![CDATA[generic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10003" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Introduced In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17303"><![CDATA[b01]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10004" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Introduced In Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="23056">8u421</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17017"><![CDATA[os_x]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i35sbn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17411"><![CDATA[b25]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="367"><![CDATA[javax.accessibility]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>