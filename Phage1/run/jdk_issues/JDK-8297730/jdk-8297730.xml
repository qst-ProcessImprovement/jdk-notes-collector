<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 14:28:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8297730] C2: Arraycopy intrinsic throws incorrect exception</title>
                <link>https://bugs.openjdk.org/browse/JDK-8297730</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>ADDITIONAL SYSTEM INFORMATION :&lt;br/&gt;
# Java version&lt;br/&gt;
java 19.0.1 2022-10-18&lt;br/&gt;
Java(TM) SE Runtime Environment (build 19.0.1+10-21)&lt;br/&gt;
Java HotSpot(TM) 64-Bit Server VM (build 19.0.1+10-21, mixed mode, sharing)&lt;br/&gt;
&lt;br/&gt;
# Operating system details&lt;br/&gt;
$ cat /etc/*release&lt;br/&gt;
DISTRIB_ID=Ubuntu&lt;br/&gt;
DISTRIB_RELEASE=18.04&lt;br/&gt;
DISTRIB_CODENAME=bionic&lt;br/&gt;
DISTRIB_DESCRIPTION=&amp;quot;Ubuntu 18.04.5 LTS&amp;quot;&lt;br/&gt;
NAME=&amp;quot;Ubuntu&amp;quot;&lt;br/&gt;
VERSION=&amp;quot;18.04.5 LTS (Bionic Beaver)&amp;quot;&lt;br/&gt;
ID=ubuntu&lt;br/&gt;
ID_LIKE=debian&lt;br/&gt;
PRETTY_NAME=&amp;quot;Ubuntu 18.04.5 LTS&amp;quot;&lt;br/&gt;
VERSION_ID=&amp;quot;18.04&amp;quot;&lt;br/&gt;
HOME_URL=&amp;quot;&lt;a href=&quot;https://www.ubuntu.com/&quot;&gt;https://www.ubuntu.com/&lt;/a&gt;&amp;quot;&lt;br/&gt;
SUPPORT_URL=&amp;quot;&lt;a href=&quot;https://help.ubuntu.com/&quot;&gt;https://help.ubuntu.com/&lt;/a&gt;&amp;quot;&lt;br/&gt;
BUG_REPORT_URL=&amp;quot;&lt;a href=&quot;https://bugs.launchpad.net/ubuntu/&quot;&gt;https://bugs.launchpad.net/ubuntu/&lt;/a&gt;&amp;quot;&lt;br/&gt;
PRIVACY_POLICY_URL=&amp;quot;&lt;a href=&quot;https://www.ubuntu.com/legal/terms-and-policies/privacy-policy&quot;&gt;https://www.ubuntu.com/legal/terms-and-policies/privacy-policy&lt;/a&gt;&amp;quot;&lt;br/&gt;
VERSION_CODENAME=bionic&lt;br/&gt;
UBUNTU_CODENAME=bionic&lt;br/&gt;
&lt;br/&gt;
$ uname -a&lt;br/&gt;
Linux seoul 5.4.0-99-generic #112~18.04.1-Ubuntu SMP Thu Feb 3 14:09:57 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
A DESCRIPTION OF THE PROBLEM :&lt;br/&gt;
Different outputs of the attached program are observed between different compilation tiers. This bug affects java 11.0.17 2022-10-18, java 17 2021-09-14 LTS, Oracle JDK 18.0.2.1, Oracle JDK 19.0.1, and openjdk 20-ea 2023-03-21. It was not reproduced in java version &amp;quot;1.8.0_351&amp;quot;.&lt;br/&gt;
&lt;br/&gt;
REGRESSION : Last worked in version 8u351&lt;br/&gt;
&lt;br/&gt;
STEPS TO FOLLOW TO REPRODUCE THE PROBLEM :&lt;br/&gt;
The following steps shows how to reproduce the bug on Java 19.0.1 in a&lt;br/&gt;
Ubuntu Linux environment.&lt;br/&gt;
&lt;br/&gt;
# Compile&lt;br/&gt;
$ javac C.java&lt;br/&gt;
&lt;br/&gt;
# Default or compilation up to level 4&lt;br/&gt;
$ java C&lt;br/&gt;
# Output (incorrect)&lt;br/&gt;
99997&lt;br/&gt;
&lt;br/&gt;
# Compilation up to level 1&lt;br/&gt;
$ java -XX:TieredStopAtLevel=1 C&lt;br/&gt;
# Output (correct)&lt;br/&gt;
100000&lt;br/&gt;
&lt;br/&gt;
# Interpreter or compilation up to level 0&lt;br/&gt;
$ java -Xint C&lt;br/&gt;
# Output (correct)&lt;br/&gt;
100000&lt;br/&gt;
&lt;br/&gt;
EXPECTED VERSUS ACTUAL BEHAVIOR :&lt;br/&gt;
EXPECTED -&lt;br/&gt;
100000&lt;br/&gt;
ACTUAL -&lt;br/&gt;
99997&lt;br/&gt;
&lt;br/&gt;
---------- BEGIN SOURCE ----------&lt;br/&gt;
public class C {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;static byte[] m(byte[] arg1) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;byte[] b = new byte[-1];&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;System.arraycopy(arg1, 0, b, 0, arg1.length);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return b;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;public static void main(String[] args) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;int count = 0;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;for (int i = 0; i &amp;lt; 100_000; ++i) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;try {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;System.out.println(m(null));&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;} catch (Throwable e) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (e instanceof java.lang.NegativeArraySizeException) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;count++;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;System.out.println(count); // Should be 100_000&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
}&lt;br/&gt;
---------- END SOURCE ----------&lt;br/&gt;
&lt;br/&gt;
CUSTOMER SUBMITTED WORKAROUND :&lt;br/&gt;
Interpreter or compilation for Level 0, 1, 2, 3 are fine.&lt;br/&gt;
$ java -XX:TieredStopAtLevel=3 C&lt;br/&gt;
&lt;br/&gt;
FREQUENCY : always&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
        <key id="5086076">JDK-8297730</key>
            <summary>C2: Arraycopy intrinsic throws incorrect exception</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://bugs.openjdk.org/images/jbsImages/p3.png">P3</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chagedorn">Christian Hagedorn</assignee>
                                    <reporter username="webbuggrp">Webbug Group</reporter>
                        <labels>
                            <label>c2</label>
                            <label>intrinsic</label>
                            <label>jdk11u-fix-request</label>
                            <label>jdk11u-fix-yes</label>
                            <label>jdk17u-fix-request</label>
                            <label>jdk17u-fix-yes</label>
                            <label>jdk20u-fix-SQE-ok-next</label>
                            <label>jdk20u-fix-request</label>
                            <label>jdk20u-fix-yes</label>
                            <label>oracle-triage-20</label>
                            <label>webbug</label>
                    </labels>
                <created>Mon, 24 Oct 2022 15:22:38 -0700</created>
                <updated>Mon, 5 Jun 2023 09:34:12 -0700</updated>
                            <resolved>Tue, 24 Jan 2023 23:24:02 -0800</resolved>
                                    <version>9</version>
                    <version>11</version>
                    <version>17</version>
                    <version>18</version>
                    <version>19</version>
                    <version>20</version>
                    <version>21</version>
                                    <fixVersion>21</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>11</watches>
                                                                                                                <comments>
                            <comment id="14586666" author="roboduke" created="Fri, 2 Jun 2023 08:16:46 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk11u-dev/pull/1926&quot;&gt;https://git.openjdk.org/jdk11u-dev/pull/1926&lt;/a&gt;&lt;br/&gt;
Date: 2023-06-02 15:09:12 +0000</comment>
                            <comment id="14586660" author="goetz" created="Fri, 2 Jun 2023 08:10:27 -0700"  >&lt;br/&gt;
Fix request [11u]&lt;br/&gt;
&lt;br/&gt;
I backport this for parity with 11.0.20-oracle.&lt;br/&gt;
Typical C2 risk, a bigger change that also needed rework. But the test reproduces the issue.&lt;br/&gt;
I had to adapt the code and mix old and new.&lt;br/&gt;
Test passes and fails without the fix. SAP nightly testing passed.</comment>
                            <comment id="14575008" author="roboduke" created="Wed, 19 Apr 2023 02:48:30 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u-dev/pull/1270&quot;&gt;https://git.openjdk.org/jdk17u-dev/pull/1270&lt;/a&gt;&lt;br/&gt;
Date: 2023-04-19 09:41:46 +0000</comment>
                            <comment id="14575005" author="goetz" created="Wed, 19 Apr 2023 02:41:34 -0700"  >Fix request [17u]&lt;br/&gt;
&lt;br/&gt;
I backport this for parity with 17.0.8-oracle.&lt;br/&gt;
Typical C2 risk, a bigger change. Clean repro case.&lt;br/&gt;
Clean backport.&lt;br/&gt;
Test passes and fails without the fix. SAP nightly testing passed.&lt;br/&gt;
</comment>
                            <comment id="14570345" author="roboduke" created="Wed, 29 Mar 2023 04:14:19 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk20u/pull/31&quot;&gt;https://git.openjdk.org/jdk20u/pull/31&lt;/a&gt;&lt;br/&gt;
Date: 2023-03-29 11:04:32 +0000</comment>
                            <comment id="14570331" author="thartmann" created="Wed, 29 Mar 2023 04:05:39 -0700"  >Fix Request (JDK 20u)&lt;br/&gt;
Resolves an issue with incorrect execution of C2 compiled code. The fix is medium risk, was already backported to Oracle JDK 17u / 11u and tested in the JDK 21 and 17u / 11u CIs. The backport applies cleanly.</comment>
                            <comment id="14554237" author="dukebot" created="Tue, 24 Jan 2023 23:23:59 -0800"  >Changeset: 5a478ef7&lt;br/&gt;
Author:    Christian Hagedorn &amp;lt;&lt;a href=&apos;mailto:chagedorn@openjdk.org&apos;&gt;chagedorn@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-01-25 07:22:12 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/5a478ef7759e64da6d17426673700ff0d9c66b33&quot;&gt;https://git.openjdk.org/jdk/commit/5a478ef7759e64da6d17426673700ff0d9c66b33&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14553141" author="roboduke" created="Fri, 20 Jan 2023 09:29:32 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/12120&quot;&gt;https://git.openjdk.org/jdk/pull/12120&lt;/a&gt;&lt;br/&gt;
Date: 2023-01-20 17:10:58 +0000</comment>
                            <comment id="14546409" author="JIRAUSER20406" created="Mon, 19 Dec 2022 05:26:08 -0800"  >Thanks Christian for narrowing it down. Seems to have been introduced between b50 and b65 in 9 (unfortunately, don&amp;#39;t have much to go by in terms of intermediate builds). There are a few _arraycopy related changes committed in this range.</comment>
                            <comment id="14541130" author="chagedorn" created="Mon, 28 Nov 2022 23:47:30 -0800"  >This already reproduces with JDK 9 (tested with JDK 9+181). Since this is an old regression and the fork is coming up next Thursday, I&amp;#39;m moving this to JDK 21. If a fix is still found in time, this can be re-targeted to JDK 20.</comment>
                            <comment id="14541129" author="chagedorn" created="Mon, 28 Nov 2022 23:40:11 -0800"  >ILW = Throwing NullPointerException instead of NegativeArraySizeException with _arraycopy intrinsic, single testcase, disable intrinsic with -XX:DisableIntrinsic=_arraycopy = HLM = P3</comment>
                            <comment id="14540665" author="thartmann" created="Mon, 28 Nov 2022 08:35:13 -0800"  >This is reproducible with latest JDK 20 and should be moved from JI to JDK (hotspot/compiler).</comment>
                            <comment id="14532470" author="fmatte" created="Tue, 25 Oct 2022 21:38:24 -0700"  >Hi Daniel, can you look into this issue</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5093521">JDK-8301948</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5093528">JDK-8301955</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5097851">JDK-8305546</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5098984">JDK-8306513</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5099649">JDK-8307025</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5102536">JDK-8309487</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10002">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="5092700">JDK-8301660</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="4769554">JDK-8073866</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17008"><![CDATA[generic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17010"><![CDATA[generic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2z0sb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17335"><![CDATA[b07]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="208"><![CDATA[compiler]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>