<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 12:47:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8326106] Write and clear stack trace table outside of safepoint</title>
                <link>https://bugs.openjdk.org/browse/JDK-8326106</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>When the chunk rotates, serializing the stack trace table happens in two passes: 1) the pre-safepoint writes as much as possible but does not delete nodes. 2) The safepoint writes new entries incrementally and deletes nodes in addition to resetting buckets.&lt;br/&gt;
&lt;br/&gt;
Since a global lock protects the stack trace table, hoisting the deletes and clearing the table outside safepoints makes sense. Doing so will minimize the stack trace table work needed during the safepoint. The tradeoff is that an identical stack trace can be written twice. However, this is low risk because the pre-safepoint and the safepoint operations happen back to back (i.e. there is only a tiny window for inserting a new stack trace).&lt;br/&gt;
&lt;br/&gt;
For example:&lt;br/&gt;
&lt;br/&gt;
diff --git a/src/hotspot/share/jfr/recorder/service/jfrRecorderService.cpp b/src/hotspot/share/jfr/recorder/service/jfrRecorderService.cpp&lt;br/&gt;
index a9f0cecb53c..8b019cbc8a2 100644&lt;br/&gt;
--- a/src/hotspot/share/jfr/recorder/service/jfrRecorderService.cpp&lt;br/&gt;
+++ b/src/hotspot/share/jfr/recorder/service/jfrRecorderService.cpp&lt;br/&gt;
@@ -573,9 +573,7 @@ void JfrRecorderService::pre_safepoint_write() {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ObjectSampleCheckpoint::on_rotation(ObjectSampler::acquire());&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;write_storage(_storage, _chunkwriter);&lt;br/&gt;
-  if (_stack_trace_repository.is_modified()) {&lt;br/&gt;
-    write_stacktrace(_stack_trace_repository, _chunkwriter, false);&lt;br/&gt;
-  }&lt;br/&gt;
+  write_stacktrace(_stack_trace_repository, _chunkwriter, true); // true == clear the table&lt;br/&gt;
&amp;nbsp;}&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;void JfrRecorderService::invoke_safepoint_write() {</description>
                <environment></environment>
        <key id="5121755">JDK-8326106</key>
            <summary>Write and clear stack trace table outside of safepoint</summary>
                <type id="7" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14707&amp;avatarType=issuetype">Enhancement</type>
                                            <priority id="3" iconUrl="https://bugs.openjdk.org/images/jbsImages/p3.png">P3</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mgronlun">Markus Gr&#246;nlund</assignee>
                                    <reporter username="mgronlun">Markus Gr&#246;nlund</reporter>
                        <labels>
                            <label>jdk17u-fix-request</label>
                            <label>jdk17u-fix-yes</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>jdk22u-fix-SQE-ok</label>
                            <label>jdk22u-fix-request</label>
                            <label>jdk22u-fix-yes</label>
                    </labels>
                <created>Sat, 17 Feb 2024 07:45:48 -0800</created>
                <updated>Wed, 5 Jun 2024 01:43:09 -0700</updated>
                            <resolved>Mon, 19 Feb 2024 05:21:43 -0800</resolved>
                                    <version>8-pool-perf</version>
                    <version>17-pool-oracle</version>
                    <version>21-pool-oracle</version>
                                    <fixVersion>23</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="14678695" author="roboduke" created="Tue, 4 Jun 2024 02:40:14 -0700"  >[jdk17u-fix-request] Approval Request from Martin&lt;br/&gt;
Should get backported for parity with 17.0.12-oracle. Applies cleanly. Tier 1-4 have passed.</comment>
                            <comment id="14677814" author="roboduke" created="Fri, 31 May 2024 06:24:09 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u-dev/pull/2514&quot;&gt;https://git.openjdk.org/jdk17u-dev/pull/2514&lt;/a&gt;&lt;br/&gt;
Date: 2024-05-31 13:16:50 +0000</comment>
                            <comment id="14677554" author="roboduke" created="Thu, 30 May 2024 09:21:50 -0700"  >[jdk21u-fix-request] Approval Request from Martin&lt;br/&gt;
Should get backported for parity with 21.0.4-oracle. Applies cleanly and tier1-4 have passed.</comment>
                            <comment id="14677209" author="roboduke" created="Wed, 29 May 2024 07:02:07 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/615&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/615&lt;/a&gt;&lt;br/&gt;
Date: 2024-05-29 13:55:38 +0000</comment>
                            <comment id="14666561" author="roboduke" created="Fri, 19 Apr 2024 06:09:13 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk22u/pull/155&quot;&gt;https://git.openjdk.org/jdk22u/pull/155&lt;/a&gt;&lt;br/&gt;
Date: 2024-04-19 13:02:37 +0000</comment>
                            <comment id="14666560" author="coffeys" created="Fri, 19 Apr 2024 06:07:21 -0700"  >22u Fix Request&lt;br/&gt;
JFR recorder improvements. Already ported to jdk21u-oracle</comment>
                            <comment id="14650436" author="dukebot" created="Mon, 19 Feb 2024 05:21:42 -0800"  >Changeset: a776104e&lt;br/&gt;
Author:    Markus Gr&amp;#xF6;nlund &amp;lt;&lt;a href=&apos;mailto:mgronlun@openjdk.org&apos;&gt;mgronlun@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2024-02-19 13:19:12 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/a776104e210db212c4e32894844d3c0cbaac53c3&quot;&gt;https://git.openjdk.org/jdk/commit/a776104e210db212c4e32894844d3c0cbaac53c3&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14650271" author="roboduke" created="Sun, 18 Feb 2024 11:46:35 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/17905&quot;&gt;https://git.openjdk.org/jdk/pull/17905&lt;/a&gt;&lt;br/&gt;
Date: 2024-02-18 19:42:38 +0000</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5125406">JDK-8329192</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5125503">JDK-8329242</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5127511">JDK-8330777</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5130762">JDK-8333336</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5131113">JDK-8333635</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i351nv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17311"><![CDATA[b11]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="374"><![CDATA[jfr]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>