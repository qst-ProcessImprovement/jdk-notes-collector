<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 15:33:24 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8299975] Limit underflow protection CMoveINode in PhaseIdealLoop::do_unroll must also protect type from underflow</title>
                <link>https://bugs.openjdk.org/browse/JDK-8299975</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>The following test failed in the JDK20 CI:&lt;br/&gt;
&lt;br/&gt;
sun/nio/cs/FindOneCharEncoderBugs.java&lt;br/&gt;
&lt;br/&gt;
Here&amp;#39;s a snippet from the log file:&lt;br/&gt;
&lt;br/&gt;
----------stdout:(21/1323)*----------&lt;br/&gt;
# To suppress the following error report, specify this argument&lt;br/&gt;
# after -XX: or in .hotspotrc:  SuppressErrorAt=\\loopnode.cpp:2169&lt;br/&gt;
#&lt;br/&gt;
# A fatal error has been detected by the Java Runtime Environment:&lt;br/&gt;
#&lt;br/&gt;
#  Internal Error (c:\\sb\\prod\\1673325984\\workspace\\open\\src\\hotspot\\share\\opto\\loopnode.cpp:2169), pid=9040, tid=17328&lt;br/&gt;
#  assert(inner-&amp;gt;is_valid_counted_loop(T_INT) &amp;amp;&amp;amp; inner-&amp;gt;is_strip_mined()) failed: OuterStripMinedLoop should have been removed&lt;br/&gt;
#&lt;br/&gt;
# JRE version: Java(TM) SE Runtime Environment (20.0+31) (fastdebug build 20-ea+31-2305)&lt;br/&gt;
# Java VM: Java HotSpot(TM) 64-Bit Server VM (fastdebug 20-ea+31-2305, mixed mode, tiered, compressed oops, compressed class ptrs, g1 gc, windows-amd64)&lt;br/&gt;
# Core dump will be written. Default location: C:\\sb\\prod\\1673430100\\testoutput\\test-support\\jtreg_open_test_jdk_jdk_nio\\scratch\\4\\hs_err_pid9040.mdmp&lt;br/&gt;
#&lt;br/&gt;
# An error report file with more information is saved as:&lt;br/&gt;
# C:\\sb\\prod\\1673430100\\testoutput\\test-support\\jtreg_open_test_jdk_jdk_nio\\scratch\\4\\hs_err_pid9040.log&lt;br/&gt;
#&lt;br/&gt;
# Compiler replay data is saved as:&lt;br/&gt;
# C:\\sb\\prod\\1673430100\\testoutput\\test-support\\jtreg_open_test_jdk_jdk_nio\\scratch\\4\\replay_pid9040.log&lt;br/&gt;
#&lt;br/&gt;
# If you would like to submit a bug report, please visit:&lt;br/&gt;
#   &lt;a href=&quot;https://bugreport.java.com/bugreport/crash.jsp&quot;&gt;https://bugreport.java.com/bugreport/crash.jsp&lt;/a&gt;&lt;br/&gt;
#&lt;br/&gt;
result: Error. Agent communication error: java.net.SocketException: Connection reset; check console log for any additional details&lt;br/&gt;
&lt;br/&gt;
Here&amp;#39;s the crashing thread&amp;#39;s stack:&lt;br/&gt;
&lt;br/&gt;
---------------  T H R E A D  ---------------&lt;br/&gt;
&lt;br/&gt;
Current thread (0x000002382dd5b8c0):  JavaThread &amp;quot;C2 CompilerThread0&amp;quot; daemon [_thread_in_native, id=17328, stack(0x0000006f5e400000,0x0000006f5e500000)]&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Current CompileTask:&lt;br/&gt;
C2: 224992 5613   !   4       sun.nio.cs.ext.EUC_JP$Encoder::encodeBufferLoop (289 bytes)&lt;br/&gt;
&lt;br/&gt;
Stack: [0x0000006f5e400000,0x0000006f5e500000]&lt;br/&gt;
Native frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native code)&lt;br/&gt;
V  [jvm.dll+0xbfdb51]  os::win32::platform_print_native_stack+0xf1  (os_windows_x86.cpp:236)&lt;br/&gt;
V  [jvm.dll+0xe7f780]  VMError::report+0x10c0  (vmError.cpp:813)&lt;br/&gt;
V  [jvm.dll+0xe813be]  VMError::report_and_die+0x6ce  (vmError.cpp:1593)&lt;br/&gt;
V  [jvm.dll+0xe81b04]  VMError::report_and_die+0x64  (vmError.cpp:1352)&lt;br/&gt;
V  [jvm.dll+0x5717b7]  report_vm_error+0xb7  (debug.cpp:286)&lt;br/&gt;
V  [jvm.dll+0xaa8daa]  LoopNode::verify_strip_mined+0x14a  (loopnode.cpp:2169)&lt;br/&gt;
V  [jvm.dll+0xa70a55]  PathFrequency::to+0xef5  (loopPredicate.cpp:1077)&lt;br/&gt;
V  [jvm.dll+0xa6cacb]  PhaseIdealLoop::loop_predication_impl+0x74b  (loopPredicate.cpp:1575)&lt;br/&gt;
V  [jvm.dll+0xa6be48]  IdealLoopTree::loop_predication+0x58  (loopPredicate.cpp:1621)&lt;br/&gt;
V  [jvm.dll+0xa8df39]  PhaseIdealLoop::build_and_optimize+0x1089  (loopnode.cpp:4539)&lt;br/&gt;
V  [jvm.dll+0x5074bd]  Compile::Optimize+0x108d  (compile.cpp:2382)&lt;br/&gt;
V  [jvm.dll+0x5043aa]  Compile::Compile+0x163a  (compile.cpp:831)&lt;br/&gt;
V  [jvm.dll+0x427855]  C2Compiler::compile_method+0x145  (c2compiler.cpp:116)&lt;br/&gt;
V  [jvm.dll+0x51e528]  CompileBroker::invoke_compiler_on_method+0x858  (compileBroker.cpp:2240)&lt;br/&gt;
V  [jvm.dll+0x51bced]  CompileBroker::compiler_thread_loop+0x23d  (compileBroker.cpp:1917)&lt;br/&gt;
V  [jvm.dll+0x7eb2c2]  JavaThread::thread_main_inner+0x282  (javaThread.cpp:710)&lt;br/&gt;
V  [jvm.dll+0xdfa703]  Thread::call_run+0x253  (thread.cpp:229)&lt;br/&gt;
V  [jvm.dll+0xbfc468]  thread_native_entry+0xb8  (os_windows.cpp:547)&lt;br/&gt;
C  [ucrtbase.dll+0x2268a]&lt;br/&gt;
C  [KERNEL32.DLL+0x17974]&lt;br/&gt;
C  [ntdll.dll+0x5a0b1]</description>
                <environment></environment>
        <key id="5091180">JDK-8299975</key>
            <summary>Limit underflow protection CMoveINode in PhaseIdealLoop::do_unroll must also protect type from underflow</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://bugs.openjdk.org/images/jbsImages/p3.png">P3</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="epeter">Emanuel Peter</assignee>
                                    <reporter username="dcubed">Daniel Daugherty</reporter>
                        <labels>
                            <label>c2</label>
                            <label>intermittent</label>
                            <label>oracle-triage-11</label>
                            <label>oracle-triage-17</label>
                            <label>oracle-triage-21</label>
                            <label>regression</label>
                            <label>tier7</label>
                    </labels>
                <created>Wed, 11 Jan 2023 06:53:22 -0800</created>
                <updated>Mon, 6 Feb 2023 02:14:37 -0800</updated>
                            <resolved>Mon, 23 Jan 2023 05:15:32 -0800</resolved>
                                    <version>20</version>
                    <version>21</version>
                                    <fixVersion>21</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="14553466" author="dukebot" created="Mon, 23 Jan 2023 05:15:30 -0800"  >Changeset: 5a4945c0&lt;br/&gt;
Author:    Emanuel Peter &amp;lt;&lt;a href=&apos;mailto:epeter@openjdk.org&apos;&gt;epeter@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-01-23 13:10:42 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/5a4945c0d95423d0ab07762c915e9cb4d3c66abb&quot;&gt;https://git.openjdk.org/jdk/commit/5a4945c0d95423d0ab07762c915e9cb4d3c66abb&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14552700" author="roboduke" created="Thu, 19 Jan 2023 04:23:20 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/12092&quot;&gt;https://git.openjdk.org/jdk/pull/12092&lt;/a&gt;&lt;br/&gt;
Date: 2023-01-19 11:25:10 +0000</comment>
                            <comment id="14552631" author="JIRAUSER19821" created="Thu, 19 Jan 2023 00:07:56 -0800"  >Together with [~chagedorn] we were playing around, and found a much easier reproducer, though it only reproduces with TraceLoopOpts. (see H.java)&lt;br/&gt;
&lt;br/&gt;
It reproduces deterministically without -XX:+StressIGVN, but I don&amp;#39;t trust that to hold for long. So I added this to make it reproduce at least 50% of times: -XX:+StressIGVN -XX:RepeatCompilation=100&lt;br/&gt;
&lt;br/&gt;
./java -Xcomp -XX:+TraceLoopOpts -XX:-TieredCompilation -XX:CompileOnly=H::test -XX:CompileCommand=dontinline,H::* -XX:+StressIGVN -XX:RepeatCompilation=100 H.java&lt;br/&gt;
&lt;br/&gt;
...&lt;br/&gt;
PreMainPost      Loop: N195/N170  limit_check profile_predicated predicated counted [0,int),+1 (2147483648 iters)  has_sfpt strip_mined&lt;br/&gt;
Unroll 2( 2)     Loop: N195/N170  counted [int,int),+1 (2147483648 iters)  main has_sfpt strip_mined&lt;br/&gt;
Loop: N0/N0  has_call has_sfpt&lt;br/&gt;
&amp;nbsp;&amp;nbsp;Loop: N305/N309  limit_check profile_predicated predicated counted [0,int),+1 (4 iters)  pre&lt;br/&gt;
&amp;nbsp;&amp;nbsp;Loop: N194/N193  sfpts={ 196 }&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Loop: N434/N170  counted [int,int),#&lt;br/&gt;
# A fatal error has been detected by the Java Runtime Environment:&lt;br/&gt;
#&lt;br/&gt;
#  SIGSEGV (0xb) at pc=0x00007f40efeed8c1, pid=753804, tid=753817&lt;br/&gt;
#&lt;br/&gt;
# JRE version: Java(TM) SE Runtime Environment (21.0) (fastdebug build 21-internal-LTS-2023-01-16-1431317.emanuel...)&lt;br/&gt;
# Java VM: Java HotSpot(TM) 64-Bit Server VM (fastdebug 21-internal-LTS-2023-01-16-1431317.emanuel..., compiled mode, tiered, compressed oops, compressed class ptrs, g1 gc, linux-amd64)&lt;br/&gt;
# Problematic frame:&lt;br/&gt;
# V  [libjvm.so+0x14ac8c1]  BaseCountedLoopEndNode::stride_con() const+0x51&lt;br/&gt;
&lt;br/&gt;
The issue is the same: Phi collapses to constant, AddI(phi, stride) collapses to constant -&amp;gt; cannot find stride any more.</comment>
                            <comment id="14551700" author="JIRAUSER19821" created="Tue, 17 Jan 2023 08:33:58 -0800"  >Found a reproducer Test.java, attached.&lt;br/&gt;
Reproduces both on JDK20 and JDK21. A little intermittent, therefore the RepeatCompilation, catches it in more than 50% of runs.&lt;br/&gt;
&lt;br/&gt;
./java -XX:CompileCommand=compileonly,Test::test -XX:CompileCommand=printcompilation,Test::test -XX:-PrintInlining -XX:-TraceLoopOpts -Xbatch -XX:+StressIGVN -XX:RepeatCompilation=100 Test.java</comment>
                            <comment id="14550648" author="JIRAUSER19821" created="Thu, 12 Jan 2023 04:03:45 -0800"  >Posted replay file here &amp;quot;r.log&amp;quot;&lt;br/&gt;
./java -XX:+PrintCompilation -XX:+ReplayCompiles -XX:+ReplayIgnoreInitErrors -XX:ReplayDataFile=r.log</comment>
                            <comment id="14550608" author="dlong" created="Thu, 12 Jan 2023 01:11:54 -0800"  >I bisected the assert to this changeset:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;8294540: Remove Opaque2Node: it is broken and triggers assert&lt;br/&gt;
&lt;br/&gt;
[~epeter], please take a look.</comment>
                            <comment id="14550558" author="dlong" created="Wed, 11 Jan 2023 20:36:16 -0800"  >ILW = assert in debug build; intermittent; no workaround = MMH = P3</comment>
                            <comment id="14550557" author="dlong" created="Wed, 11 Jan 2023 20:35:17 -0800"  >Also reproduced on Linux by replacing sun/nio/cs/ext/EUC_JP with sun/nio/cs/EUC_JP in replay file.</comment>
                            <comment id="14550545" author="dlong" created="Wed, 11 Jan 2023 19:31:25 -0800"  >Reproduced with 20+27 through 20+31 with replay file.</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5049949">JDK-8267399</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="102349" name="H.java" size="551" author="epeter" created="Thu, 19 Jan 2023 00:08:04 -0800"/>
                            <attachment id="102334" name="Test.java" size="2687" author="epeter" created="Tue, 17 Jan 2023 08:34:13 -0800"/>
                            <attachment id="102287" name="r.log" size="302246" author="epeter" created="Thu, 12 Jan 2023 04:03:54 -0800"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="19000"><![CDATA[x86_64]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17010"><![CDATA[generic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2zver:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17335"><![CDATA[b07]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="208"><![CDATA[compiler]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>