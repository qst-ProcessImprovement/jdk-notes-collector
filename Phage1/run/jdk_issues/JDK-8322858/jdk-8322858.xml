<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 11:56:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8322858] compiler/c2/aarch64/TestFarJump.java fails on AArch64 due to unexpected PrintAssembly output</title>
                <link>https://bugs.openjdk.org/browse/JDK-8322858</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>Have only been seen on AArch64 so far.&lt;br/&gt;
&lt;br/&gt;
The failure message: &amp;#39;ADRP instruction is expected on far jump&amp;#39;&lt;br/&gt;
&lt;br/&gt;
The test log snippet:&lt;br/&gt;
&lt;br/&gt;
[2023-12-09T00:55:50.050350751Z] Gathering output for process 3299144&lt;br/&gt;
[Exception Handler]&lt;br/&gt;
&amp;nbsp;&amp;nbsp;0x0000ffff7ff028e0: f303 00aa | e817 40f9 | 88a7 02f9 | e81b 40f9 | 88af 02f9 | e907 40f9 | 89a3 02f9 | fd03 0191 &lt;br/&gt;
&amp;nbsp;&amp;nbsp;0x0000ffff7ff02900: a107 40f9 | e003 1caa | e833 bfa9 | 88c4 85d2 | 48c7 b2f2 | e8ff dff2 | 0001 3fd6 | e833 c1a8 &lt;br/&gt;
----------System.err:(11/636)----------&lt;br/&gt;
java.lang.RuntimeException: ADRP instruction is expected on far jump&lt;br/&gt;
	at compiler.c2.aarch64.TestFarJump.runVM(TestFarJump.java:113)&lt;br/&gt;
	at compiler.c2.aarch64.TestFarJump.main(TestFarJump.java:127)&lt;br/&gt;
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)&lt;br/&gt;
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)&lt;br/&gt;
	at com.sun.javatest.regtest.agent.MainActionHelper$AgentVMRunnable.run(MainActionHelper.java:333)&lt;br/&gt;
	at java.base/java.lang.VirtualThread.run(VirtualThread.java:321)&lt;br/&gt;
&lt;br/&gt;
A repetition of the &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8284681&quot; title=&quot;compiler/c2/aarch64/TestFarJump.java fails with &amp;quot;RuntimeException: for CodeHeap &amp;lt; 250MB the far jump is expected to be encoded with a single branch instruction&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8284681&quot;&gt;&lt;strike&gt;JDK-8284681&lt;/strike&gt;&lt;/a&gt;?&lt;br/&gt;
&lt;br/&gt;
All the failed tests had &amp;#39;-Duse.JTREG_TEST_THREAD_FACTORY=Virtual&amp;#39; specified.</description>
                <environment></environment>
        <key id="5117932">JDK-8322858</key>
            <summary>compiler/c2/aarch64/TestFarJump.java fails on AArch64 due to unexpected PrintAssembly output</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bulasevich">Boris Ulasevich</assignee>
                                    <reporter username="enikitin">Evgeny Nikitin</reporter>
                        <labels>
                            <label>atr</label>
                            <label>c2</label>
                            <label>jdk17u-fix-request</label>
                            <label>jdk17u-fix-yes</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>noreg-self</label>
                            <label>oracle-triage-23</label>
                    </labels>
                <created>Tue, 2 Jan 2024 08:37:38 -0800</created>
                <updated>Wed, 9 Oct 2024 23:32:28 -0700</updated>
                            <resolved>Tue, 9 Jan 2024 02:35:11 -0800</resolved>
                                    <version>17</version>
                    <version>21</version>
                    <version>22</version>
                    <version>23</version>
                                    <fixVersion>23</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="14666546" author="roboduke" created="Fri, 19 Apr 2024 05:29:56 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u-dev/pull/2419&quot;&gt;https://git.openjdk.org/jdk17u-dev/pull/2419&lt;/a&gt;&lt;br/&gt;
Date: 2024-04-19 12:24:54 +0000</comment>
                            <comment id="14666544" author="goetz" created="Fri, 19 Apr 2024 05:22:42 -0700"  >Fix request [17u]&lt;br/&gt;
&lt;br/&gt;
I backport this for parity with 17.0.12-oracle.&lt;br/&gt;
No risk, only a test change.&lt;br/&gt;
Clean backport. SAP nightly testing passed. Test passes.</comment>
                            <comment id="14659860" author="roboduke" created="Sat, 23 Mar 2024 12:23:29 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/398&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/398&lt;/a&gt;&lt;br/&gt;
Date: 2024-03-23 19:19:26 +0000</comment>
                            <comment id="14659857" author="goetz" created="Sat, 23 Mar 2024 12:21:19 -0700"  >Fix request [21u]&lt;br/&gt;
&lt;br/&gt;
I backport this for parity with 21.0.4-oracle.&lt;br/&gt;
No risk, only a test change.&lt;br/&gt;
Clean backport. &lt;br/&gt;
SAP nightly testing passed including this test.</comment>
                            <comment id="14638496" author="dukebot" created="Tue, 9 Jan 2024 02:35:10 -0800"  >Changeset: 52a6c375&lt;br/&gt;
Author:    Boris Ulasevich &amp;lt;&lt;a href=&apos;mailto:bulasevich@openjdk.org&apos;&gt;bulasevich@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2024-01-09 10:33:52 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/52a6c37558fa970f595067bc1bb5bc2b710c3876&quot;&gt;https://git.openjdk.org/jdk/commit/52a6c37558fa970f595067bc1bb5bc2b710c3876&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14637702" author="roboduke" created="Fri, 5 Jan 2024 03:37:15 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/17278&quot;&gt;https://git.openjdk.org/jdk/pull/17278&lt;/a&gt;&lt;br/&gt;
Date: 2024-01-05 11:32:16 +0000</comment>
                            <comment id="14637482" author="bulasevich" created="Thu, 4 Jan 2024 08:53:22 -0800"  >Thanks.&lt;br/&gt;
&lt;br/&gt;
I reproduced the issue with command line:&lt;br/&gt;
$ make run-test JTREG_TEST_THREAD_FACTORY=Virtual TEST=compiler/c2/aarch64/TestFarJump.java&lt;br/&gt;
&lt;br/&gt;
Problem is that with JTREG_TEST_THREAD_FACTORY=Virtual option in the forked process PrintAssembly reports a couple of java.lang.invoke.MethodHandle::linkToStatic methods before the expected TestFarJump::main disassembly. But the test actually expects to see TestFarJump::main disassembly output only because the forked process starts with &amp;quot;-XX:CompileOnly=&amp;quot; + className + &amp;quot;::main&amp;quot; option.&lt;br/&gt;
&lt;br/&gt;
The simple fix is to skip output before the TestFarJump::main disassembly. Though it is not clear why MethodHandle::linkToStatic methods are reported.&lt;br/&gt;
&lt;br/&gt;
diff --git a/test/hotspot/jtreg/compiler/c2/aarch64/TestFarJump.java b/test/hotspot/jtreg/compiler/c2/aarch64/TestFarJump.java&lt;br/&gt;
index d461d56d8a3..a9be790f8fd 100644&lt;br/&gt;
--- a/test/hotspot/jtreg/compiler/c2/aarch64/TestFarJump.java&lt;br/&gt;
+++ b/test/hotspot/jtreg/compiler/c2/aarch64/TestFarJump.java&lt;br/&gt;
@@ -100,6 +99,9 @@ static void runVM(boolean bigCodeHeap) throws Exception {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;List&amp;lt;String&amp;gt; lines = output.asLines();&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ListIterator&amp;lt;String&amp;gt; itr = lines.listIterator();&lt;br/&gt;
+        while (itr.hasNext() &amp;amp;&amp;amp; !itr.next().matches(&amp;quot;Compiled method.*TestFarJump::main.*&amp;quot;)) {&lt;br/&gt;
+            // skip output before TestFarJump::main disassembly&lt;br/&gt;
+        }&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;while (itr.hasNext()) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;String line = itr.next();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (line.contains(&amp;quot;[Exception Handler]&amp;quot;)) {&lt;br/&gt;
</comment>
                            <comment id="14637049" author="thartmann" created="Wed, 3 Jan 2024 00:42:41 -0800"  >[~bulasevich], could you please have a look?</comment>
                            <comment id="14637048" author="thartmann" created="Wed, 3 Jan 2024 00:42:06 -0800"  >Marking this as test bug for now. &lt;br/&gt;
&lt;br/&gt;
ILW = Test fails due to unexpected instructions in C2 compiled code (test bug?), single test on AArch64, no workaround = MLH = P4</comment>
                            <comment id="14637047" author="thartmann" created="Wed, 3 Jan 2024 00:40:20 -0800"  >Disassembly:&lt;br/&gt;
&lt;br/&gt;
0x0000000000000000:  F3 03 00 AA    mov x19, x0&lt;br/&gt;
0x0000000000000004:  E8 17 40 F9    ldr x8, [sp, #0x28]&lt;br/&gt;
0x0000000000000008:  88 A7 02 F9    str x8, [x28, #0x548]&lt;br/&gt;
0x000000000000000c:  E8 1B 40 F9    ldr x8, [sp, #0x30]&lt;br/&gt;
0x0000000000000010:  88 AF 02 F9    str x8, [x28, #0x558]&lt;br/&gt;
0x0000000000000014:  E9 07 40 F9    ldr x9, [sp, #8]&lt;br/&gt;
0x0000000000000018:  89 A3 02 F9    str x9, [x28, #0x540]&lt;br/&gt;
0x000000000000001c:  FD 03 01 91    add x29, sp, #0x40</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5124831">JDK-8328685</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5124835">JDK-8328689</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5125149">JDK-8328965</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5127566">JDK-8330826</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5072317">JDK-8284681</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="19300"><![CDATA[aarch64]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i34e5v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17315"><![CDATA[b05]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="208"><![CDATA[compiler]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>