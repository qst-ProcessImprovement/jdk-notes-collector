<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 19:15:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8307559] Add better checking in com/sun/jdi tests for debuggee exiting unexpectedly with an exception</title>
                <link>https://bugs.openjdk.org/browse/JDK-8307559</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>In TestScaffold.java we check the debuggee process exitValue, and allow a 0 or a 1. Otherwise the test fails. You get exitValue 1 when the debuggee exits with an exception. Allowing this was necessary because some tests purposely make the debuggee exit with an exception. However, this runs the risk of not detecting a debuggee exception when none was expected.&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8306758&quot; title=&quot;com/sun/jdi/ConnectedVMs.java fails with &amp;quot;Non-zero debuggee exitValue: 143&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8306758&quot;&gt;&lt;strike&gt;JDK-8306758&lt;/strike&gt;&lt;/a&gt; added support for allowing the test to determine which exitValues are acceptable. This means we can now change TestScaffold to by default only allow exitValue 0. Tests that expect an exception can override TestScaffold.allowedExitValue(int) to allow (or only expect) an exitValue of 1. There are 2 test that will need updating once TestScaffold by default no longer allows exitValue 1:&lt;br/&gt;
&lt;br/&gt;
- ResumeOneThread.java has a latent virtual thread bug that this CR is exposing. In order to fix &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8283796&quot; title=&quot;[LOOM] com/sun/jdi/ResumeOneThreadTest.java times out&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8283796&quot;&gt;&lt;strike&gt;JDK-8283796&lt;/strike&gt;&lt;/a&gt;, the debuggee is doing a Thread.setDaemon(false) on the threads it creates. This results in an exception when used on a virtual thread, causing the debuggee to exit with exitValue 1, which previously went undetected. The changes for this CR no longer allow exitValue 1, exposing this bug. The proper fix for &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8283796&quot; title=&quot;[LOOM] com/sun/jdi/ResumeOneThreadTest.java times out&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8283796&quot;&gt;&lt;strike&gt;JDK-8283796&lt;/strike&gt;&lt;/a&gt; should have been to instead Thread.join() on the created threads.&lt;br/&gt;
&lt;br/&gt;
- ExceptionEvents.java has some test modes that expect the debuggee to exit with an exception, so allowedExitValue() is overridden to expect exitValue 1 instead of 0 for these test modes.&lt;br/&gt;
&lt;br/&gt;
There is also one minor fix needed in TestScaffold when using virtual threads. The virtual thread factory related code includes a catch clause to catch all exceptions. It does this in the code that invokes the virtual thread main method. If any exception is caught, it is saved away. I think the intent was to rethrow it in the main thread just like it would have been thrown if not using the virtual thread factory. However, the code wasn&amp;#39;t rethrowing it, so if an exception was thrown by the debuggee virtual thread, the test still exited with exitValue 0. This causes unexpected debuggee exceptions to go unnoticed, and also causes tests that expect a debuggee exception to fail. I tried to fix this by rethrowing the exception, but this causes some tests that track ExceptionEvents to complain about an unexpected exception. So I instead decided to mimic the debuggee exiting with an exception by just printing its stack trace and doing and exit(1).</description>
                <environment></environment>
        <key id="5100241">JDK-8307559</key>
            <summary>Add better checking in com/sun/jdi tests for debuggee exiting unexpectedly with an exception</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cjplummer">Chris Plummer</assignee>
                                    <reporter username="cjplummer">Chris Plummer</reporter>
                        <labels>
                            <label>noreg-self</label>
                    </labels>
                <created>Fri, 5 May 2023 12:27:21 -0700</created>
                <updated>Wed, 17 May 2023 16:52:05 -0700</updated>
                            <resolved>Thu, 11 May 2023 16:19:07 -0700</resolved>
                                    <version>21</version>
                                    <fixVersion>21</fixVersion>
                                    <component>core-svc</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14581069" author="dukebot" created="Thu, 11 May 2023 16:19:06 -0700"  >Changeset: 54c06d2d&lt;br/&gt;
Author:    Chris Plummer &amp;lt;&lt;a href=&apos;mailto:cjplummer@openjdk.org&apos;&gt;cjplummer@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-05-11 23:16:22 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/54c06d2d915e57d822136b403ea7a7675325d6fb&quot;&gt;https://git.openjdk.org/jdk/commit/54c06d2d915e57d822136b403ea7a7675325d6fb&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14580706" author="roboduke" created="Wed, 10 May 2023 17:24:59 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/13919&quot;&gt;https://git.openjdk.org/jdk/pull/13919&lt;/a&gt;&lt;br/&gt;
Date: 2023-05-10 23:22:03 +0000</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5099276">JDK-8306758</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i31eln:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17433"><![CDATA[b23]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="370"><![CDATA[debugger]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>