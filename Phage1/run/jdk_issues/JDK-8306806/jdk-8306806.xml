<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 18:53:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8306806] JMX agent with JDP enabled won&apos;t start when PerfData is disabled</title>
                <link>https://bugs.openjdk.org/browse/JDK-8306806</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>ADDITIONAL SYSTEM INFORMATION :&lt;br/&gt;
openjdk 21-ea 2023-09-19&lt;br/&gt;
OpenJDK Runtime Environment (build 21-ea+18-1480)&lt;br/&gt;
OpenJDK 64-Bit Server VM (build 21-ea+18-1480, mixed mode, sharing)&lt;br/&gt;
&lt;br/&gt;
A DESCRIPTION OF THE PROBLEM :&lt;br/&gt;
Unable to start VM with JMX and JDP, specifying &amp;quot;com.sun.management.jmxremote.autodiscovery=true&amp;quot; and others JMX properties, when perfData is disabled with flag &amp;quot;-XX:-UsePerfData&amp;quot; at the command line.&lt;br/&gt;
&lt;br/&gt;
Apparently introduced in &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8167337&quot; title=&quot;When jmxremote.port=0, JDP broadcasts &amp;quot;0&amp;quot; instead of assigned port&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8167337&quot;&gt;&lt;strike&gt;JDK-8167337&lt;/strike&gt;&lt;/a&gt; making discover service dependent on perf buffer.&lt;br/&gt;
&lt;br/&gt;
STEPS TO FOLLOW TO REPRODUCE THE PROBLEM :&lt;br/&gt;
Run: java -XX:-UsePerfData -Dcom.sun.management.jmxremote.autodiscovery=true -Dcom.sun.management.jmxremote.port=0 -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false --version&lt;br/&gt;
&lt;br/&gt;
EXPECTED VERSUS ACTUAL BEHAVIOR :&lt;br/&gt;
EXPECTED -&lt;br/&gt;
The process starts without perfData.&lt;br/&gt;
ACTUAL -&lt;br/&gt;
java.nio.BufferUnderflowException&lt;br/&gt;
	at java.base/java.nio.Buffer.nextGetIndex(Buffer.java:712)&lt;br/&gt;
	at java.base/java.nio.DirectByteBuffer.getInt(DirectByteBuffer.java:693)&lt;br/&gt;
	at java.management/sun.management.counter.perf.Prologue.&amp;lt;init&amp;gt;(Prologue.java:80)&lt;br/&gt;
	at java.management/sun.management.counter.perf.PerfInstrumentation.&amp;lt;init&amp;gt;(PerfInstrumentation.java:42)&lt;br/&gt;
	at jdk.management.agent/jdk.internal.agent.ConnectorAddressLink.importRemoteFrom(ConnectorAddressLink.java:207)&lt;br/&gt;
	at jdk.management.agent/jdk.internal.agent.Agent.startDiscoveryService(Agent.java:502)&lt;br/&gt;
	at jdk.management.agent/jdk.internal.agent.Agent.startAgent(Agent.java:447)&lt;br/&gt;
	at jdk.management.agent/jdk.internal.agent.Agent.startAgent(Agent.java:597)&lt;br/&gt;
Exception thrown by the agent : java.nio.BufferUnderflowException&lt;br/&gt;
&lt;br/&gt;
FREQUENCY : always&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
        <key id="5098466">JDK-8306806</key>
            <summary>JMX agent with JDP enabled won&apos;t start when PerfData is disabled</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kevinw">Kevin Walls</assignee>
                                    <reporter username="webbuggrp">Webbug Group</reporter>
                        <labels>
                            <label>dcsswa</label>
                            <label>reproducer-yes</label>
                            <label>webbug</label>
                    </labels>
                <created>Sun, 16 Apr 2023 10:06:53 -0700</created>
                <updated>Mon, 22 May 2023 00:53:21 -0700</updated>
                            <resolved>Tue, 16 May 2023 01:30:19 -0700</resolved>
                                    <version>9</version>
                    <version>21</version>
                                    <fixVersion>21</fixVersion>
                                    <component>core-svc</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14581830" author="dukebot" created="Tue, 16 May 2023 01:30:18 -0700"  >Changeset: 0790f704&lt;br/&gt;
Author:    Kevin Walls &amp;lt;&lt;a href=&apos;mailto:kevinw@openjdk.org&apos;&gt;kevinw@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-05-16 08:28:53 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/0790f704fdc82d8152219b280a51c8c1aad7a358&quot;&gt;https://git.openjdk.org/jdk/commit/0790f704fdc82d8152219b280a51c8c1aad7a358&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14580905" author="roboduke" created="Thu, 11 May 2023 05:09:53 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/13928&quot;&gt;https://git.openjdk.org/jdk/pull/13928&lt;/a&gt;&lt;br/&gt;
Date: 2023-05-11 11:42:38 +0000</comment>
                            <comment id="14580903" author="kevinw" created="Thu, 11 May 2023 05:01:57 -0700"  >The use of PerfData is superior to the previous hard-coding of knowledge of the URL protocol and structure, and is required to communicate a dynamically assigned port (&lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8167337&quot; title=&quot;When jmxremote.port=0, JDP broadcasts &amp;quot;0&amp;quot; instead of assigned port&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8167337&quot;&gt;&lt;strike&gt;JDK-8167337&lt;/strike&gt;&lt;/a&gt;).  But there should be a clearer message, and not a fatal error.</comment>
                            <comment id="14576239" author="kevinw" created="Mon, 24 Apr 2023 11:36:33 -0700"  >Yes, this behaviour reproduces, and is a bug.&lt;br/&gt;
The Java Discovery service / JDP will not start with -XX:-UsePerfData&lt;br/&gt;
&lt;br/&gt;
Thanks for including the reference to:&lt;br/&gt;
8167337: When jmxremote.port=0, JDP broadcasts &amp;quot;0&amp;quot; instead of assigned port&lt;br/&gt;
&lt;br/&gt;
Looks like we fixed the use of literal zero rather than the port that was assigned, but also introduced the dependency on ConnectorAddressLink and therefore on PerfData (Jan 2020).&lt;br/&gt;
&lt;br/&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17008"><![CDATA[generic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17010"><![CDATA[generic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3142z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17433"><![CDATA[b23]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="375"><![CDATA[javax.management]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>