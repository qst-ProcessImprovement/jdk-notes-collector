<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 12:54:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8329103] assert(!thread-&gt;in_asgct()) failed during multi-mode profiling</title>
                <link>https://bugs.openjdk.org/browse/JDK-8329103</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>Debug JVM crashes on the following assertion if CPU and Wall clock profiling modes are enabled together. It may also crash if two profiler instances are running simultaneously.&lt;br/&gt;
&lt;br/&gt;
#  assert(!thread-&amp;gt;in_asgct()) failed: invariant&lt;br/&gt;
&lt;br/&gt;
Stack: [0x00007fcc35fe4000,0x00007fcc360e5000],  sp=0x00007fcc360e0230,  free space=1008k&lt;br/&gt;
Native frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native code)&lt;br/&gt;
V  [libjvm.so+0xc5cd51]  AsyncGetCallTrace+0x261&lt;br/&gt;
C  [libasyncProfiler.so+0x16775]  Profiler::getJavaTraceAsync(void*, ASGCT_CallFrame*, int, StackContext*)+0xb5&lt;br/&gt;
C  [libasyncProfiler.so+0x24927]  Profiler::recordSample(void*, unsigned long long, EventType, Event*)+0x837&lt;br/&gt;
C  [libasyncProfiler.so+0x256d8]  PerfEvents::signalHandler(int, siginfo_t*, void*)+0xd8&lt;br/&gt;
C  [libpthread.so.0+0x118e0]&lt;br/&gt;
V  [libjvm.so+0xc6b5c7]  frame::frame(long*, long*, long*, unsigned char*)+0x47&lt;br/&gt;
V  [libjvm.so+0xc693cc]  frame::safe_for_sender(JavaThread*)+0x46c&lt;br/&gt;
V  [libjvm.so+0xc5bb7c]  vframeStreamForte::forte_next()+0x5c&lt;br/&gt;
V  [libjvm.so+0xc5c369]  forte_fill_call_trace_given_top(JavaThread*, ASGCT_CallTrace*, int, frame)+0x3f9&lt;br/&gt;
V  [libjvm.so+0xc5cd9e]  AsyncGetCallTrace+0x2ae&lt;br/&gt;
C  [libasyncProfiler.so+0x16775]  Profiler::getJavaTraceAsync(void*, ASGCT_CallFrame*, int, StackContext*)+0xb5&lt;br/&gt;
C  [libasyncProfiler.so+0x24927]  Profiler::recordSample(void*, unsigned long long, EventType, Event*)+0x837&lt;br/&gt;
C  [libasyncProfiler.so+0x25772]  WallClock::signalHandler(int, siginfo_t*, void*)+0x42&lt;br/&gt;
&lt;br/&gt;
This is a regression that appeared after &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8304725&quot; title=&quot;AsyncGetCallTrace can cause SIGBUS on M1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8304725&quot;&gt;&lt;strike&gt;JDK-8304725&lt;/strike&gt;&lt;/a&gt; which added the above assertion thus making AsyncGetCallTrace no longer reentrant. However, there is nothing in AGCT implementation besides this assertion that prevents it from being reentrant.&lt;br/&gt;
There were no issues when running multi-mode profiling with product JVM builds.</description>
                <environment></environment>
        <key id="5125291">JDK-8329103</key>
            <summary>assert(!thread-&gt;in_asgct()) failed during multi-mode profiling</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="apangin">Andrei Pangin</assignee>
                                    <reporter username="apangin">Andrei Pangin</reporter>
                        <labels>
                            <label>AsyncGetCallTrace</label>
                            <label>amazon-interest</label>
                            <label>datadog-interest</label>
                            <label>jdk11u-fix-request</label>
                            <label>jdk11u-fix-yes</label>
                            <label>jdk17u-fix-request</label>
                            <label>jdk17u-fix-yes</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                    </labels>
                <created>Tue, 26 Mar 2024 08:21:56 -0700</created>
                <updated>Tue, 27 Aug 2024 18:46:29 -0700</updated>
                            <resolved>Mon, 1 Apr 2024 21:32:53 -0700</resolved>
                                    <version>11.0.23</version>
                    <version>17.0.9</version>
                    <version>21</version>
                    <version>22</version>
                                    <fixVersion>23</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="14686125" author="roboduke" created="Mon, 1 Jul 2024 09:52:51 -0700"  >[jdk11u-fix-request] Approval Request from Jaroslav Bachorik&lt;br/&gt;
Please, approve this backport of a fix for ASGCT reentrancy. The change is trivial and affects only ASGCT related execution.</comment>
                            <comment id="14684160" author="roboduke" created="Mon, 24 Jun 2024 08:06:07 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk11u-dev/pull/2812&quot;&gt;https://git.openjdk.org/jdk11u-dev/pull/2812&lt;/a&gt;&lt;br/&gt;
Date: 2024-06-24 14:58:33 +0000</comment>
                            <comment id="14684155" author="roboduke" created="Mon, 24 Jun 2024 07:27:08 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u-dev/pull/2632&quot;&gt;https://git.openjdk.org/jdk17u-dev/pull/2632&lt;/a&gt;&lt;br/&gt;
Date: 2024-06-24 14:22:03 +0000</comment>
                            <comment id="14684153" author="roboduke" created="Mon, 24 Jun 2024 07:23:42 -0700"  >[jdk17u-fix-request] Approval Request from Jaroslav Bachorik&lt;br/&gt;
Please, approve this backport of a fix for ASGCT reentrancy. The change is trivial and affects only ASGCT related execution.</comment>
                            <comment id="14684152" author="roboduke" created="Mon, 24 Jun 2024 07:19:17 -0700"  >[jdk21u-fix-request] Approval Request from Jaroslav Bachorik&lt;br/&gt;
Please, approve this backport of a fix for ASGCT reentrancy. The change is trivial and affects only ASGCT related execution.</comment>
                            <comment id="14684150" author="roboduke" created="Mon, 24 Jun 2024 07:12:50 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/790&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/790&lt;/a&gt;&lt;br/&gt;
Date: 2024-06-24 14:05:36 +0000</comment>
                            <comment id="14661915" author="dukebot" created="Mon, 1 Apr 2024 21:32:52 -0700"  >Changeset: 6b1b0e9d&lt;br/&gt;
Author:    Andrei Pangin &amp;lt;&lt;a href=&apos;mailto:apangin@openjdk.org&apos;&gt;apangin@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Committer: Serguei Spitsyn &amp;lt;&lt;a href=&apos;mailto:sspitsyn@openjdk.org&apos;&gt;sspitsyn@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2024-04-02 04:30:26 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/6b1b0e9d45eb56f88398e2a6bca0d90c03112eaa&quot;&gt;https://git.openjdk.org/jdk/commit/6b1b0e9d45eb56f88398e2a6bca0d90c03112eaa&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14661364" author="apangin" created="Thu, 28 Mar 2024 15:46:06 -0700"  >[~dholmes] You are right, there were issues in the past. They have been fixed since then, though.</comment>
                            <comment id="14661237" author="dholmes" created="Thu, 28 Mar 2024 06:05:54 -0700"  >[~apangin] wasn&amp;#39;t &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8282405&quot; title=&quot;Make thread resource areas signal safe&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8282405&quot;&gt;&lt;strike&gt;JDK-8282405&lt;/strike&gt;&lt;/a&gt; trying to address one reason why ACGT is not async-signal-safe?</comment>
                            <comment id="14660692" author="apangin" created="Tue, 26 Mar 2024 18:26:39 -0700"  >[~dholmes] AGCT looks async-signal-safe to me with the change in the proposed pull request. Or are you aware of a reason why it&amp;#39;s not?</comment>
                            <comment id="14660691" author="roboduke" created="Tue, 26 Mar 2024 18:06:45 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/18504&quot;&gt;https://git.openjdk.org/jdk/pull/18504&lt;/a&gt;&lt;br/&gt;
Date: 2024-03-27 01:02:41 +0000</comment>
                            <comment id="14660676" author="dholmes" created="Tue, 26 Mar 2024 15:20:42 -0700"  >&amp;gt;  there is nothing in AGCT implementation besides this assertion that prevents it from being reentrant.&lt;br/&gt;
&lt;br/&gt;
You means beside the fact it is already not async-signal-safe?</comment>
                            <comment id="14660587" author="mwthomps" created="Tue, 26 Mar 2024 10:31:07 -0700"  >ILW=HLL=P4</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5132783">JDK-8335093</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5132876">JDK-8335180</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5133381">JDK-8335622</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5137673">JDK-8339133</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5096891">JDK-8304725</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i35mtn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17417"><![CDATA[b17]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="369"><![CDATA[svc]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>