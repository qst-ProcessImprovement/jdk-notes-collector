<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 17:36:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8303951] Add asserts before record_method_not_compilable where possible</title>
                <link>https://bugs.openjdk.org/browse/JDK-8303951</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>There are currently a few places where we simply bail out of C2 compilation. Some of them are justified. Others just encounter a bug, but bail out gracefully. This means we never catch those bugs.&lt;br/&gt;
&lt;br/&gt;
We should add an assert before record_method_not_compilable so that we can catch the bugs in debug build, but still handle it gracefully in production builds.&lt;br/&gt;
&lt;br/&gt;
One example is &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8303466&quot; title=&quot;C2: failed: malformed control flow. Limit type made precise with MaxL/MinL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8303466&quot;&gt;&lt;strike&gt;JDK-8303466&lt;/strike&gt;&lt;/a&gt;. I had a IR test for a SuperWord regression test, but it would not compile. Finally, I found that it bailed out of compilation:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;4163 85 b 4 Test::test (32 bytes) COMPILE SKIPPED: malformed control flow (retry at different tier)&lt;br/&gt;
&lt;br/&gt;
But things like &amp;quot;malformed control flow&amp;quot; should be fixed. In this case, we have an IfNode that has only one output Projection.</description>
                <environment></environment>
        <key id="5095942">JDK-8303951</key>
            <summary>Add asserts before record_method_not_compilable where possible</summary>
                <type id="7" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14707&amp;avatarType=issuetype">Enhancement</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="epeter">Emanuel Peter</assignee>
                                    <reporter username="epeter">Emanuel Peter</reporter>
                        <labels>
                            <label>c2</label>
                    </labels>
                <created>Fri, 10 Mar 2023 00:44:52 -0800</created>
                <updated>Wed, 25 Jun 2025 05:30:17 -0700</updated>
                            <resolved>Thu, 23 Mar 2023 00:45:41 -0700</resolved>
                                    <version>21</version>
                                    <fixVersion>21</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14571948" author="JIRAUSER19821" created="Wed, 5 Apr 2023 03:55:43 -0700"  >The &amp;quot;malformed control flow&amp;quot; assert seems to trigger cases where skeleton/assertion predicates are missing.</comment>
                            <comment id="14568986" author="dukebot" created="Thu, 23 Mar 2023 00:45:40 -0700"  >Changeset: af4d5600&lt;br/&gt;
Author:    Emanuel Peter &amp;lt;&lt;a href=&apos;mailto:epeter@openjdk.org&apos;&gt;epeter@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-03-23 07:44:18 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/af4d5600e37ec6d331e62c5d37491ee97cad5311&quot;&gt;https://git.openjdk.org/jdk/commit/af4d5600e37ec6d331e62c5d37491ee97cad5311&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14568984" author="JIRAUSER19821" created="Thu, 23 Mar 2023 00:39:29 -0700"  >I did testing up to tier9. It looks like all asserts that I put in are now passing.&lt;br/&gt;
&lt;br/&gt;
We may have fuzzer failures for this &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8303466&quot; title=&quot;C2: failed: malformed control flow. Limit type made precise with MaxL/MinL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8303466&quot;&gt;&lt;strike&gt;JDK-8303466&lt;/strike&gt;&lt;/a&gt;, that would be expected, but rare.&lt;br/&gt;
&lt;br/&gt;
If any of the asserts fail, we will have to re-evaluate if the assert is too strong, or if we indeed encounter a bug. Feel free to contact me if you are not sure.&lt;br/&gt;
</comment>
                            <comment id="14567706" author="roboduke" created="Fri, 17 Mar 2023 02:11:45 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/13038&quot;&gt;https://git.openjdk.org/jdk/pull/13038&lt;/a&gt;&lt;br/&gt;
Date: 2023-03-15 10:29:32 +0000</comment>
                            <comment id="14566329" author="JIRAUSER19821" created="Mon, 13 Mar 2023 09:03:16 -0700"  >I wonder if we should also check all the BAILOUT calls in C1?</comment>
                            <comment id="14566326" author="JIRAUSER19821" created="Mon, 13 Mar 2023 08:53:38 -0700"  >TestA.jasm&lt;br/&gt;
&lt;br/&gt;
After OSR bailout, we do not ever recompile the method. We could probably try a normal compilation, that would at least get us performance on the lest method call.&lt;br/&gt;
&lt;br/&gt;
I think this kind of pattern does get generated, not just in jasm.&lt;br/&gt;
For example in Kitchensink:&lt;br/&gt;
die.verwandlung.article2html::topLevel&lt;br/&gt;
die.verwandlung.xmlspec::toc&lt;br/&gt;
&lt;br/&gt;
This is the PrintCompilation log:&lt;br/&gt;
...&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;870   27 %  b  3       TestA::test @ 4 (15 bytes)&lt;br/&gt;
compilation bailout: stack not empty at OSR entry point&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;871   27 %  b  3       TestA::test @ 4 (15 bytes)   COMPILE SKIPPED: stack not empty at OSR entry point (retry at different tier)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;871   28 %  b  4       TestA::test @ 4 (15 bytes)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;872   28 %  b  4       TestA::test @ 4 (15 bytes)   COMPILE SKIPPED: OSR starts with non-empty stack (retry at different tier)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;923   29    b  4       TestA::test (15 bytes)&lt;br/&gt;
&lt;br/&gt;
./java -jar ~/Documents/asmtools-7.0-build/release/lib/asmtools.jar jasm TestA.jasm&lt;br/&gt;
./java -Xbatch -XX:CompileCommand=compileonly,TestA::test -XX:CompileCommand=printcompilation,TestA::test -XX:+PrintCompilation  TestA</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10600">
                    <name>Causes</name>
                                            <outwardlinks description="causes">
                                        <issuelink>
            <issuekey id="5160541">JDK-8358573</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5154774">JDK-8353624</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5096409">JDK-8304328</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5162681">JDK-8360521</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5077648">JDK-8288981</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5096666">JDK-8304532</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5097408">JDK-8305185</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5101260">JDK-8308392</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5124084">JDK-8328078</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5095320">JDK-8303466</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5099539">JDK-8306933</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5099619">JDK-8306997</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5099768">JDK-8307131</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5102394">JDK-8309353</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5120517">JDK-8325095</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5106777">JDK-8313241</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5105500">JDK-8312096</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5120079">JDK-8324743</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5129887">JDK-8332632</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="102984" name="TestA.jasm" size="715" author="epeter" created="Mon, 13 Mar 2023 08:48:58 -0700"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i30osj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17312"><![CDATA[b16]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="208"><![CDATA[compiler]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>