<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 10:56:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8315986] [macos14] javax/swing/JMenuItem/4654927/bug4654927.java: component must be showing on the screen to determine its location</title>
                <link>https://bugs.openjdk.org/browse/JDK-8315986</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>The test javax/swing/JMenuItem/4654927/bug4654927.java fails on macOS14 Darwin Kernel Version 23.0.0 as follows:&lt;br/&gt;
&lt;br/&gt;
====================8&amp;lt;--------------------&lt;br/&gt;
#section:main&lt;br/&gt;
----------messages:(7/259)----------&lt;br/&gt;
command: main bug4654927&lt;br/&gt;
reason: User specified action: run main bug4654927 &lt;br/&gt;
started: Mon Sep 11 08:55:02 UTC 2023&lt;br/&gt;
Mode: othervm&lt;br/&gt;
Additional options from @modules: --add-modules java.desktop&lt;br/&gt;
finished: Mon Sep 11 08:55:04 UTC 2023&lt;br/&gt;
elapsed time (seconds): 1.951&lt;br/&gt;
----------configuration:(3/40)----------&lt;br/&gt;
Boot Layer&lt;br/&gt;
&amp;nbsp;&amp;nbsp;add modules: java.desktop&lt;br/&gt;
&lt;br/&gt;
----------System.out:(0/0)----------&lt;br/&gt;
----------System.err:(24/1826)----------&lt;br/&gt;
java.awt.IllegalComponentStateException: component must be showing on the screen to determine its location&lt;br/&gt;
	at java.desktop/java.awt.Component.getLocationOnScreen_NoTreeLock(Component.java:2113)&lt;br/&gt;
	at java.desktop/java.awt.Component.getLocationOnScreen(Component.java:2087)&lt;br/&gt;
	at bug4654927$3.call(bug4654927.java:99)&lt;br/&gt;
	at bug4654927$3.call(bug4654927.java:95)&lt;br/&gt;
	at Util$2.run(Util.java:222)&lt;br/&gt;
	at java.desktop/java.awt.event.InvocationEvent.dispatch(InvocationEvent.java:308)&lt;br/&gt;
	at java.desktop/java.awt.EventQueue.dispatchEventImpl(EventQueue.java:773)&lt;br/&gt;
	at java.desktop/java.awt.EventQueue$4.run(EventQueue.java:720)&lt;br/&gt;
	at java.desktop/java.awt.EventQueue$4.run(EventQueue.java:714)&lt;br/&gt;
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:400)&lt;br/&gt;
	at java.base/java.security.ProtectionDomain$JavaSecurityAccessImpl.doIntersectionPrivilege(ProtectionDomain.java:87)&lt;br/&gt;
	at java.desktop/java.awt.EventQueue.dispatchEvent(EventQueue.java:742)&lt;br/&gt;
	at java.desktop/java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:203)&lt;br/&gt;
	at java.desktop/java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:124)&lt;br/&gt;
	at java.desktop/java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:113)&lt;br/&gt;
	at java.desktop/java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:109)&lt;br/&gt;
	at java.desktop/java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:101)&lt;br/&gt;
	at java.desktop/java.awt.EventDispatchThread.run(EventDispatchThread.java:90)&lt;br/&gt;
&lt;br/&gt;
JavaTest Message: Test threw exception: java.awt.IllegalComponentStateException: component must be showing on the screen to determine its location&lt;br/&gt;
JavaTest Message: shutting down test&lt;br/&gt;
&lt;br/&gt;
STATUS:Failed.`main&amp;#39; threw exception: java.awt.IllegalComponentStateException: component must be showing on the screen to determine its location&lt;br/&gt;
====================8&amp;lt;--------------------&lt;br/&gt;
&lt;br/&gt;
Reproducibility: 100%&lt;br/&gt;
&lt;br/&gt;
Steps to reproduce:&lt;br/&gt;
$ jtreg -v -testjdk:$JAVA_HOME test/jdk/javax/swing/JMenuItem/4654927/bug4654927.java &lt;br/&gt;
&lt;br/&gt;
The issue was observed on 17, 21, 22</description>
                <environment></environment>
        <key id="5109987">JDK-8315986</key>
            <summary>[macos14] javax/swing/JMenuItem/4654927/bug4654927.java: component must be showing on the screen to determine its location</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="psadhukhan">Prasanta Sadhukhan</assignee>
                                    <reporter username="vprovodin">Vitaly Provodin</reporter>
                        <labels>
                            <label>jdk11u-fix-request</label>
                            <label>jdk11u-fix-yes</label>
                            <label>jdk17u-fix-request</label>
                            <label>jdk17u-fix-yes</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>macos</label>
                            <label>macos14</label>
                            <label>noreg-self</label>
                            <label>sn_153</label>
                            <label>sn_154</label>
                            <label>sn_155</label>
                            <label>sn_156</label>
                            <label>sn_157</label>
                    </labels>
                <created>Mon, 11 Sep 2023 02:05:38 -0700</created>
                <updated>Tue, 30 Jan 2024 05:08:01 -0800</updated>
                            <resolved>Tue, 14 Nov 2023 23:03:49 -0800</resolved>
                                    <version>17</version>
                    <version>21</version>
                    <version>22</version>
                                    <fixVersion>22</fixVersion>
                                    <component>client-libs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>11</watches>
                                                                                                                <comments>
                            <comment id="14644175" author="roboduke" created="Fri, 26 Jan 2024 21:56:23 -0800"  >[jdk11u-fix-request] Approval Request from Amos&lt;br/&gt;
&#8220;Backporting for parity with jdk 11.0.23-oracle. No risk, test fix. Clean backport. SAP nightlies passed on 2024-01-25,26&#8221;</comment>
                            <comment id="14644155" author="roboduke" created="Fri, 26 Jan 2024 15:44:10 -0800"  >[jdk17u-fix-request] Approval Request from Amos&lt;br/&gt;
&#8220;Backporting for parity with jdk 17.0.11-oracle. No risk, test fix. Clean backport. SAP nightlies passed on 2024-01-25,26&#8221;</comment>
                            <comment id="14642827" author="roboduke" created="Tue, 23 Jan 2024 01:54:38 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk11u-dev/pull/2481&quot;&gt;https://git.openjdk.org/jdk11u-dev/pull/2481&lt;/a&gt;&lt;br/&gt;
Date: 2024-01-23 09:49:04 +0000</comment>
                            <comment id="14642826" author="roboduke" created="Tue, 23 Jan 2024 01:54:37 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u-dev/pull/2166&quot;&gt;https://git.openjdk.org/jdk17u-dev/pull/2166&lt;/a&gt;&lt;br/&gt;
Date: 2024-01-23 09:48:53 +0000</comment>
                            <comment id="14637144" author="roboduke" created="Wed, 3 Jan 2024 06:09:11 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/118&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/118&lt;/a&gt;&lt;br/&gt;
Date: 2024-01-03 14:02:11 +0000</comment>
                            <comment id="14637142" author="jdowland" created="Wed, 3 Jan 2024 06:00:25 -0800"  >Fix request [21u]&lt;br/&gt;
&lt;br/&gt;
I&amp;#39;m backporting this for parity with 21.0.3-oracle. Test only change. Clean cherry pick, test passes afterwards.</comment>
                            <comment id="14626867" author="aivanov" created="Thu, 16 Nov 2023 04:58:39 -0800"  >I agree with Prasanta, the test code looks cleaner; I was confused with some of the comments and the flow in the test.&lt;br/&gt;
&lt;br/&gt;
If it helps to understand what the test does, it&amp;#39;s not pointless even though it has nothing to do with the failure we saw. Perhaps, the bug subject should&amp;#39;ve been updated to reflect this fact.</comment>
                            <comment id="14626728" author="psadhukhan" created="Wed, 15 Nov 2023 22:05:42 -0800"  >Oops, sorry..I somehow missed that message..&lt;br/&gt;
I actually pointed the same here &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8315986?focusedId=14626080&amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14626080&quot;&gt;https://bugs.openjdk.org/browse/JDK-8315986?focusedId=14626080&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14626080&lt;/a&gt;&lt;br/&gt;
that the unmodified test would pass too but I am modifying for the test to be more optimised and durable</comment>
                            <comment id="14626661" author="prr" created="Wed, 15 Nov 2023 12:47:29 -0800"  >I don&amp;#39;t understand why this change was pushed. I suggested closing it out, not pushing the test update.&lt;br/&gt;
They may be harmless, but seemed pointless.&lt;br/&gt;
The changes in the test didn&amp;#39;t help at all in my testing on macOS 14.0 and the problem went away with macOS 14.1&lt;br/&gt;
</comment>
                            <comment id="14626423" author="dukebot" created="Tue, 14 Nov 2023 23:03:48 -0800"  >Changeset: e7486e8c&lt;br/&gt;
Author:    Prasanta Sadhukhan &amp;lt;&lt;a href=&apos;mailto:psadhukhan@openjdk.org&apos;&gt;psadhukhan@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-11-15 07:01:32 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/e7486e8cfc9a3f5cbe3515c68e325a25863c162e&quot;&gt;https://git.openjdk.org/jdk/commit/e7486e8cfc9a3f5cbe3515c68e325a25863c162e&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14626313" author="prr" created="Tue, 14 Nov 2023 14:09:50 -0800"  >&amp;gt; The following tests also failed on macOS14. The cause of the failures look similar to initially reported&lt;br/&gt;
&amp;gt; Let me know if separate tickets are required for these issues.&lt;br/&gt;
&lt;br/&gt;
&amp;gt;java/awt/GridLayout/ChangeGridSize/ChangeGridSize.java&lt;br/&gt;
&amp;gt;java/awt/GridLayout/ComponentPreferredSize/ComponentPreferredSize.java&lt;br/&gt;
&amp;gt; javax/swing/plaf/synth/7158712/bug7158712.java&lt;br/&gt;
&lt;br/&gt;
these 3 (and others!) are mentioned in JDK-8316016, we may file separate tickets as they still occur on macOS14&lt;br/&gt;
&lt;br/&gt;
&amp;gt; java/awt/MenuBar/TestNoScreenMenuBar.java&lt;br/&gt;
Not seeing this on macOS14.1, no bug report needed at this time.&lt;br/&gt;
&lt;br/&gt;
&amp;gt; javax/swing/JMenuItem/ActionListenerCalledTwice/ActionListenerCalledTwiceTest.java&lt;br/&gt;
There&amp;#39;s an issue for this &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8316151&quot; title=&quot;[macos14] ActionListenerCalledTwiceTest.java fails on macOS 14&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8316151&quot;&gt;&lt;strike&gt;JDK-8316151&lt;/strike&gt;&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
So let&amp;#39;s close this one out as being just about the test in the bug title/summary&lt;br/&gt;
</comment>
                            <comment id="14626296" author="prr" created="Tue, 14 Nov 2023 13:35:00 -0800"  >I think you should close this out as it seems to be resolved by macOS14.1</comment>
                            <comment id="14626080" author="psadhukhan" created="Tue, 14 Nov 2023 03:09:14 -0800"  >Its with the optimized patch which I think is yours, although I think the unmodified test also would pass in upgraded 14.1GA mc...&lt;br/&gt;
But anyways, I have updated the PR just to make the test more optimized and durable incase..</comment>
                            <comment id="14617336" author="psadhukhan" created="Tue, 10 Oct 2023 22:52:09 -0700"  >As if the current situation is less confusing, this adds to it....I guess you tested on mac14-arm, I dont see it fail in mac14-x64 mach5 node with PR test though, in atleast 3 jobs of 50 iterations..&lt;br/&gt;
&lt;br/&gt;
ANyway, there&amp;#39;s another issue that came up &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8317771&quot; title=&quot;[macos14] Expand/collapse a JTree using keyboard freezes the application in macOS 14 Sonoma&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8317771&quot;&gt;&lt;strike&gt;JDK-8317771&lt;/strike&gt;&lt;/a&gt; which seems to suggest mouse/key event processing is somewhat flaky in sonoma</comment>
                            <comment id="14617269" author="JIRAUSER19814" created="Tue, 10 Oct 2023 12:24:28 -0700"  >[~psadhukhan] [~aivanov]&lt;br/&gt;
&lt;br/&gt;
This is unusual. I ran the test on the same machine today and both versions (PR version &amp;amp; Aleksei&amp;#39;s) fails. This time the mouse pointer is located at the title bar (near minimize button) and the tests fails with java.awt.IllegalComponentStateException. I have attached the screen recording for reference.</comment>
                            <comment id="14617033" author="psadhukhan" created="Mon, 9 Oct 2023 20:30:15 -0700"  >I dont have physical access to the system to record a video....Maybe [~honkar] can record a video with Alexey&amp;#39;s patch in the same machine to compare with the video uploaded lastweek with my patch, if and when she has time...</comment>
                            <comment id="14616755" author="aivanov" created="Mon, 9 Oct 2023 09:24:05 -0700"  >[~psadhukhan] Indeed, it&amp;#39;s weird. The original test as well as your modified version does exactly the same things&#8230; with two additional requests to getLocationOnScreen on EDT.&lt;br/&gt;
&lt;br/&gt;
The difference in coordinates &#8212; center vs +10 offset &#8212; shouldn&amp;#39;t matter.&lt;br/&gt;
&lt;br/&gt;
Do we have a way to record another video to compare what&amp;#39;s seen on the screen?</comment>
                            <comment id="14616574" author="psadhukhan" created="Fri, 6 Oct 2023 20:38:01 -0700"  >There is some menu sticking issue in Sonoma where menu seems to not respond....not sure if this is related...&lt;br/&gt;
&lt;a href=&quot;https://discourse.devontechnologies.com/t/mac-os-sonoma-14-0-menu-sticking/76970/12&quot;&gt;https://discourse.devontechnologies.com/t/mac-os-sonoma-14-0-menu-sticking/76970/12&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Also, it seems Menu have been reimplemented in macos14 so might be the old NSMenu calls we call in awt might be deprecated and is not responding as it should&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;https://developer.apple.com/documentation/macos-release-notes/appkit-release-notes-for-macos-14#Menus&quot;&gt;https://developer.apple.com/documentation/macos-release-notes/appkit-release-notes-for-macos-14#Menus&lt;/a&gt;</comment>
                            <comment id="14616542" author="prr" created="Fri, 6 Oct 2023 13:00:55 -0700"  >The observation I made that the disappearance and reappearance only happens once, may be related&lt;br/&gt;
to observations made in &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8316016&quot;&gt;https://bugs.openjdk.org/browse/JDK-8316016&lt;/a&gt;.&lt;br/&gt;
i.e it could be related to some thing like window focus/activation not happening as expected&lt;br/&gt;
that gets cured only after the first click.&lt;br/&gt;
&lt;br/&gt;
I think coord differences are not relevant + getLocationOnScreen() is a red herring.&lt;br/&gt;
When it fails is because the component/window wasn&amp;#39;t activated / visible like it was supposed to be.</comment>
                            <comment id="14616519" author="JIRAUSER19814" created="Fri, 6 Oct 2023 10:43:21 -0700"  >[~aivanov] Thank you! Makes sense.&lt;br/&gt;
Yes, for this particular test the disappearing of drop-down seems to be the issue.&lt;br/&gt;
Since I was looking into getLocationOnScreen() issue wanted to check the display setting in 2 cases.</comment>
                            <comment id="14616516" author="aivanov" created="Fri, 6 Oct 2023 10:30:28 -0700"  >[~honkar] The resolution is likely different on different hosts. The macOS 14 host is located somewhere in a lab; the macOS 13 host is my MacBook Pro with its built-in Retina display. The latter is 2560&amp;#xD7;1600 which gives 1280&amp;#xD7;800 effective resolution.&lt;br/&gt;
&lt;br/&gt;
The coordinates aren&amp;#39;t an issue in my opinion.&lt;br/&gt;
&lt;br/&gt;
The issue is that clicking the menu while it&amp;#39;s open quickly closes it and opens it again whereas the expectation is to close the menu popup.&lt;br/&gt;
&lt;br/&gt;
Someone with a physical access to macOS 14 system could confirm it or  disconfirm it.</comment>
                            <comment id="14616512" author="JIRAUSER19814" created="Fri, 6 Oct 2023 10:18:31 -0700"  >[~aivanov]&lt;br/&gt;
&lt;br/&gt;
Is the display resolution same on macOS13 and 14, asked since the location coordinates differ by a large margin? Is it 1920x1080 on both?  </comment>
                            <comment id="14616507" author="aivanov" created="Fri, 6 Oct 2023 10:09:52 -0700"  >I modified the code and added popupMenuListener along with some debug statements: &lt;a href=&quot;https://github.com/aivanov-jdk/jdk/commit/e855d5f6ab226a7b5180b724af109618ca82d3c8&quot;&gt;https://github.com/aivanov-jdk/jdk/commit/e855d5f6ab226a7b5180b724af109618ca82d3c8&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;On macOS 14, I get the following output:&lt;br/&gt;
&lt;br/&gt;
----------System.out:(7/175)----------&lt;br/&gt;
Menu is becoming visible&lt;br/&gt;
Clicked menu: 888, 474&lt;br/&gt;
Clicked menu item: 918, 518&lt;br/&gt;
Clicked menu to close it: 888, 474&lt;br/&gt;
Menu is becoming invisible&lt;br/&gt;
Menu is becoming visible&lt;br/&gt;
Closed menu&lt;br/&gt;
----------System.err:(11/615)----------&lt;br/&gt;
java.lang.RuntimeException: Popup is still showing&lt;br/&gt;
	at bug4654927.main(bug4654927.java:105)&lt;br/&gt;
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)&lt;br/&gt;
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)&lt;br/&gt;
	at com.sun.javatest.regtest.agent.MainWrapper$MainTask.run(MainWrapper.java:138)&lt;br/&gt;
	at java.base/java.lang.Thread.run(Thread.java:1570)&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
On macOS 13, I get the expected output:&lt;br/&gt;
&lt;br/&gt;
Menu is becoming visible&lt;br/&gt;
Clicked menu: 648, 368&lt;br/&gt;
Clicked menu item: 678, 412&lt;br/&gt;
Clicked menu to close it: 648, 368&lt;br/&gt;
Menu is becoming invisible&lt;br/&gt;
Closed menu&lt;br/&gt;
Menu is becoming visible&lt;br/&gt;
Clicked menu to open it again: 648, 368&lt;br/&gt;
Glide is over&lt;br/&gt;
Menu canceled (becomes hidden)&lt;br/&gt;
Menu is becoming invisible&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
I think that on macOS 14 clicking the menu to close it results in closing the menu and opening it again right away.&lt;br/&gt;
&lt;br/&gt;
If I remove the assertion that the popup menu is not visible after we expect it to become hidden, I get the following output on macOS 14:&lt;br/&gt;
&lt;br/&gt;
----------System.out:(10/256)----------&lt;br/&gt;
Menu is becoming visible&lt;br/&gt;
Clicked menu: 888, 474&lt;br/&gt;
Clicked menu item: 918, 518&lt;br/&gt;
Clicked menu to close it: 888, 474&lt;br/&gt;
Menu is becoming invisible&lt;br/&gt;
Menu is becoming visible&lt;br/&gt;
Closed menu&lt;br/&gt;
Menu is becoming invisible&lt;br/&gt;
Clicked menu to open it again: 888, 474&lt;br/&gt;
Glide is over&lt;br/&gt;
----------System.err:(11/633)----------&lt;br/&gt;
java.lang.RuntimeException: Popup is unexpectedly closed&lt;br/&gt;
	at bug4654927.main(bug4654927.java:122)&lt;br/&gt;
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)&lt;br/&gt;
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)&lt;br/&gt;
	at com.sun.javatest.regtest.agent.MainWrapper$MainTask.run(MainWrapper.java:138)&lt;br/&gt;
	at java.base/java.lang.Thread.run(Thread.java:1570)&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
The problem is still somewhere, the menu becomes hidden when we don&amp;#39;t expect it to, it also remains visible when it shouldn&amp;#39;t be.&lt;br/&gt;
&lt;br/&gt;
I think that modifying the test by adding delays and make it work will just hide the problem that we&amp;#39;re seeing. We&amp;#39;re not fixing an incorrect behaviour.</comment>
                            <comment id="14616452" author="aivanov" created="Fri, 6 Oct 2023 05:19:18 -0700"  >I see the menu flickers more than it should in the attached video.&lt;br/&gt;
&lt;br/&gt;
[~prr] Interesting... If you comment out closing the menu before the drag, then dragging should hide the menu. Yet it looks there still something going on and it&amp;#39;s not clear yet.</comment>
                            <comment id="14616346" author="prr" created="Thu, 5 Oct 2023 14:32:01 -0700"  >&amp;gt; [~prr] It is expected and intentional. &lt;br/&gt;
&lt;br/&gt;
I saw this even when I commented out that code that closes the menu.</comment>
                            <comment id="14616311" author="prr" created="Thu, 5 Oct 2023 12:28:49 -0700"  >The failure of ActionListenerCalledTwiceTest.java  is tracked by bug &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8316151&quot;&gt;https://bugs.openjdk.org/browse/JDK-8316151&lt;/a&gt;</comment>
                            <comment id="14616217" author="aivanov" created="Thu, 5 Oct 2023 08:00:27 -0700"  >&amp;gt; So far as I can see from the test this brief dismissal is wholly&lt;br/&gt;
&amp;gt; unexpected and has nothing to do with timing.&lt;br/&gt;
&lt;br/&gt;
[~prr] It is expected and intentional.&lt;br/&gt;
&lt;a href=&quot;https://github.com/openjdk/jdk/blob/a1c9587c27538bda3b0f6745d9c80ff4e1b9a77e/test/jdk/javax/swing/JMenuItem/4654927/bug4654927.java#L108-L110&quot;&gt;https://github.com/openjdk/jdk/blob/a1c9587c27538bda3b0f6745d9c80ff4e1b9a77e/test/jdk/javax/swing/JMenuItem/4654927/bug4654927.java#L108-L110&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Yet I agree, it&amp;#39;s not easy to see. For this reason, I suggest to modify the test to make the sequence clearer.&lt;br/&gt;
&lt;a href=&quot;https://github.com/openjdk/jdk/pull/15677#discussion_r1347554324&quot;&gt;https://github.com/openjdk/jdk/pull/15677#discussion_r1347554324&lt;/a&gt;</comment>
                            <comment id="14615644" author="prr" created="Tue, 3 Oct 2023 14:29:23 -0700"  >It looks to me like robot moving the mouse off the menu item back to the &amp;quot;Menu&amp;quot; instance (ie on the menu bar)&lt;br/&gt;
triggers a brief dismissal of the menu (ie the list of menu items). So far as I can see from the test this brief&lt;br/&gt;
dismissal is wholly unexpected and has nothing to do with timing.</comment>
                            <comment id="14614590" author="vprovodin" created="Thu, 28 Sep 2023 00:59:04 -0700"  >Both bug4654927_Updated.java and bug4654927_Updated_autoIdle.java work well</comment>
                            <comment id="14614215" author="psadhukhan" created="Tue, 26 Sep 2023 21:08:35 -0700"  >Can you first test harshita&amp;#39;s *_Updated.java? It should pass as per her testing but it contains too many delays..&lt;br/&gt;
&lt;br/&gt;
I have uploaded *autoIdle.java file that contains above case..Please test this file after harshita&amp;#39;s and let us know if this also passes..Thanks..</comment>
                            <comment id="14614202" author="vprovodin" created="Tue, 26 Sep 2023 15:56:55 -0700"  >[~ sadhukhan] Ok.&lt;br/&gt;
Would you like me to check the case keeping robot.setAutoWaitForIdle(true); along with the fix? If so could you please prepare corresponding patch?</comment>
                            <comment id="14614019" author="psadhukhan" created="Tue, 26 Sep 2023 02:00:11 -0700"  >We have used robot delays in majority of the test without issue and this test also has not faced any trouble till now in our CI.&lt;br/&gt;
It will be nice if you can comment if it solves the issue you are seeing with this change &amp;quot;How about if we keep only robot.setAutoWaitForIdle(true); along with my fix...&amp;quot;</comment>
                            <comment id="14614015" author="vprovodin" created="Tue, 26 Sep 2023 01:48:41 -0700"  >[~sadhukhan] Not sure that using delays is reliable approach. I suppose it would be better to rewrite the test so it would check  appearing menu items via checking screenshots.&lt;br/&gt;
Something like the following - the first step may be to create UI with menu and menuitems having some predefined colors. Then after each clicks the test waits some specified time till some point (let it be center point) has get expected color that would be equal to backgruond color of menu/menuitem.&lt;br/&gt;
If the point has expected color then menu/menuitem was drawn and the test could check the value of isMenuItemShowing otherwise it returns error - something wrong happened, menu/menuitem was not drawn during that specified time.</comment>
                            <comment id="14613581" author="psadhukhan" created="Mon, 25 Sep 2023 02:44:09 -0700"  >[~honkar][~vprovodin]&lt;br/&gt;
How about if we keep only robot.setAutoWaitForIdle(true); along with my fix...&lt;br/&gt;
Not sure if so many delays are required?</comment>
                            <comment id="14613316" author="JIRAUSER19814" created="Fri, 22 Sep 2023 15:42:41 -0700"  >Log from Updated test on macOS 14.&lt;br/&gt;
Menu and MenuItem shown at following locations on screen for display config of 1920x1080.&lt;br/&gt;
&lt;br/&gt;
Menu Location: java.awt.Point[x=860,y=438]&lt;br/&gt;
MenuItem Location: java.awt.Point[x=860,y=483]</comment>
                            <comment id="14613315" author="JIRAUSER19814" created="Fri, 22 Sep 2023 15:36:59 -0700"  >[~psadhukhan] [~jdv]  Tested PR version of bug4654927.java on macOS 14 it failed but after adding delay at few more places it passes now. I have attached the updated test to the JBS. &lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;[~vprovodin] Can you please test the updated version of the test (in attachment section) again?</comment>
                            <comment id="14611030" author="vprovodin" created="Wed, 13 Sep 2023 15:49:53 -0700"  >[~ psadhukhan] after applying the changes the test continues to fail&lt;br/&gt;
the test was executed against 22-ea+14-1033&lt;br/&gt;
&lt;br/&gt;
Please find details in the attachment: bug4654927.jtr and short video Screen%20Recording%202023-09-14%20at%2005.41.53.mov</comment>
                            <comment id="14610787" author="psadhukhan" created="Wed, 13 Sep 2023 01:40:57 -0700"  >[~vprovodin] will you be able to test the patch from the PR and let know if it solves the present issue as we dont have macos14 machine with us presently?</comment>
                            <comment id="14610725" author="vprovodin" created="Tue, 12 Sep 2023 20:49:12 -0700"  >The following tests also failed on macOS14.  The cause of the failures look similar to initially reported&lt;br/&gt;
&lt;br/&gt;
java/awt/GridLayout/ChangeGridSize/ChangeGridSize.java&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Execution failed: `main&amp;#39; threw exception: java.lang.RuntimeException: Clicking on the left top of button did not trigger action event&lt;br/&gt;
&lt;br/&gt;
java/awt/GridLayout/ComponentPreferredSize/ComponentPreferredSize.java&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Execution failed: `main&amp;#39; threw exception: java.lang.RuntimeException: Clicking on the left top of button did not trigger action event&lt;br/&gt;
&lt;br/&gt;
java/awt/MenuBar/TestNoScreenMenuBar.java&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Execution failed: `main&amp;#39; threw exception: java.lang.RuntimeException: Test failed: menu item action was not performed&lt;br/&gt;
&lt;br/&gt;
javax/swing/JMenuItem/ActionListenerCalledTwice/ActionListenerCalledTwiceTest.java&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Execution failed: `main&amp;#39; threw exception: java.lang.Exception: DefaultMenuBar Test failed: ActionListener for Item2 called 0 times instead of 1!&lt;br/&gt;
&lt;br/&gt;
javax/swing/plaf/synth/7158712/bug7158712.java&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Execution failed: `main&amp;#39; threw exception: java.lang.reflect.InvocationTargetException&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Let me know if separate tickets are required for these issues.</comment>
                            <comment id="14610250" author="roboduke" created="Mon, 11 Sep 2023 21:54:23 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/15677&quot;&gt;https://git.openjdk.org/jdk/pull/15677&lt;/a&gt;&lt;br/&gt;
Date: 2023-09-12 04:45:51 +0000</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5115445">JDK-8320730</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5117563">JDK-8322519</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5117564">JDK-8322520</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5118090">JDK-8322999</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5120303">JDK-8324921</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5120348">JDK-8324963</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5110165">JDK-8316151</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="106408" name="Screen Recording 2023-09-14 at 05.41.53.mov" size="19012097" author="vprovodin" created="Wed, 13 Sep 2023 15:47:56 -0700"/>
                            <attachment id="106409" name="bug4654927.jtr" size="7359" author="vprovodin" created="Wed, 13 Sep 2023 15:48:16 -0700"/>
                            <attachment id="106525" name="bug4654927_Updated.java" size="5744" author="honkar" created="Fri, 22 Sep 2023 15:36:14 -0700"/>
                            <attachment id="106597" name="bug4654927_Updated_autoIdle.java" size="5621" author="psadhukhan" created="Tue, 26 Sep 2023 21:06:01 -0700"/>
                            <attachment id="106727" name="macOS14-ARM.mov" size="14798329" author="honkar" created="Thu, 5 Oct 2023 21:52:31 -0700"/>
                            <attachment id="106754" name="macOS14_Updated.mov" size="14798329" author="honkar" created="Tue, 10 Oct 2023 12:27:27 -0700"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17008"><![CDATA[generic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17017"><![CDATA[os_x]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i332g3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17436"><![CDATA[b24]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="206"><![CDATA[javax.swing]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>