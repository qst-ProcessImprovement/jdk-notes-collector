<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Tue Sep 30 09:06:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8308969] make test-prebuilt doesn&apos;t return the correct exit code</title>
                <link>https://bugs.openjdk.org/browse/JDK-8308969</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>make test-prebuilt always returns exit code 0, even if tests have failed. The exit-with-error file is written if failures occur. However, its existence is not checked before exit.</description>
                <environment></environment>
        <key id="5101941">JDK-8308969</key>
            <summary>make test-prebuilt doesn&apos;t return the correct exit code</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tonyp">Tony Printezis</assignee>
                                    <reporter username="tonyp">Tony Printezis</reporter>
                        <labels>
                    </labels>
                <created>Fri, 26 May 2023 08:59:39 -0700</created>
                <updated>Mon, 12 Jun 2023 20:46:53 -0700</updated>
                            <resolved>Mon, 5 Jun 2023 08:36:59 -0700</resolved>
                                                    <fixVersion>21</fixVersion>
                                    <component>infrastructure</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14587092" author="dukebot" created="Mon, 5 Jun 2023 08:36:58 -0700"  >Changeset: 80232b7e&lt;br/&gt;
Author:    Antonios Printezis &amp;lt;&lt;a href=&apos;mailto:tonyp@openjdk.org&apos;&gt;tonyp@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-06-05 15:35:42 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/80232b7e753129ca7a4f1ca9b70844e0c7d8eabf&quot;&gt;https://git.openjdk.org/jdk/commit/80232b7e753129ca7a4f1ca9b70844e0c7d8eabf&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14586723" author="tonyp" created="Fri, 2 Jun 2023 11:36:49 -0700"  >I updated the PR. I added a test-prebuilt-with-exit-code target (and we can rename that to whatever you want!). Let me know what you think.&lt;br/&gt;
&lt;br/&gt;
&amp;gt; The test-prebuilt target was meant to solve the case where test runs are separated from build runs &lt;br/&gt;
&lt;br/&gt;
This is our use-case as well.</comment>
                            <comment id="14586669" author="erikj" created="Fri, 2 Jun 2023 08:27:35 -0700"  >We have a results parser that imports all jtreg test results (jtr files etc) into a backing DB store so that we can browse them in a structured way (across time, builds, platforms, test cases etc). At task execution time, the parser tells the executor if any tests failed.&lt;br/&gt;
&lt;br/&gt;
A second target or a make/env variable would be reasonable. The test-prebuilt target was meant to solve the case where test runs are separated from build runs (which is pretty much a must when you scale up testing), so that is the intended target for your usecase.</comment>
                            <comment id="14586657" author="tonyp" created="Fri, 2 Jun 2023 08:01:14 -0700"  >Hi again, thanks for the extra background on this. I had trouble getting &amp;quot;make test&amp;quot; or &amp;quot;make test-only&amp;quot; to work in our ci system (on jobs separate from the build job) and I had more luck with &amp;quot;make test-prebuilt&amp;quot;. Hence my interest in this. And the obvious reason that I&amp;#39;d like it to return non-0, if any of the tests fail, is for the failure to be detected by the ci system and tag the job as failed.&lt;br/&gt;
&lt;br/&gt;
Would a reasonable compromise be to add a new target (test-prebuilt-flag-failures, or something like that) that will do what I suggest? I think it could be generally useful?&lt;br/&gt;
&lt;br/&gt;
Out of curiosity: How do you detect test failures with &amp;quot;make test-prebuilt&amp;quot;? Do you check the output? Or look for the presence of exit-with-error?</comment>
                            <comment id="14586358" author="erikj" created="Thu, 1 Jun 2023 08:18:00 -0700"  >I confess I didn&amp;#39;t pick up on the inconsistency between different make targets when I first looked at this bug. It would have helped if that was made clear in the description. I realize that this inconsistency could be confusing. The &amp;quot;run-test-prebuilt&amp;quot; target was implemented to support distributed testing and our distributed test system relies on run-test-prebuilt returning 0 when tests are run successfully, regardless of test results. This helps us differentiate between &amp;quot;infrastructure&amp;quot; failures and actual test failures. I don&amp;#39;t know if anyone else is using run-test-prebuilt, but if anyone is, I would expect them to not want the behavior to change, just like we (Oracle) don&amp;#39;t.&lt;br/&gt;
&lt;br/&gt;
Adding an environment variable that changes the behavior would be possible, but I&amp;#39;m not sure if I would be comfortable with changing the default behavior even with such a variable available. We would at least require some time to adapt if that was to be done.</comment>
                            <comment id="14586347" author="tonyp" created="Thu, 1 Jun 2023 07:46:55 -0700"  >Hi Erik, thanks for the response. Not sure I fully understand it, though. Currently, &amp;quot;make test-prebuilt&amp;quot; behaves differently to &amp;quot;make test&amp;quot; and &amp;quot;make test-only&amp;quot; wrt exit codes (when tests fail, the former returns 0, the other two return non-0). Is that really the intention?</comment>
                            <comment id="14586343" author="erikj" created="Thu, 1 Jun 2023 07:32:48 -0700"  >This is by design. We chose to make a difference between &amp;quot;we failed to run the tests&amp;quot; and &amp;quot;we successfully ran the tests but there were test failures&amp;quot;. If you want to change this behavior, it has to be made opt in through configuration. </comment>
                            <comment id="14584946" author="roboduke" created="Fri, 26 May 2023 09:13:14 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/14183&quot;&gt;https://git.openjdk.org/jdk/pull/14183&lt;/a&gt;&lt;br/&gt;
Date: 2023-05-26 16:07:36 +0000</comment>
                            <comment id="14584944" author="tonyp" created="Fri, 26 May 2023 09:11:07 -0700"  >For &amp;#39;make&amp;#39; test and &amp;#39;make test-only&amp;#39; the existence of exit-with-error is checked in the main target in Init.gmk. But this target is not called by &amp;#39;make test-prebuilt&amp;#39;. Is there a better way to fix this just to check for the existence of exit-with-error in RunTestsPrebuilt.gmk?</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i31oxf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17357"><![CDATA[b26]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="199"><![CDATA[build]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>